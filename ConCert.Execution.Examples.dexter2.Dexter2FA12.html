<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">

<head>
  <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
<link href="coqdoc.css" rel="stylesheet" type="text/css" />
<link href="coqdocjs.css" rel="stylesheet" type="text/css"/>
<link href="toc.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="config.js"></script>
<script type="text/javascript" src="coqdocjs.js"></script>
</head>

<body onload="document.getElementById('content').focus()">
  <div id="header">
    <span class="left">
      <span class="modulename"> <script> document.write(document.title) </script> </span>
    </span>

    <span class="button" id="toggle-proofs"></span>

    <span class="right">
      <a href="toc.html">Table of contents</a>
      <a href="https://github.com/AU-COBRA/ConCert" target="_balnk">Project Page</a>
    </span>
</div>
  <div id="content" tabindex="-1" onblur="document.getElementById('content').focus()">
    <div id="js-toc-header" class="toc-header">Contents:</div>
    <div id="js-toc" class="toc" data-toc="h1,h2,h3,h4" data-toc-container="doc">
    </div>
    <div id="main">
<h1 class="libtitle">Library ConCert.Execution.Examples.dexter2.Dexter2FA12</h1>

<div class="code">
</div>

<div class="doc">
<a name="lab203"></a><h1 class="section">Dexter 2 FA1.2 Liquidity token contract</h1>
 This file contains an implementation of Dexter2 liquidity contract
    https://gitlab.com/dexter2tz/dexter2tz/-/blob/master/lqt_fa12.mligo
    In addition this file contains proof of functional correctness w.r.t the
    informal specification https://gitlab.com/dexter2tz/dexter2tz/-/blob/master/docs/informal-spec/dexter2-lqt-fa12.md

<div class="paragraph"> </div>

    This contract is an extension of a basic FA1.2 token contract with
    an extra entrypoint that allows an admin to mint and burn tokens.
    It is used in the Dexter2 exchange paired with an instance of the
    Dexter2 CPMM contract. The purpose of this contract is to keep track
    of ownership of the exchanges funds. An user who owns x of the exchanges trading reserve.

</div>
<div class="code">
<span class="id" title="keyword">From</span> <span class="id" title="var">ConCert.Utils</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="ConCert.Utils.Automation.html#"><span class="id" title="library">Automation</span></a>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">ConCert.Utils</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="ConCert.Utils.RecordUpdate.html#"><span class="id" title="library">RecordUpdate</span></a>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">ConCert.Execution</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="ConCert.Execution.Blockchain.html#"><span class="id" title="library">Blockchain</span></a>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">ConCert.Execution</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="ConCert.Execution.Containers.html#"><span class="id" title="library">Containers</span></a>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">ConCert.Execution</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="ConCert.Execution.Extras.html#"><span class="id" title="library">Extras</span></a>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">ConCert.Execution</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="ConCert.Execution.Monads.html#"><span class="id" title="library">Monads</span></a>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">ConCert.Execution</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="ConCert.Execution.Serializable.html#"><span class="id" title="library">Serializable</span></a>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">ConCert.Execution</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="ConCert.Execution.InterContractCommunication.html#"><span class="id" title="library">InterContractCommunication</span></a>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">ConCert.Execution.Examples</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="ConCert.Execution.Examples.Common.html#"><span class="id" title="library">Common</span></a>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">Coq</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.ZArith.ZArith.html#"><span class="id" title="library">ZArith</span></a>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">Coq</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Bool.Bool.html#"><span class="id" title="library">Bool</span></a>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">Coq</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#"><span class="id" title="library">List</span></a>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">Coq</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.micromega.Lia.html#"><span class="id" title="library">Lia</span></a>.<br/>
<span class="id" title="keyword">Import</span> <span class="id" title="var">ListNotations</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <a name="non_zero_amount"><span class="id" title="definition">non_zero_amount</span></a> (<span class="id" title="var">amt</span> : <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Numbers.BinNums.html#Z"><span class="id" title="inductive">Z</span></a>) : <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#bool"><span class="id" title="inductive">bool</span></a>:= (0 <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.ZArith.BinInt.html#f1746f02f141d025b1e53605943919bf"><span class="id" title="notation">&lt;?</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#amt"><span class="id" title="variable">amt</span></a>)%<span class="id" title="var">Z</span>.<br/>

<br/>
</div>

<div class="doc">
<a name="lab204"></a><h1 class="section">Contract types</h1>

</div>
<div class="code">

<br/>
<span class="id" title="keyword">Section</span> <a name="LQTFA12Types"><span class="id" title="section">LQTFA12Types</span></a>.<br/>
<span class="id" title="keyword">Context</span> {<span class="id" title="var">BaseTypes</span> : <a class="idref" href="ConCert.Execution.Blockchain.html#ChainBase"><span class="id" title="class">ChainBase</span></a>}.<br/>
<span class="id" title="keyword">Set</span> <span class="id" title="var">Primitive</span> <span class="id" title="var">Projections</span>.<br/>
<span class="id" title="keyword">Set</span> <span class="id" title="var">Nonrecursive</span> <span class="id" title="var">Elimination</span> <span class="id" title="var">Schemes</span>.<br/>
<span class="id" title="keyword">Open</span> <span class="id" title="keyword">Scope</span> <span class="id" title="var">N_scope</span>.<br/>

<br/>
<span class="comment">(*&nbsp;Dummy&nbsp;implementation&nbsp;of&nbsp;callbacks.&nbsp;*)</span><br/>
<span class="id" title="keyword">Record</span> <a name="callback"><span class="id" title="record">callback</span></a> := {<br/>
&nbsp;&nbsp;<a name="return_addr"><span class="id" title="projection">return_addr</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#Address"><span class="id" title="method">Address</span></a>;<br/>
}.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <a name="callback_addr"><span class="id" title="definition">callback_addr</span></a> (<span class="id" title="var">c</span> : <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#callback"><span class="id" title="record">callback</span></a>) : <a class="idref" href="ConCert.Execution.Blockchain.html#Address"><span class="id" title="method">Address</span></a> := <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#c"><span class="id" title="variable">c</span></a>.(<a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#return_addr"><span class="id" title="projection">return_addr</span></a>).<br/>
<span class="id" title="keyword">Coercion</span> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#callback_addr"><span class="id" title="definition">callback_addr</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#callback_addr"><span class="id" title="definition">:</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#callback_addr"><span class="id" title="definition">callback</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#callback_addr"><span class="id" title="definition">&gt;-&gt;</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#callback_addr"><span class="id" title="definition">Address</span></a>.<br/>

<br/>
<span class="id" title="keyword">Record</span> <a name="transfer_param"><span class="id" title="record">transfer_param</span></a> :=<br/>
&nbsp;&nbsp;<a name="build_transfer_param"><span class="id" title="constructor">build_transfer_param</span></a>{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a name="from"><span class="id" title="projection">from</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#Address"><span class="id" title="method">Address</span></a>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a name="to"><span class="id" title="projection">to</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#Address"><span class="id" title="method">Address</span></a>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a name="value"><span class="id" title="projection">value</span></a> : <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Numbers.BinNums.html#N"><span class="id" title="inductive">N</span></a><br/>
}.<br/>

<br/>
<span class="id" title="keyword">Record</span> <a name="approve_param"><span class="id" title="record">approve_param</span></a> :=<br/>
&nbsp;&nbsp;<a name="build_approve_param"><span class="id" title="constructor">build_approve_param</span></a>{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a name="spender"><span class="id" title="projection">spender</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#Address"><span class="id" title="method">Address</span></a>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a name="value_"><span class="id" title="projection">value_</span></a> : <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Numbers.BinNums.html#N"><span class="id" title="inductive">N</span></a><br/>
}.<br/>

<br/>
<span class="id" title="keyword">Record</span> <a name="mintOrBurn_param"><span class="id" title="record">mintOrBurn_param</span></a> :=<br/>
&nbsp;&nbsp;<a name="build_mintOrBurn_param"><span class="id" title="constructor">build_mintOrBurn_param</span></a>{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a name="quantity"><span class="id" title="projection">quantity</span></a> : <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Numbers.BinNums.html#Z"><span class="id" title="inductive">Z</span></a>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a name="target"><span class="id" title="projection">target</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#Address"><span class="id" title="method">Address</span></a><br/>
}.<br/>

<br/>
<span class="id" title="keyword">Record</span> <a name="getAllowance_param"><span class="id" title="record">getAllowance_param</span></a> :=<br/>
&nbsp;&nbsp;<a name="build_getAllowance_param"><span class="id" title="constructor">build_getAllowance_param</span></a>{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a name="request"><span class="id" title="projection">request</span></a> : (<a class="idref" href="ConCert.Execution.Blockchain.html#Address"><span class="id" title="method">Address</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#11c698c8685bb8ab1cf725545c085ac4"><span class="id" title="notation">*</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#Address"><span class="id" title="method">Address</span></a>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a name="allowance_callback"><span class="id" title="projection">allowance_callback</span></a> : <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#callback"><span class="id" title="record">callback</span></a><br/>
}.<br/>

<br/>
<span class="id" title="keyword">Record</span> <a name="getBalance_param"><span class="id" title="record">getBalance_param</span></a> :=<br/>
&nbsp;&nbsp;<a name="build_getBalance_param"><span class="id" title="constructor">build_getBalance_param</span></a>{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a name="owner_"><span class="id" title="projection">owner_</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#Address"><span class="id" title="method">Address</span></a>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a name="balance_callback"><span class="id" title="projection">balance_callback</span></a> : <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#callback"><span class="id" title="record">callback</span></a><br/>
}.<br/>

<br/>
<span class="id" title="keyword">Record</span> <a name="getTotalSupply_param"><span class="id" title="record">getTotalSupply_param</span></a> :=<br/>
&nbsp;&nbsp;<a name="build_getTotalSupply_param"><span class="id" title="constructor">build_getTotalSupply_param</span></a>{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a name="request_"><span class="id" title="projection">request_</span></a> : <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#unit"><span class="id" title="inductive">unit</span></a>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a name="supply_callback"><span class="id" title="projection">supply_callback</span></a> : <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#callback"><span class="id" title="record">callback</span></a><br/>
}.<br/>

<br/>
<span class="id" title="keyword">Record</span> <a name="State"><span class="id" title="record">State</span></a> :=<br/>
&nbsp;&nbsp;<a name="build_state"><span class="id" title="constructor">build_state</span></a> {<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a name="tokens"><span class="id" title="projection">tokens</span></a> : <a class="idref" href="ConCert.Execution.Containers.html#FMap"><span class="id" title="abbreviation">FMap</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#Address"><span class="id" title="method">Address</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Numbers.BinNums.html#N"><span class="id" title="inductive">N</span></a>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a name="allowances"><span class="id" title="projection">allowances</span></a> : <a class="idref" href="ConCert.Execution.Containers.html#FMap"><span class="id" title="abbreviation">FMap</span></a> (<a class="idref" href="ConCert.Execution.Blockchain.html#Address"><span class="id" title="method">Address</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#11c698c8685bb8ab1cf725545c085ac4"><span class="id" title="notation">*</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#Address"><span class="id" title="method">Address</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Numbers.BinNums.html#N"><span class="id" title="inductive">N</span></a>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a name="admin"><span class="id" title="projection">admin</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#Address"><span class="id" title="method">Address</span></a>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a name="total_supply"><span class="id" title="projection">total_supply</span></a> : <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Numbers.BinNums.html#N"><span class="id" title="inductive">N</span></a><br/>
}.<br/>

<br/>
<span class="id" title="keyword">Record</span> <a name="Setup"><span class="id" title="record">Setup</span></a> :=<br/>
&nbsp;&nbsp;<a name="build_setup"><span class="id" title="constructor">build_setup</span></a> {<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a name="admin_"><span class="id" title="projection">admin_</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#Address"><span class="id" title="method">Address</span></a>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a name="lqt_provider"><span class="id" title="projection">lqt_provider</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#Address"><span class="id" title="method">Address</span></a>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a name="initial_pool"><span class="id" title="projection">initial_pool</span></a> : <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Numbers.BinNums.html#N"><span class="id" title="inductive">N</span></a><br/>
}.<br/>

<br/>
<span class="comment">(*&nbsp;Any&nbsp;contract&nbsp;that&nbsp;wants&nbsp;to&nbsp;receive&nbsp;callback&nbsp;messages&nbsp;from&nbsp;the&nbsp;FA1.2&nbsp;liquidity&nbsp;contract<br/>
&nbsp;&nbsp;&nbsp;should&nbsp;have&nbsp;this&nbsp;type&nbsp;as&nbsp;its&nbsp;Msg&nbsp;type.&nbsp;The&nbsp;contract&nbsp;may&nbsp;have&nbsp;other&nbsp;endpoints,<br/>
&nbsp;&nbsp;&nbsp;as&nbsp;composed&nbsp;in&nbsp;the&nbsp;'other_msg'&nbsp;constructor.&nbsp;*)</span><br/>
<span class="id" title="keyword">Inductive</span> <a name="FA12ReceiverMsg"><span class="id" title="inductive">FA12ReceiverMsg</span></a> {<span class="id" title="var">Msg'</span> : <span class="id" title="keyword">Type</span>} `{<a class="idref" href="ConCert.Execution.Serializable.html#Serializable"><span class="id" title="class">Serializable</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#Msg'"><span class="id" title="variable">Msg'</span></a>} :=<br/>
&nbsp;&nbsp;| <a name="receive_allowance"><span class="id" title="constructor">receive_allowance</span></a> : <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Numbers.BinNums.html#N"><span class="id" title="inductive">N</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a>  <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#FA12ReceiverMsg"><span class="id" title="inductive">FA12ReceiverMsg</span></a><br/>
&nbsp;&nbsp;| <a name="receive_balance_of"><span class="id" title="constructor">receive_balance_of</span></a> : <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Numbers.BinNums.html#N"><span class="id" title="inductive">N</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#FA12ReceiverMsg"><span class="id" title="inductive">FA12ReceiverMsg</span></a><br/>
&nbsp;&nbsp;| <a name="receive_total_supply"><span class="id" title="constructor">receive_total_supply</span></a> : <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Numbers.BinNums.html#N"><span class="id" title="inductive">N</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#FA12ReceiverMsg"><span class="id" title="inductive">FA12ReceiverMsg</span></a><br/>
&nbsp;&nbsp;| <a name="other_msg"><span class="id" title="constructor">other_msg</span></a> : <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#Msg'"><span class="id" title="variable">Msg'</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#FA12ReceiverMsg"><span class="id" title="inductive">FA12ReceiverMsg</span></a>.<br/>

<br/>
<span class="comment">(*&nbsp;Liquidity&nbsp;FA1.2&nbsp;Endpoints.&nbsp;*)</span><br/>
<span class="id" title="keyword">Inductive</span> <a name="Msg"><span class="id" title="inductive">Msg</span></a> :=<br/>
&nbsp;&nbsp;| <a name="msg_transfer"><span class="id" title="constructor">msg_transfer</span></a> : <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#transfer_param"><span class="id" title="record">transfer_param</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#Msg"><span class="id" title="inductive">Msg</span></a><br/>
&nbsp;&nbsp;| <a name="msg_approve"><span class="id" title="constructor">msg_approve</span></a> : <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#approve_param"><span class="id" title="record">approve_param</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#Msg"><span class="id" title="inductive">Msg</span></a><br/>
&nbsp;&nbsp;| <a name="msg_mint_or_burn"><span class="id" title="constructor">msg_mint_or_burn</span></a> : <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#mintOrBurn_param"><span class="id" title="record">mintOrBurn_param</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#Msg"><span class="id" title="inductive">Msg</span></a><br/>
&nbsp;&nbsp;| <a name="msg_get_allowance"><span class="id" title="constructor">msg_get_allowance</span></a> : <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#getAllowance_param"><span class="id" title="record">getAllowance_param</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#Msg"><span class="id" title="inductive">Msg</span></a><br/>
&nbsp;&nbsp;| <a name="msg_get_balance"><span class="id" title="constructor">msg_get_balance</span></a> : <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#getBalance_param"><span class="id" title="record">getBalance_param</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#Msg"><span class="id" title="inductive">Msg</span></a><br/>
&nbsp;&nbsp;| <a name="msg_get_total_supply"><span class="id" title="constructor">msg_get_total_supply</span></a> : <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#getTotalSupply_param"><span class="id" title="record">getTotalSupply_param</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#Msg"><span class="id" title="inductive">Msg</span></a>.<br/>

<br/>

<br/>
<span class="id" title="keyword">Definition</span> <a name="mintedOrBurnedTokens"><span class="id" title="definition">mintedOrBurnedTokens</span></a> (<span class="id" title="var">msg</span> : <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#option"><span class="id" title="inductive">option</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#Msg"><span class="id" title="inductive">Msg</span></a>) : <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Numbers.BinNums.html#Z"><span class="id" title="inductive">Z</span></a> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#msg"><span class="id" title="variable">msg</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> (<a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#msg_mint_or_burn"><span class="id" title="constructor">msg_mint_or_burn</span></a> <span class="id" title="var">param</span>) =&gt; <span class="id" title="var">param</span>.(<a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#quantity"><span class="id" title="projection">quantity</span></a>)<br/>
&nbsp;&nbsp;| <span class="id" title="var">_</span> =&gt; 0<br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Class</span> <a name="LqtTokenInterface"><span class="id" title="record">LqtTokenInterface</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;`{<a class="idref" href="ConCert.Execution.Serializable.html#Serializable"><span class="id" title="class">Serializable</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#State"><span class="id" title="record">State</span></a>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;`{<a class="idref" href="ConCert.Execution.Serializable.html#Serializable"><span class="id" title="class">Serializable</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#Msg"><span class="id" title="inductive">Msg</span></a>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;`{<a class="idref" href="ConCert.Execution.Serializable.html#Serializable"><span class="id" title="class">Serializable</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#Setup"><span class="id" title="record">Setup</span></a>} :=<br/>
&nbsp;&nbsp;{ <a name="lqt_contract"><span class="id" title="projection">lqt_contract</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#Contract"><span class="id" title="record">Contract</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#Setup"><span class="id" title="record">Setup</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#Msg"><span class="id" title="inductive">Msg</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#State"><span class="id" title="record">State</span></a>;<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a name="lqt_total_supply_correct"><span class="id" title="projection">lqt_total_supply_correct</span></a> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">forall</span>  (<span class="id" title="var">bstate</span> : <a class="idref" href="ConCert.Execution.Blockchain.html#ChainState"><span class="id" title="record">ChainState</span></a>) (<span class="id" title="var">caddr</span> : <a class="idref" href="ConCert.Execution.Blockchain.html#Address"><span class="id" title="method">Address</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">trace</span> : <a class="idref" href="ConCert.Execution.Blockchain.html#ChainTrace"><span class="id" title="definition">ChainTrace</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#empty_state"><span class="id" title="definition">empty_state</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#bstate"><span class="id" title="variable">bstate</span></a>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#env_contracts"><span class="id" title="projection">env_contracts</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#bstate"><span class="id" title="variable">bstate</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#caddr"><span class="id" title="variable">caddr</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> (<a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#lqt_contract"><span class="id" title="method">lqt_contract</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#WeakContract"><span class="id" title="inductive">WeakContract</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">exists</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">(</span></a><span class="id" title="var">cstate</span> : <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#State"><span class="id" title="record">State</span></a>) (<span class="id" title="var">depinfo</span> : <a class="idref" href="ConCert.Execution.Blockchain.html#DeploymentInfo"><span class="id" title="record">DeploymentInfo</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#Setup"><span class="id" title="record">Setup</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">inc_calls</span> : <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#list"><span class="id" title="inductive">list</span></a> (<a class="idref" href="ConCert.Execution.Blockchain.html#ContractCallInfo"><span class="id" title="record">ContractCallInfo</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#Msg"><span class="id" title="inductive">Msg</span></a>)<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">),</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#contract_state"><span class="id" title="definition">contract_state</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#bstate"><span class="id" title="variable">bstate</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#caddr"><span class="id" title="variable">caddr</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#cstate"><span class="id" title="variable">cstate</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">/\</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#deployment_info"><span class="id" title="definition">deployment_info</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#Setup"><span class="id" title="record">Setup</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#trace"><span class="id" title="variable">trace</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#caddr"><span class="id" title="variable">caddr</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#depinfo"><span class="id" title="variable">depinfo</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">/\</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#incoming_calls"><span class="id" title="definition">incoming_calls</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#Msg"><span class="id" title="inductive">Msg</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#trace"><span class="id" title="variable">trace</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#caddr"><span class="id" title="variable">caddr</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#inc_calls"><span class="id" title="variable">inc_calls</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">/\</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">(</span></a><span class="id" title="keyword">let</span> <span class="id" title="var">initial_tokens</span> := <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#initial_pool"><span class="id" title="projection">initial_pool</span></a> (<a class="idref" href="ConCert.Execution.Blockchain.html#deployment_setup"><span class="id" title="projection">deployment_setup</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#depinfo"><span class="id" title="variable">depinfo</span></a>) <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.ZArith.BinInt.html#Z.of_N"><span class="id" title="definition">Z.of_N</span></a> (<a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#total_supply"><span class="id" title="projection">total_supply</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#cstate"><span class="id" title="variable">cstate</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.ZArith.BinInt.html#Z.of_N"><span class="id" title="definition">Z.of_N</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#initial_tokens"><span class="id" title="variable">initial_tokens</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.ZArith.BinInt.html#46584eddd5fdb16176a10a2843177d3a"><span class="id" title="notation">+</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Extras.html#sumZ"><span class="id" title="definition">sumZ</span></a> (<span class="id" title="keyword">fun</span> <span class="id" title="var">callInfo</span>  =&gt; <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#mintedOrBurnedTokens"><span class="id" title="definition">mintedOrBurnedTokens</span></a> (<a class="idref" href="ConCert.Execution.Blockchain.html#call_msg"><span class="id" title="projection">call_msg</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#callInfo"><span class="id" title="variable">callInfo</span></a>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#filter"><span class="id" title="definition">filter</span></a> (<a class="idref" href="ConCert.Execution.InterContractCommunication.html#callFrom"><span class="id" title="definition">callFrom</span></a> (<a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#admin"><span class="id" title="projection">admin</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#cstate"><span class="id" title="variable">cstate</span></a>)) <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#inc_calls"><span class="id" title="variable">inc_calls</span></a>))%<span class="id" title="var">Z</span><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">)</span></a> }.<br/>

<br/>
<span class="id" title="keyword">End</span> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#LQTFA12Types"><span class="id" title="section">LQTFA12Types</span></a>.<br/>

<br/>
<span class="id" title="keyword">Module</span> <span class="id" title="keyword">Type</span> <a name="Dexter2LqtSerializable"><span class="id" title="module">Dexter2LqtSerializable</span></a>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Section</span> <a name="Dexter2LqtSerializable.D2LqtSerializable"><span class="id" title="section">D2LqtSerializable</span></a>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Context</span> `{<a class="idref" href="ConCert.Execution.Blockchain.html#ChainBase"><span class="id" title="class">ChainBase</span></a>}.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Axiom</span> <a name="Dexter2LqtSerializable.callback_serializable"><span class="id" title="axiom">callback_serializable</span></a> : <a class="idref" href="ConCert.Execution.Serializable.html#Serializable"><span class="id" title="class">Serializable</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#callback"><span class="id" title="record">callback</span></a>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Axiom</span> <a name="Dexter2LqtSerializable.transfer_param_serializable"><span class="id" title="axiom">transfer_param_serializable</span></a> : <a class="idref" href="ConCert.Execution.Serializable.html#Serializable"><span class="id" title="class">Serializable</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#transfer_param"><span class="id" title="record">transfer_param</span></a>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Axiom</span> <a name="Dexter2LqtSerializable.approve_param_serializable"><span class="id" title="axiom">approve_param_serializable</span></a> : <a class="idref" href="ConCert.Execution.Serializable.html#Serializable"><span class="id" title="class">Serializable</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#approve_param"><span class="id" title="record">approve_param</span></a>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Axiom</span> <a name="Dexter2LqtSerializable.mintOrBurn_param_serializable"><span class="id" title="axiom">mintOrBurn_param_serializable</span></a> : <a class="idref" href="ConCert.Execution.Serializable.html#Serializable"><span class="id" title="class">Serializable</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#mintOrBurn_param"><span class="id" title="record">mintOrBurn_param</span></a>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Axiom</span> <a name="Dexter2LqtSerializable.getAllowance_param_serializable"><span class="id" title="axiom">getAllowance_param_serializable</span></a> : <a class="idref" href="ConCert.Execution.Serializable.html#Serializable"><span class="id" title="class">Serializable</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#getAllowance_param"><span class="id" title="record">getAllowance_param</span></a>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Axiom</span> <a name="Dexter2LqtSerializable.getBalance_param_serializable"><span class="id" title="axiom">getBalance_param_serializable</span></a> : <a class="idref" href="ConCert.Execution.Serializable.html#Serializable"><span class="id" title="class">Serializable</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#getBalance_param"><span class="id" title="record">getBalance_param</span></a>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Axiom</span> <a name="Dexter2LqtSerializable.getTotalSupply_param_serializable"><span class="id" title="axiom">getTotalSupply_param_serializable</span></a> : <a class="idref" href="ConCert.Execution.Serializable.html#Serializable"><span class="id" title="class">Serializable</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#getTotalSupply_param"><span class="id" title="record">getTotalSupply_param</span></a>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Axiom</span>  <a name="Dexter2LqtSerializable.FA12ReceiverMsg_serializable"><span class="id" title="axiom">FA12ReceiverMsg_serializable</span></a> : <span class="id" title="keyword">forall</span> {<span class="id" title="var">Msg</span> : <span class="id" title="keyword">Type</span>} `{<span class="id" title="var">serMsg</span> : <a class="idref" href="ConCert.Execution.Serializable.html#Serializable"><span class="id" title="class">Serializable</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#Msg"><span class="id" title="variable">Msg</span></a>}, <a class="idref" href="ConCert.Execution.Serializable.html#Serializable"><span class="id" title="class">Serializable</span></a> (@<a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#FA12ReceiverMsg"><span class="id" title="inductive">FA12ReceiverMsg</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#Msg"><span class="id" title="variable">Msg</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#serMsg"><span class="id" title="variable">serMsg</span></a>).<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Axiom</span> <a name="Dexter2LqtSerializable.msg_serializable"><span class="id" title="axiom">msg_serializable</span></a> : <a class="idref" href="ConCert.Execution.Serializable.html#Serializable"><span class="id" title="class">Serializable</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#Msg"><span class="id" title="inductive">Msg</span></a>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Axiom</span> <a name="Dexter2LqtSerializable.state_serializable"><span class="id" title="axiom">state_serializable</span></a> : <a class="idref" href="ConCert.Execution.Serializable.html#Serializable"><span class="id" title="class">Serializable</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#State"><span class="id" title="record">State</span></a>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Axiom</span> <a name="Dexter2LqtSerializable.setup_serializable"><span class="id" title="axiom">setup_serializable</span></a> : <a class="idref" href="ConCert.Execution.Serializable.html#Serializable"><span class="id" title="class">Serializable</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#Setup"><span class="id" title="record">Setup</span></a>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">End</span> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#Dexter2LqtSerializable.D2LqtSerializable"><span class="id" title="section">D2LqtSerializable</span></a>.<br/>
<span class="id" title="keyword">End</span> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#Dexter2LqtSerializable"><span class="id" title="module">Dexter2LqtSerializable</span></a>.<br/>

<br/>
<span class="id" title="keyword">Module</span> <a name="D2LqtSInstances"><span class="id" title="module">D2LqtSInstances</span></a> &lt;: <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#Dexter2LqtSerializable"><span class="id" title="module">Dexter2LqtSerializable</span></a>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Section</span> <a name="D2LqtSInstances.Serialization"><span class="id" title="section">Serialization</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Context</span> `{<a class="idref" href="ConCert.Execution.Blockchain.html#ChainBase"><span class="id" title="class">ChainBase</span></a>}.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Instance</span>  <a name="D2LqtSInstances.callback_serializable"><span class="id" title="instance">callback_serializable</span></a> : <a class="idref" href="ConCert.Execution.Serializable.html#Serializable"><span class="id" title="class">Serializable</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#callback"><span class="id" title="record">callback</span></a> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Serializable.html#70b92666138db7c4a5e7f9f8911f246a"><span class="id" title="notation">Derive</span></a> <a class="idref" href="ConCert.Execution.Serializable.html#70b92666138db7c4a5e7f9f8911f246a"><span class="id" title="notation">Serializable</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#callback_rect"><span class="id" title="definition">callback_rect</span></a> <a class="idref" href="ConCert.Execution.Serializable.html#70b92666138db7c4a5e7f9f8911f246a"><span class="id" title="notation">&lt;</span></a><a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#Build_callback"><span class="id" title="constructor">Build_callback</span></a><a class="idref" href="ConCert.Execution.Serializable.html#70b92666138db7c4a5e7f9f8911f246a"><span class="id" title="notation">&gt;</span></a>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Instance</span> <a name="D2LqtSInstances.transfer_param_serializable"><span class="id" title="instance">transfer_param_serializable</span></a> : <a class="idref" href="ConCert.Execution.Serializable.html#Serializable"><span class="id" title="class">Serializable</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#transfer_param"><span class="id" title="record">transfer_param</span></a> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Serializable.html#70b92666138db7c4a5e7f9f8911f246a"><span class="id" title="notation">Derive</span></a> <a class="idref" href="ConCert.Execution.Serializable.html#70b92666138db7c4a5e7f9f8911f246a"><span class="id" title="notation">Serializable</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#transfer_param_rect"><span class="id" title="definition">transfer_param_rect</span></a> <a class="idref" href="ConCert.Execution.Serializable.html#70b92666138db7c4a5e7f9f8911f246a"><span class="id" title="notation">&lt;</span></a><a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#build_transfer_param"><span class="id" title="constructor">build_transfer_param</span></a><a class="idref" href="ConCert.Execution.Serializable.html#70b92666138db7c4a5e7f9f8911f246a"><span class="id" title="notation">&gt;</span></a>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Instance</span> <a name="D2LqtSInstances.approve_param_serializable"><span class="id" title="instance">approve_param_serializable</span></a> : <a class="idref" href="ConCert.Execution.Serializable.html#Serializable"><span class="id" title="class">Serializable</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#approve_param"><span class="id" title="record">approve_param</span></a> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Serializable.html#70b92666138db7c4a5e7f9f8911f246a"><span class="id" title="notation">Derive</span></a> <a class="idref" href="ConCert.Execution.Serializable.html#70b92666138db7c4a5e7f9f8911f246a"><span class="id" title="notation">Serializable</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#approve_param_rect"><span class="id" title="definition">approve_param_rect</span></a> <a class="idref" href="ConCert.Execution.Serializable.html#70b92666138db7c4a5e7f9f8911f246a"><span class="id" title="notation">&lt;</span></a><a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#build_approve_param"><span class="id" title="constructor">build_approve_param</span></a><a class="idref" href="ConCert.Execution.Serializable.html#70b92666138db7c4a5e7f9f8911f246a"><span class="id" title="notation">&gt;</span></a>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Instance</span> <a name="D2LqtSInstances.mintOrBurn_param_serializable"><span class="id" title="instance">mintOrBurn_param_serializable</span></a> : <a class="idref" href="ConCert.Execution.Serializable.html#Serializable"><span class="id" title="class">Serializable</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#mintOrBurn_param"><span class="id" title="record">mintOrBurn_param</span></a> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Serializable.html#70b92666138db7c4a5e7f9f8911f246a"><span class="id" title="notation">Derive</span></a> <a class="idref" href="ConCert.Execution.Serializable.html#70b92666138db7c4a5e7f9f8911f246a"><span class="id" title="notation">Serializable</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#mintOrBurn_param_rect"><span class="id" title="definition">mintOrBurn_param_rect</span></a> <a class="idref" href="ConCert.Execution.Serializable.html#70b92666138db7c4a5e7f9f8911f246a"><span class="id" title="notation">&lt;</span></a><a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#build_mintOrBurn_param"><span class="id" title="constructor">build_mintOrBurn_param</span></a><a class="idref" href="ConCert.Execution.Serializable.html#70b92666138db7c4a5e7f9f8911f246a"><span class="id" title="notation">&gt;</span></a>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Instance</span> <a name="D2LqtSInstances.getAllowance_param_serializable"><span class="id" title="instance">getAllowance_param_serializable</span></a> : <a class="idref" href="ConCert.Execution.Serializable.html#Serializable"><span class="id" title="class">Serializable</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#getAllowance_param"><span class="id" title="record">getAllowance_param</span></a> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Serializable.html#70b92666138db7c4a5e7f9f8911f246a"><span class="id" title="notation">Derive</span></a> <a class="idref" href="ConCert.Execution.Serializable.html#70b92666138db7c4a5e7f9f8911f246a"><span class="id" title="notation">Serializable</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#getAllowance_param_rect"><span class="id" title="definition">getAllowance_param_rect</span></a> <a class="idref" href="ConCert.Execution.Serializable.html#70b92666138db7c4a5e7f9f8911f246a"><span class="id" title="notation">&lt;</span></a><a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#build_getAllowance_param"><span class="id" title="constructor">build_getAllowance_param</span></a><a class="idref" href="ConCert.Execution.Serializable.html#70b92666138db7c4a5e7f9f8911f246a"><span class="id" title="notation">&gt;</span></a>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Instance</span> <a name="D2LqtSInstances.getBalance_param_serializable"><span class="id" title="instance">getBalance_param_serializable</span></a> : <a class="idref" href="ConCert.Execution.Serializable.html#Serializable"><span class="id" title="class">Serializable</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#getBalance_param"><span class="id" title="record">getBalance_param</span></a> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Serializable.html#70b92666138db7c4a5e7f9f8911f246a"><span class="id" title="notation">Derive</span></a> <a class="idref" href="ConCert.Execution.Serializable.html#70b92666138db7c4a5e7f9f8911f246a"><span class="id" title="notation">Serializable</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#getBalance_param_rect"><span class="id" title="definition">getBalance_param_rect</span></a> <a class="idref" href="ConCert.Execution.Serializable.html#70b92666138db7c4a5e7f9f8911f246a"><span class="id" title="notation">&lt;</span></a><a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#build_getBalance_param"><span class="id" title="constructor">build_getBalance_param</span></a><a class="idref" href="ConCert.Execution.Serializable.html#70b92666138db7c4a5e7f9f8911f246a"><span class="id" title="notation">&gt;</span></a>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Instance</span> <a name="D2LqtSInstances.getTotalSupply_param_serializable"><span class="id" title="instance">getTotalSupply_param_serializable</span></a> : <a class="idref" href="ConCert.Execution.Serializable.html#Serializable"><span class="id" title="class">Serializable</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#getTotalSupply_param"><span class="id" title="record">getTotalSupply_param</span></a> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Serializable.html#70b92666138db7c4a5e7f9f8911f246a"><span class="id" title="notation">Derive</span></a> <a class="idref" href="ConCert.Execution.Serializable.html#70b92666138db7c4a5e7f9f8911f246a"><span class="id" title="notation">Serializable</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#getTotalSupply_param_rect"><span class="id" title="definition">getTotalSupply_param_rect</span></a> <a class="idref" href="ConCert.Execution.Serializable.html#70b92666138db7c4a5e7f9f8911f246a"><span class="id" title="notation">&lt;</span></a><a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#build_getTotalSupply_param"><span class="id" title="constructor">build_getTotalSupply_param</span></a><a class="idref" href="ConCert.Execution.Serializable.html#70b92666138db7c4a5e7f9f8911f246a"><span class="id" title="notation">&gt;</span></a>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Instance</span> <a name="D2LqtSInstances.FA12ReceiverMsg_serializable"><span class="id" title="instance">FA12ReceiverMsg_serializable</span></a> {<span class="id" title="var">Msg</span> : <span class="id" title="keyword">Type</span>} `{<span class="id" title="var">serMsg</span> : <a class="idref" href="ConCert.Execution.Serializable.html#Serializable"><span class="id" title="class">Serializable</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#Msg"><span class="id" title="variable">Msg</span></a>} : <a class="idref" href="ConCert.Execution.Serializable.html#Serializable"><span class="id" title="class">Serializable</span></a> (@<a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#FA12ReceiverMsg"><span class="id" title="inductive">FA12ReceiverMsg</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#Msg"><span class="id" title="variable">Msg</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#serMsg"><span class="id" title="variable">serMsg</span></a>) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Serializable.html#70b92666138db7c4a5e7f9f8911f246a"><span class="id" title="notation">Derive</span></a> <a class="idref" href="ConCert.Execution.Serializable.html#70b92666138db7c4a5e7f9f8911f246a"><span class="id" title="notation">Serializable</span></a> <a class="idref" href="ConCert.Execution.Serializable.html#70b92666138db7c4a5e7f9f8911f246a"><span class="id" title="notation">(</span></a>@<a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#FA12ReceiverMsg_rect"><span class="id" title="definition">FA12ReceiverMsg_rect</span></a> <span class="id" title="var">Msg</span> <span class="id" title="var">serMsg</span><a class="idref" href="ConCert.Execution.Serializable.html#70b92666138db7c4a5e7f9f8911f246a"><span class="id" title="notation">)</span></a> <a class="idref" href="ConCert.Execution.Serializable.html#70b92666138db7c4a5e7f9f8911f246a"><span class="id" title="notation">&lt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Serializable.html#70b92666138db7c4a5e7f9f8911f246a"><span class="id" title="notation">(</span></a>@<a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#receive_allowance"><span class="id" title="constructor">receive_allowance</span></a> <span class="id" title="var">Msg</span> <span class="id" title="var">serMsg</span><a class="idref" href="ConCert.Execution.Serializable.html#70b92666138db7c4a5e7f9f8911f246a"><span class="id" title="notation">),</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Serializable.html#70b92666138db7c4a5e7f9f8911f246a"><span class="id" title="notation">(</span></a>@<a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#receive_balance_of"><span class="id" title="constructor">receive_balance_of</span></a> <span class="id" title="var">Msg</span> <span class="id" title="var">serMsg</span><a class="idref" href="ConCert.Execution.Serializable.html#70b92666138db7c4a5e7f9f8911f246a"><span class="id" title="notation">),</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Serializable.html#70b92666138db7c4a5e7f9f8911f246a"><span class="id" title="notation">(</span></a>@<a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#receive_total_supply"><span class="id" title="constructor">receive_total_supply</span></a> <span class="id" title="var">Msg</span> <span class="id" title="var">serMsg</span><a class="idref" href="ConCert.Execution.Serializable.html#70b92666138db7c4a5e7f9f8911f246a"><span class="id" title="notation">),</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Serializable.html#70b92666138db7c4a5e7f9f8911f246a"><span class="id" title="notation">(</span></a>@<a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#other_msg"><span class="id" title="constructor">other_msg</span></a> <span class="id" title="var">Msg</span> <span class="id" title="var">serMsg</span><a class="idref" href="ConCert.Execution.Serializable.html#70b92666138db7c4a5e7f9f8911f246a"><span class="id" title="notation">)&gt;</span></a>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Instance</span> <a name="D2LqtSInstances.msg_serializable"><span class="id" title="instance">msg_serializable</span></a> : <a class="idref" href="ConCert.Execution.Serializable.html#Serializable"><span class="id" title="class">Serializable</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#Msg"><span class="id" title="inductive">Msg</span></a> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Serializable.html#70b92666138db7c4a5e7f9f8911f246a"><span class="id" title="notation">Derive</span></a> <a class="idref" href="ConCert.Execution.Serializable.html#70b92666138db7c4a5e7f9f8911f246a"><span class="id" title="notation">Serializable</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#Msg_rect"><span class="id" title="definition">Msg_rect</span></a> <a class="idref" href="ConCert.Execution.Serializable.html#70b92666138db7c4a5e7f9f8911f246a"><span class="id" title="notation">&lt;</span></a><a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#msg_transfer"><span class="id" title="constructor">msg_transfer</span></a><a class="idref" href="ConCert.Execution.Serializable.html#70b92666138db7c4a5e7f9f8911f246a"><span class="id" title="notation">,</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#msg_approve"><span class="id" title="constructor">msg_approve</span></a><a class="idref" href="ConCert.Execution.Serializable.html#70b92666138db7c4a5e7f9f8911f246a"><span class="id" title="notation">,</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#msg_mint_or_burn"><span class="id" title="constructor">msg_mint_or_burn</span></a><a class="idref" href="ConCert.Execution.Serializable.html#70b92666138db7c4a5e7f9f8911f246a"><span class="id" title="notation">,</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#msg_get_allowance"><span class="id" title="constructor">msg_get_allowance</span></a><a class="idref" href="ConCert.Execution.Serializable.html#70b92666138db7c4a5e7f9f8911f246a"><span class="id" title="notation">,</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#msg_get_balance"><span class="id" title="constructor">msg_get_balance</span></a><a class="idref" href="ConCert.Execution.Serializable.html#70b92666138db7c4a5e7f9f8911f246a"><span class="id" title="notation">,</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#msg_get_total_supply"><span class="id" title="constructor">msg_get_total_supply</span></a><a class="idref" href="ConCert.Execution.Serializable.html#70b92666138db7c4a5e7f9f8911f246a"><span class="id" title="notation">&gt;</span></a>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Instance</span> <a name="D2LqtSInstances.state_serializable"><span class="id" title="instance">state_serializable</span></a> : <a class="idref" href="ConCert.Execution.Serializable.html#Serializable"><span class="id" title="class">Serializable</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#State"><span class="id" title="record">State</span></a> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Serializable.html#70b92666138db7c4a5e7f9f8911f246a"><span class="id" title="notation">Derive</span></a> <a class="idref" href="ConCert.Execution.Serializable.html#70b92666138db7c4a5e7f9f8911f246a"><span class="id" title="notation">Serializable</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#State_rect"><span class="id" title="definition">State_rect</span></a> <a class="idref" href="ConCert.Execution.Serializable.html#70b92666138db7c4a5e7f9f8911f246a"><span class="id" title="notation">&lt;</span></a><a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#build_state"><span class="id" title="constructor">build_state</span></a><a class="idref" href="ConCert.Execution.Serializable.html#70b92666138db7c4a5e7f9f8911f246a"><span class="id" title="notation">&gt;</span></a>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Instance</span> <a name="D2LqtSInstances.setup_serializable"><span class="id" title="instance">setup_serializable</span></a> : <a class="idref" href="ConCert.Execution.Serializable.html#Serializable"><span class="id" title="class">Serializable</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#Setup"><span class="id" title="record">Setup</span></a> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Serializable.html#70b92666138db7c4a5e7f9f8911f246a"><span class="id" title="notation">Derive</span></a> <a class="idref" href="ConCert.Execution.Serializable.html#70b92666138db7c4a5e7f9f8911f246a"><span class="id" title="notation">Serializable</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#Setup_rect"><span class="id" title="definition">Setup_rect</span></a> <a class="idref" href="ConCert.Execution.Serializable.html#70b92666138db7c4a5e7f9f8911f246a"><span class="id" title="notation">&lt;</span></a><a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#build_setup"><span class="id" title="constructor">build_setup</span></a><a class="idref" href="ConCert.Execution.Serializable.html#70b92666138db7c4a5e7f9f8911f246a"><span class="id" title="notation">&gt;</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">End</span> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#D2LqtSInstances.Serialization"><span class="id" title="section">Serialization</span></a>.<br/>

<br/>
<span class="id" title="keyword">End</span> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#D2LqtSInstances"><span class="id" title="module">D2LqtSInstances</span></a>.<br/>
<span class="comment">(*&nbsp;end&nbsp;hide&nbsp;*)</span><br/>

<br/>
</div>

<div class="doc">
<a name="lab205"></a><h1 class="section">Contract functions</h1>

</div>
<div class="code">
<span class="id" title="keyword">Module</span> <a name="Dexter2Lqt"><span class="id" title="module">Dexter2Lqt</span></a> (<span class="id" title="var">SI</span> : <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#Dexter2LqtSerializable"><span class="id" title="module">Dexter2LqtSerializable</span></a>).<br/>

<br/>
<span class="id" title="keyword">Import</span> <span class="id" title="var">SI</span>.<br/>

<br/>

<br/>
<span class="id" title="keyword">Section</span> <a name="Dexter2Lqt.DexterLqtDefs"><span class="id" title="section">DexterLqtDefs</span></a>.<br/>
<span class="id" title="keyword">Context</span> `{<span class="id" title="var">BaseTypes</span> : <a class="idref" href="ConCert.Execution.Blockchain.html#ChainBase"><span class="id" title="class">ChainBase</span></a>}.<br/>
<span class="id" title="keyword">Open</span> <span class="id" title="keyword">Scope</span> <span class="id" title="var">N_scope</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <a name="Dexter2Lqt.find_allowance"><span class="id" title="definition">find_allowance</span></a> (<span class="id" title="var">k</span> : <a class="idref" href="ConCert.Execution.Blockchain.html#Address"><span class="id" title="method">Address</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#11c698c8685bb8ab1cf725545c085ac4"><span class="id" title="notation">*</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#Address"><span class="id" title="method">Address</span></a>) (<span class="id" title="var">m</span> : <a class="idref" href="ConCert.Execution.Containers.html#FMap"><span class="id" title="abbreviation">FMap</span></a> (<a class="idref" href="ConCert.Execution.Blockchain.html#Address"><span class="id" title="method">Address</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#11c698c8685bb8ab1cf725545c085ac4"><span class="id" title="notation">*</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#Address"><span class="id" title="method">Address</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Numbers.BinNums.html#N"><span class="id" title="inductive">N</span></a>) : <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#option"><span class="id" title="inductive">option</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Numbers.BinNums.html#N"><span class="id" title="inductive">N</span></a> :=<br/>
&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Containers.html#FMap.find"><span class="id" title="abbreviation">FMap.find</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#k"><span class="id" title="variable">k</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#m"><span class="id" title="variable">m</span></a>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <a name="Dexter2Lqt.update_allowance"><span class="id" title="definition">update_allowance</span></a> (<span class="id" title="var">k</span> : <a class="idref" href="ConCert.Execution.Blockchain.html#Address"><span class="id" title="method">Address</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#11c698c8685bb8ab1cf725545c085ac4"><span class="id" title="notation">*</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#Address"><span class="id" title="method">Address</span></a>) (<span class="id" title="var">val</span> : <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#option"><span class="id" title="inductive">option</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Numbers.BinNums.html#N"><span class="id" title="inductive">N</span></a>) (<span class="id" title="var">m</span> : <a class="idref" href="ConCert.Execution.Containers.html#FMap"><span class="id" title="abbreviation">FMap</span></a> (<a class="idref" href="ConCert.Execution.Blockchain.html#Address"><span class="id" title="method">Address</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#11c698c8685bb8ab1cf725545c085ac4"><span class="id" title="notation">*</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#Address"><span class="id" title="method">Address</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Numbers.BinNums.html#N"><span class="id" title="inductive">N</span></a>) :=<br/>
&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Containers.html#FMap.update"><span class="id" title="definition">FMap.update</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#k"><span class="id" title="variable">k</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#val"><span class="id" title="variable">val</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#m"><span class="id" title="variable">m</span></a>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <a name="Dexter2Lqt.empty_allowance"><span class="id" title="definition">empty_allowance</span></a> : <a class="idref" href="ConCert.Execution.Containers.html#FMap"><span class="id" title="abbreviation">FMap</span></a> (<a class="idref" href="ConCert.Execution.Blockchain.html#Address"><span class="id" title="method">Address</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#11c698c8685bb8ab1cf725545c085ac4"><span class="id" title="notation">*</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#Address"><span class="id" title="method">Address</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Numbers.BinNums.html#N"><span class="id" title="inductive">N</span></a> := <a class="idref" href="ConCert.Execution.Containers.html#FMap.empty"><span class="id" title="abbreviation">FMap.empty</span></a>.<br/>

<br/>
</div>

<div class="doc">
<a name="lab206"></a><h2 class="section">Transfer</h2>
 Transfers <span class="inlinecode"><a class="idref" href="ConCert.Execution.Examples.FA2Interface.html#amount"><span class="id" title="projection">amount</span></a></span> tokens, if <span class="inlinecode"><a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#from"><span class="id" title="projection">from</span></a></span> has enough tokens to transfer
    and <span class="inlinecode"><a class="idref" href="ConCert.Embedding.Examples.crowdfunding.CrowdfundingData.html#sender"><span class="id" title="definition">sender</span></a></span> is allowed to send that much on behalf of <span class="inlinecode"><a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#from"><span class="id" title="projection">from</span></a></span> 
</div>
<div class="code">
<span class="id" title="keyword">Definition</span> <a name="Dexter2Lqt.try_transfer"><span class="id" title="definition">try_transfer</span></a> (<span class="id" title="var">sender</span> : <a class="idref" href="ConCert.Execution.Blockchain.html#Address"><span class="id" title="method">Address</span></a>) (<span class="id" title="var">param</span> : <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#transfer_param"><span class="id" title="record">transfer_param</span></a>) (<span class="id" title="var">state</span> : <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#State"><span class="id" title="record">State</span></a>) : <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#option"><span class="id" title="inductive">option</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#State"><span class="id" title="record">State</span></a> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">allowances_</span> := <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#state"><span class="id" title="variable">state</span></a>.(<a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#allowances"><span class="id" title="projection">allowances</span></a>) <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">tokens_</span> := <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#state"><span class="id" title="variable">state</span></a>.(<a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#tokens"><span class="id" title="projection">tokens</span></a>) <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Monads.html#bbeef38f67325be53cb9324ba9182131"><span class="id" title="notation">do</span></a> <span class="id" title="var">allowances_</span> <a class="idref" href="ConCert.Execution.Monads.html#bbeef38f67325be53cb9324ba9182131"><span class="id" title="notation">&lt;-</span></a> <span class="comment">(*&nbsp;Update&nbsp;allowances&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Monads.html#bbeef38f67325be53cb9324ba9182131"><span class="id" title="notation">(</span></a><span class="id" title="keyword">if</span> <a class="idref" href="ConCert.Execution.Blockchain.html#address_eqb"><span class="id" title="method">address_eqb</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#sender"><span class="id" title="variable">sender</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#param"><span class="id" title="variable">param</span></a>.(<a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#from"><span class="id" title="projection">from</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">then</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#allowances_"><span class="id" title="variable">allowances_</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">else</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">allowance_key</span> := <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#param"><span class="id" title="variable">param</span></a>.(<a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#from"><span class="id" title="projection">from</span></a>)<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#sender"><span class="id" title="variable">sender</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">authorized_value</span> := <a class="idref" href="ConCert.Execution.Extras.html#with_default"><span class="id" title="definition">with_default</span></a> 0 (<a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#Dexter2Lqt.find_allowance"><span class="id" title="definition">find_allowance</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#allowance_key"><span class="id" title="variable">allowance_key</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#allowances_"><span class="id" title="variable">allowances_</span></a>) <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Monads.html#bbeef38f67325be53cb9324ba9182131"><span class="id" title="notation">do</span></a> <span class="id" title="var">_</span> <a class="idref" href="ConCert.Execution.Monads.html#bbeef38f67325be53cb9324ba9182131"><span class="id" title="notation">&lt;-</span></a> <a class="idref" href="ConCert.Execution.Examples.Common.html#throwIf"><span class="id" title="definition">throwIf</span></a> (<a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#authorized_value"><span class="id" title="variable">authorized_value</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.NArith.BinNat.html#b39870dee55afcd85c6b795fb34de165"><span class="id" title="notation">&lt;?</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#param"><span class="id" title="variable">param</span></a>.(<a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#value"><span class="id" title="projection">value</span></a>)) <a class="idref" href="ConCert.Execution.Monads.html#bbeef38f67325be53cb9324ba9182131"><span class="id" title="notation">;</span></a> <span class="comment">(*&nbsp;NotEnoughAllowance&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> (<a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#Dexter2Lqt.update_allowance"><span class="id" title="definition">update_allowance</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#allowance_key"><span class="id" title="variable">allowance_key</span></a> (<a class="idref" href="ConCert.Execution.Examples.Common.html#maybe"><span class="id" title="definition">maybe</span></a> (<a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#authorized_value"><span class="id" title="variable">authorized_value</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.NArith.BinNat.html#81673c7f7694c33c829aabf88ab05436"><span class="id" title="notation">-</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#param"><span class="id" title="variable">param</span></a>.(<a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#value"><span class="id" title="projection">value</span></a>))) <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#allowances_"><span class="id" title="variable">allowances_</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Monads.html#bbeef38f67325be53cb9324ba9182131"><span class="id" title="notation">)</span></a> <a class="idref" href="ConCert.Execution.Monads.html#bbeef38f67325be53cb9324ba9182131"><span class="id" title="notation">;</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Monads.html#bbeef38f67325be53cb9324ba9182131"><span class="id" title="notation">do</span></a> <span class="id" title="var">tokens_</span> <a class="idref" href="ConCert.Execution.Monads.html#bbeef38f67325be53cb9324ba9182131"><span class="id" title="notation">&lt;-</span></a> <span class="comment">(*&nbsp;Update&nbsp;from&nbsp;balance&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Monads.html#bbeef38f67325be53cb9324ba9182131"><span class="id" title="notation">(</span></a><span class="id" title="keyword">let</span> <span class="id" title="var">from_balance</span> := <a class="idref" href="ConCert.Execution.Extras.html#with_default"><span class="id" title="definition">with_default</span></a> 0 (<a class="idref" href="ConCert.Execution.Examples.Common.html#AddressMap.find"><span class="id" title="definition">AddressMap.find</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#param"><span class="id" title="variable">param</span></a>.(<a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#from"><span class="id" title="projection">from</span></a>) <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#tokens_"><span class="id" title="variable">tokens_</span></a>) <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Monads.html#bbeef38f67325be53cb9324ba9182131"><span class="id" title="notation">do</span></a> <span class="id" title="var">_</span> <a class="idref" href="ConCert.Execution.Monads.html#bbeef38f67325be53cb9324ba9182131"><span class="id" title="notation">&lt;-</span></a> <a class="idref" href="ConCert.Execution.Examples.Common.html#throwIf"><span class="id" title="definition">throwIf</span></a> (<a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#from_balance"><span class="id" title="variable">from_balance</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.NArith.BinNat.html#b39870dee55afcd85c6b795fb34de165"><span class="id" title="notation">&lt;?</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#param"><span class="id" title="variable">param</span></a>.(<a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#value"><span class="id" title="projection">value</span></a>)) <a class="idref" href="ConCert.Execution.Monads.html#bbeef38f67325be53cb9324ba9182131"><span class="id" title="notation">;</span></a> <span class="comment">(*&nbsp;NotEnoughBalance&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> (<a class="idref" href="ConCert.Execution.Examples.Common.html#AddressMap.update"><span class="id" title="definition">AddressMap.update</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#param"><span class="id" title="variable">param</span></a>.(<a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#from"><span class="id" title="projection">from</span></a>) (<a class="idref" href="ConCert.Execution.Examples.Common.html#maybe"><span class="id" title="definition">maybe</span></a> (<a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#from_balance"><span class="id" title="variable">from_balance</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.NArith.BinNat.html#81673c7f7694c33c829aabf88ab05436"><span class="id" title="notation">-</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#param"><span class="id" title="variable">param</span></a>.(<a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#value"><span class="id" title="projection">value</span></a>))) <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#tokens_"><span class="id" title="variable">tokens_</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Monads.html#bbeef38f67325be53cb9324ba9182131"><span class="id" title="notation">)</span></a> <a class="idref" href="ConCert.Execution.Monads.html#bbeef38f67325be53cb9324ba9182131"><span class="id" title="notation">;</span></a><br/>
&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">tokens_</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">to_balance</span> := <a class="idref" href="ConCert.Execution.Extras.html#with_default"><span class="id" title="definition">with_default</span></a> 0 (<a class="idref" href="ConCert.Execution.Examples.Common.html#AddressMap.find"><span class="id" title="definition">AddressMap.find</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#param"><span class="id" title="variable">param</span></a>.(<a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#to"><span class="id" title="projection">to</span></a>) <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#tokens_"><span class="id" title="variable">tokens_</span></a>) <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Examples.Common.html#AddressMap.update"><span class="id" title="definition">AddressMap.update</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#param"><span class="id" title="variable">param</span></a>.(<a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#to"><span class="id" title="projection">to</span></a>) (<a class="idref" href="ConCert.Execution.Examples.Common.html#maybe"><span class="id" title="definition">maybe</span></a> (<a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#to_balance"><span class="id" title="variable">to_balance</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.NArith.BinNat.html#64708cc1fcff61c206ed571fe7828ea8"><span class="id" title="notation">+</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#param"><span class="id" title="variable">param</span></a>.(<a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#value"><span class="id" title="projection">value</span></a>))) <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#tokens_"><span class="id" title="variable">tokens_</span></a> <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> (<a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#state"><span class="id" title="variable">state</span></a><a class="idref" href="ConCert.Utils.RecordSet.html#f46003504e2d2076ab5611d27918b097"><span class="id" title="notation">&lt;|</span></a><a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#tokens"><span class="id" title="projection">tokens</span></a> <a class="idref" href="ConCert.Utils.RecordSet.html#f46003504e2d2076ab5611d27918b097"><span class="id" title="notation">:=</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#tokens_"><span class="id" title="variable">tokens_</span></a><a class="idref" href="ConCert.Utils.RecordSet.html#f46003504e2d2076ab5611d27918b097"><span class="id" title="notation">|&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Utils.RecordSet.html#f46003504e2d2076ab5611d27918b097"><span class="id" title="notation">&lt;|</span></a><a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#allowances"><span class="id" title="projection">allowances</span></a> <a class="idref" href="ConCert.Utils.RecordSet.html#f46003504e2d2076ab5611d27918b097"><span class="id" title="notation">:=</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#allowances_"><span class="id" title="variable">allowances_</span></a><a class="idref" href="ConCert.Utils.RecordSet.html#f46003504e2d2076ab5611d27918b097"><span class="id" title="notation">|&gt;</span></a>).<br/>

<br/>
</div>

<div class="doc">
<a name="lab207"></a><h2 class="section">Approve</h2>
 The caller approves the <span class="inlinecode"><a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#spender"><span class="id" title="projection">spender</span></a></span> to transfer up to <span class="inlinecode"><a class="idref" href="ConCert.Execution.Examples.FA2Interface.html#amount"><span class="id" title="projection">amount</span></a></span> tokens on behalf of the <span class="inlinecode"><a class="idref" href="ConCert.Embedding.Examples.crowdfunding.CrowdfundingData.html#sender"><span class="id" title="definition">sender</span></a></span> 
</div>
<div class="code">
<span class="id" title="keyword">Definition</span> <a name="Dexter2Lqt.try_approve"><span class="id" title="definition">try_approve</span></a> (<span class="id" title="var">sender</span> : <a class="idref" href="ConCert.Execution.Blockchain.html#Address"><span class="id" title="method">Address</span></a>) (<span class="id" title="var">param</span> : <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#approve_param"><span class="id" title="record">approve_param</span></a>) (<span class="id" title="var">state</span> : <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#State"><span class="id" title="record">State</span></a>) : <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#option"><span class="id" title="inductive">option</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#State"><span class="id" title="record">State</span></a> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">allowances_</span> := <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#state"><span class="id" title="variable">state</span></a>.(<a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#allowances"><span class="id" title="projection">allowances</span></a>) <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">allowance_key</span> := <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#sender"><span class="id" title="variable">sender</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#param"><span class="id" title="variable">param</span></a>.(<a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#spender"><span class="id" title="projection">spender</span></a>)<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">previous_value</span> := <a class="idref" href="ConCert.Execution.Extras.html#with_default"><span class="id" title="definition">with_default</span></a> 0 (<a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#Dexter2Lqt.find_allowance"><span class="id" title="definition">find_allowance</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#allowance_key"><span class="id" title="variable">allowance_key</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#allowances_"><span class="id" title="variable">allowances_</span></a>) <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Monads.html#bbeef38f67325be53cb9324ba9182131"><span class="id" title="notation">do</span></a> <span class="id" title="var">_</span> <a class="idref" href="ConCert.Execution.Monads.html#bbeef38f67325be53cb9324ba9182131"><span class="id" title="notation">&lt;-</span></a> <a class="idref" href="ConCert.Execution.Examples.Common.html#throwIf"><span class="id" title="definition">throwIf</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#andb"><span class="id" title="definition">andb</span></a> (0 <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.NArith.BinNat.html#b39870dee55afcd85c6b795fb34de165"><span class="id" title="notation">&lt;?</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#previous_value"><span class="id" title="variable">previous_value</span></a>) (0 <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.NArith.BinNat.html#b39870dee55afcd85c6b795fb34de165"><span class="id" title="notation">&lt;?</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#param"><span class="id" title="variable">param</span></a>.(<a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#value_"><span class="id" title="projection">value_</span></a>))) <a class="idref" href="ConCert.Execution.Monads.html#bbeef38f67325be53cb9324ba9182131"><span class="id" title="notation">;</span></a> <span class="comment">(*&nbsp;UnsafeAllowanceChange&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">allowances_</span> := <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#Dexter2Lqt.update_allowance"><span class="id" title="definition">update_allowance</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#allowance_key"><span class="id" title="variable">allowance_key</span></a> (<a class="idref" href="ConCert.Execution.Examples.Common.html#maybe"><span class="id" title="definition">maybe</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#param"><span class="id" title="variable">param</span></a>.(<a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#value_"><span class="id" title="projection">value_</span></a>)) <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#allowances_"><span class="id" title="variable">allowances_</span></a> <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> (<a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#state"><span class="id" title="variable">state</span></a><a class="idref" href="ConCert.Utils.RecordSet.html#f46003504e2d2076ab5611d27918b097"><span class="id" title="notation">&lt;|</span></a><a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#allowances"><span class="id" title="projection">allowances</span></a> <a class="idref" href="ConCert.Utils.RecordSet.html#f46003504e2d2076ab5611d27918b097"><span class="id" title="notation">:=</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#allowances_"><span class="id" title="variable">allowances_</span></a><a class="idref" href="ConCert.Utils.RecordSet.html#f46003504e2d2076ab5611d27918b097"><span class="id" title="notation">|&gt;</span></a>).<br/>

<br/>
</div>

<div class="doc">
<a name="lab208"></a><h2 class="section">Mint or burn</h2>
 If <span class="inlinecode"><a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2CPMM.html#quantitiy"><span class="id" title="variable">quantitiy</span></a></span> is positive
    then creates <span class="inlinecode"><a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#quantity"><span class="id" title="projection">quantity</span></a></span> tokens and gives them to <span class="inlinecode"><a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#target"><span class="id" title="projection">target</span></a></span>
    else removes <span class="inlinecode"><a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#quantity"><span class="id" title="projection">quantity</span></a></span> tokens from <span class="inlinecode"><a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#target"><span class="id" title="projection">target</span></a></span>.
    Can only be called by <span class="inlinecode"><a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#admin"><span class="id" title="projection">admin</span></a></span> 
</div>
<div class="code">
<span class="id" title="keyword">Definition</span> <a name="Dexter2Lqt.try_mint_or_burn"><span class="id" title="definition">try_mint_or_burn</span></a> (<span class="id" title="var">sender</span> : <a class="idref" href="ConCert.Execution.Blockchain.html#Address"><span class="id" title="method">Address</span></a>) (<span class="id" title="var">param</span> : <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#mintOrBurn_param"><span class="id" title="record">mintOrBurn_param</span></a>) (<span class="id" title="var">state</span> : <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#State"><span class="id" title="record">State</span></a>) : <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#option"><span class="id" title="inductive">option</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#State"><span class="id" title="record">State</span></a> :=<br/>
&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Monads.html#bbeef38f67325be53cb9324ba9182131"><span class="id" title="notation">do</span></a> <span class="id" title="var">_</span> <a class="idref" href="ConCert.Execution.Monads.html#bbeef38f67325be53cb9324ba9182131"><span class="id" title="notation">&lt;-</span></a> <a class="idref" href="ConCert.Execution.Examples.Common.html#throwIf"><span class="id" title="definition">throwIf</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#negb"><span class="id" title="definition">negb</span></a> (<a class="idref" href="ConCert.Execution.Blockchain.html#address_eqb"><span class="id" title="method">address_eqb</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#sender"><span class="id" title="variable">sender</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#state"><span class="id" title="variable">state</span></a>.(<a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#admin"><span class="id" title="projection">admin</span></a>))) <a class="idref" href="ConCert.Execution.Monads.html#bbeef38f67325be53cb9324ba9182131"><span class="id" title="notation">;</span></a><br/>
&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">tokens_</span> := <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#state"><span class="id" title="variable">state</span></a>.(<a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#tokens"><span class="id" title="projection">tokens</span></a>) <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">old_balance</span> := <a class="idref" href="ConCert.Execution.Extras.html#with_default"><span class="id" title="definition">with_default</span></a> 0 (<a class="idref" href="ConCert.Execution.Examples.Common.html#AddressMap.find"><span class="id" title="definition">AddressMap.find</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#param"><span class="id" title="variable">param</span></a>.(<a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#target"><span class="id" title="projection">target</span></a>) <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#tokens_"><span class="id" title="variable">tokens_</span></a>) <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">new_balance</span> := (<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.ZArith.BinInt.html#Z.of_N"><span class="id" title="definition">Z.of_N</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#old_balance"><span class="id" title="variable">old_balance</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.ZArith.BinInt.html#46584eddd5fdb16176a10a2843177d3a"><span class="id" title="notation">+</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#param"><span class="id" title="variable">param</span></a>.(<a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#quantity"><span class="id" title="projection">quantity</span></a>))%<span class="id" title="var">Z</span> <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Monads.html#bbeef38f67325be53cb9324ba9182131"><span class="id" title="notation">do</span></a> <span class="id" title="var">_</span> <a class="idref" href="ConCert.Execution.Monads.html#bbeef38f67325be53cb9324ba9182131"><span class="id" title="notation">&lt;-</span></a> <a class="idref" href="ConCert.Execution.Examples.Common.html#throwIf"><span class="id" title="definition">throwIf</span></a> (<a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#new_balance"><span class="id" title="variable">new_balance</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.ZArith.BinInt.html#f1746f02f141d025b1e53605943919bf"><span class="id" title="notation">&lt;?</span></a> 0)%<span class="id" title="var">Z</span> <a class="idref" href="ConCert.Execution.Monads.html#bbeef38f67325be53cb9324ba9182131"><span class="id" title="notation">;</span></a> <span class="comment">(*&nbsp;Cannot&nbsp;burn&nbsp;more&nbsp;than&nbsp;the&nbsp;target's&nbsp;balance.&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">tokens_</span> := <a class="idref" href="ConCert.Execution.Examples.Common.html#AddressMap.update"><span class="id" title="definition">AddressMap.update</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#param"><span class="id" title="variable">param</span></a>.(<a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#target"><span class="id" title="projection">target</span></a>) (<a class="idref" href="ConCert.Execution.Examples.Common.html#maybe"><span class="id" title="definition">maybe</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.ZArith.BinInt.html#Z.to_N"><span class="id" title="definition">Z.to_N</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#new_balance"><span class="id" title="variable">new_balance</span></a>)) <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#tokens_"><span class="id" title="variable">tokens_</span></a> <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">total_supply_</span> := <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.ZArith.BinInt.html#Z.abs_N"><span class="id" title="definition">Z.abs_N</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.ZArith.BinInt.html#Z.of_N"><span class="id" title="definition">Z.of_N</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#state"><span class="id" title="variable">state</span></a>.(<a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#total_supply"><span class="id" title="projection">total_supply</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.ZArith.BinInt.html#46584eddd5fdb16176a10a2843177d3a"><span class="id" title="notation">+</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#param"><span class="id" title="variable">param</span></a>.(<a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#quantity"><span class="id" title="projection">quantity</span></a>))%<span class="id" title="var">Z</span> <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> (<a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#state"><span class="id" title="variable">state</span></a><a class="idref" href="ConCert.Utils.RecordSet.html#f46003504e2d2076ab5611d27918b097"><span class="id" title="notation">&lt;|</span></a><a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#tokens"><span class="id" title="projection">tokens</span></a> <a class="idref" href="ConCert.Utils.RecordSet.html#f46003504e2d2076ab5611d27918b097"><span class="id" title="notation">:=</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#tokens_"><span class="id" title="variable">tokens_</span></a><a class="idref" href="ConCert.Utils.RecordSet.html#f46003504e2d2076ab5611d27918b097"><span class="id" title="notation">|&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Utils.RecordSet.html#f46003504e2d2076ab5611d27918b097"><span class="id" title="notation">&lt;|</span></a><a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#total_supply"><span class="id" title="projection">total_supply</span></a> <a class="idref" href="ConCert.Utils.RecordSet.html#f46003504e2d2076ab5611d27918b097"><span class="id" title="notation">:=</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#total_supply_"><span class="id" title="variable">total_supply_</span></a><a class="idref" href="ConCert.Utils.RecordSet.html#f46003504e2d2076ab5611d27918b097"><span class="id" title="notation">|&gt;</span></a>).<br/>

<br/>
<span class="id" title="keyword">Definition</span> <a name="Dexter2Lqt.mk_callback"><span class="id" title="definition">mk_callback</span></a> (<span class="id" title="var">to_addr</span> : <a class="idref" href="ConCert.Execution.Blockchain.html#Address"><span class="id" title="method">Address</span></a>) (<span class="id" title="var">msg</span> : @<a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#FA12ReceiverMsg"><span class="id" title="inductive">FA12ReceiverMsg</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#unit"><span class="id" title="inductive">unit</span></a> <span class="id" title="var">_</span>) :=<br/>
&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#act_call"><span class="id" title="constructor">act_call</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#to_addr"><span class="id" title="variable">to_addr</span></a> 0 (<a class="idref" href="ConCert.Execution.Serializable.html#serialize"><span class="id" title="method">serialize</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#msg"><span class="id" title="variable">msg</span></a>).<br/>

<br/>
<span class="id" title="keyword">Definition</span> <a name="Dexter2Lqt.receive_allowance_"><span class="id" title="definition">receive_allowance_</span></a> <span class="id" title="var">n</span> := @<a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#receive_allowance"><span class="id" title="constructor">receive_allowance</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#unit"><span class="id" title="inductive">unit</span></a> <span class="id" title="var">_</span> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#n"><span class="id" title="variable">n</span></a>.<br/>
<span class="id" title="keyword">Definition</span> <a name="Dexter2Lqt.receive_balance_of_"><span class="id" title="definition">receive_balance_of_</span></a> <span class="id" title="var">n</span> := @<a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#receive_balance_of"><span class="id" title="constructor">receive_balance_of</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#unit"><span class="id" title="inductive">unit</span></a> <span class="id" title="var">_</span> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#n"><span class="id" title="variable">n</span></a>.<br/>
<span class="id" title="keyword">Definition</span> <a name="Dexter2Lqt.receive_total_supply_"><span class="id" title="definition">receive_total_supply_</span></a> <span class="id" title="var">n</span> := @<a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#receive_total_supply"><span class="id" title="constructor">receive_total_supply</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#unit"><span class="id" title="inductive">unit</span></a> <span class="id" title="var">_</span> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#n"><span class="id" title="variable">n</span></a>.<br/>

<br/>
</div>

<div class="doc">
<a name="lab209"></a><h2 class="section">Get allowance</h2>
 Get the quantity that <span class="inlinecode"><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#snd"><span class="id" title="definition">snd</span></a></span> <span class="inlinecode"><a class="idref" href="ConCert.Execution.Examples.FA2Interface.html#request"><span class="id" title="projection">request</span></a></span> is allowed to spend on behalf of <span class="inlinecode"><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#fst"><span class="id" title="definition">fst</span></a></span> <span class="inlinecode"><a class="idref" href="ConCert.Execution.Examples.FA2Interface.html#request"><span class="id" title="projection">request</span></a></span> 
</div>
<div class="code">
<span class="id" title="keyword">Definition</span> <a name="Dexter2Lqt.try_get_allowance"><span class="id" title="definition">try_get_allowance</span></a> (<span class="id" title="var">sender</span> : <a class="idref" href="ConCert.Execution.Blockchain.html#Address"><span class="id" title="method">Address</span></a>) (<span class="id" title="var">param</span> : <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#getAllowance_param"><span class="id" title="record">getAllowance_param</span></a>) (<span class="id" title="var">state</span> : <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#State"><span class="id" title="record">State</span></a>) : <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#list"><span class="id" title="inductive">list</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#ActionBody"><span class="id" title="inductive">ActionBody</span></a> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">value</span> := <a class="idref" href="ConCert.Execution.Extras.html#with_default"><span class="id" title="definition">with_default</span></a> 0 (<a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#Dexter2Lqt.find_allowance"><span class="id" title="definition">find_allowance</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#param"><span class="id" title="variable">param</span></a>.(<a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#request"><span class="id" title="projection">request</span></a>) <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#state"><span class="id" title="variable">state</span></a>.(<a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#allowances"><span class="id" title="projection">allowances</span></a>)) <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#ddd65c2f7ee73ecec433744948d846bb"><span class="id" title="notation">[</span></a><a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#Dexter2Lqt.mk_callback"><span class="id" title="definition">mk_callback</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#param"><span class="id" title="variable">param</span></a>.(<a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#allowance_callback"><span class="id" title="projection">allowance_callback</span></a>) (<a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#Dexter2Lqt.receive_allowance_"><span class="id" title="definition">receive_allowance_</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#value"><span class="id" title="variable">value</span></a>)<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#ddd65c2f7ee73ecec433744948d846bb"><span class="id" title="notation">]</span></a>.<br/>

<br/>
</div>

<div class="doc">
<a name="lab210"></a><h2 class="section">Get balance</h2>
 Get the quantity of tokens belonging to <span class="inlinecode"><a class="idref" href="ConCert.Execution.Examples.FA2Interface.html#owner"><span class="id" title="projection">owner</span></a></span> 
</div>
<div class="code">
<span class="id" title="keyword">Definition</span> <a name="Dexter2Lqt.try_get_balance"><span class="id" title="definition">try_get_balance</span></a> (<span class="id" title="var">sender</span> : <a class="idref" href="ConCert.Execution.Blockchain.html#Address"><span class="id" title="method">Address</span></a>) (<span class="id" title="var">param</span> : <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#getBalance_param"><span class="id" title="record">getBalance_param</span></a>) (<span class="id" title="var">state</span> : <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#State"><span class="id" title="record">State</span></a>) : <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#list"><span class="id" title="inductive">list</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#ActionBody"><span class="id" title="inductive">ActionBody</span></a> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">value</span> := <a class="idref" href="ConCert.Execution.Extras.html#with_default"><span class="id" title="definition">with_default</span></a> 0 (<a class="idref" href="ConCert.Execution.Examples.Common.html#AddressMap.find"><span class="id" title="definition">AddressMap.find</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#param"><span class="id" title="variable">param</span></a>.(<a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#owner_"><span class="id" title="projection">owner_</span></a>) <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#state"><span class="id" title="variable">state</span></a>.(<a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#tokens"><span class="id" title="projection">tokens</span></a>)) <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#ddd65c2f7ee73ecec433744948d846bb"><span class="id" title="notation">[</span></a><a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#Dexter2Lqt.mk_callback"><span class="id" title="definition">mk_callback</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#param"><span class="id" title="variable">param</span></a>.(<a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#balance_callback"><span class="id" title="projection">balance_callback</span></a>) (<a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#Dexter2Lqt.receive_balance_of_"><span class="id" title="definition">receive_balance_of_</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#value"><span class="id" title="variable">value</span></a>)<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#ddd65c2f7ee73ecec433744948d846bb"><span class="id" title="notation">]</span></a>.<br/>

<br/>
</div>

<div class="doc">
<a name="lab211"></a><h2 class="section">Get total supply</h2>
 Get the total supply of tokens 
</div>
<div class="code">
<span class="id" title="keyword">Definition</span> <a name="Dexter2Lqt.try_get_total_supply"><span class="id" title="definition">try_get_total_supply</span></a> (<span class="id" title="var">sender</span> : <a class="idref" href="ConCert.Execution.Blockchain.html#Address"><span class="id" title="method">Address</span></a>) (<span class="id" title="var">param</span> : <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#getTotalSupply_param"><span class="id" title="record">getTotalSupply_param</span></a>) (<span class="id" title="var">state</span> : <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#State"><span class="id" title="record">State</span></a>) : <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#list"><span class="id" title="inductive">list</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#ActionBody"><span class="id" title="inductive">ActionBody</span></a> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">value</span> := <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#state"><span class="id" title="variable">state</span></a>.(<a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#total_supply"><span class="id" title="projection">total_supply</span></a>) <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#ddd65c2f7ee73ecec433744948d846bb"><span class="id" title="notation">[</span></a><a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#Dexter2Lqt.mk_callback"><span class="id" title="definition">mk_callback</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#param"><span class="id" title="variable">param</span></a>.(<a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#supply_callback"><span class="id" title="projection">supply_callback</span></a>) (<a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#Dexter2Lqt.receive_total_supply_"><span class="id" title="definition">receive_total_supply_</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#value"><span class="id" title="variable">value</span></a>)<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#ddd65c2f7ee73ecec433744948d846bb"><span class="id" title="notation">]</span></a>.<br/>

<br/>
</div>

<div class="doc">
<a name="lab212"></a><h2 class="section">Init</h2>
 Initalize contract storage 
</div>
<div class="code">
<span class="id" title="keyword">Definition</span> <a name="Dexter2Lqt.init"><span class="id" title="definition">init</span></a> (<span class="id" title="var">chain</span> : <a class="idref" href="ConCert.Execution.Blockchain.html#Chain"><span class="id" title="record">Chain</span></a>) (<span class="id" title="var">ctx</span> : <a class="idref" href="ConCert.Execution.Blockchain.html#ContractCallContext"><span class="id" title="record">ContractCallContext</span></a>) (<span class="id" title="var">setup</span> : <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#Setup"><span class="id" title="record">Setup</span></a>) : <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#option"><span class="id" title="inductive">option</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#State"><span class="id" title="record">State</span></a> :=<br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> {|<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#build_state"><span class="id" title="constructor">tokens</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#build_state"><span class="id" title="constructor">:=</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#build_state"><span class="id" title="constructor">AddressMap.add</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#build_state"><span class="id" title="constructor">setup</span></a><a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#build_state"><span class="id" title="constructor">.(</span></a><a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#build_state"><span class="id" title="constructor">lqt_provider</span></a><a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#build_state"><span class="id" title="constructor">)</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#build_state"><span class="id" title="constructor">setup</span></a><a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#build_state"><span class="id" title="constructor">.(</span></a><a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#build_state"><span class="id" title="constructor">initial_pool</span></a><a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#build_state"><span class="id" title="constructor">)</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#build_state"><span class="id" title="constructor">AddressMap.empty</span></a><a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#build_state"><span class="id" title="constructor">;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#build_state"><span class="id" title="constructor">allowances</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#build_state"><span class="id" title="constructor">:=</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#build_state"><span class="id" title="constructor">empty_allowance</span></a><a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#build_state"><span class="id" title="constructor">;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#build_state"><span class="id" title="constructor">admin</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#build_state"><span class="id" title="constructor">:=</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#build_state"><span class="id" title="constructor">setup</span></a><a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#build_state"><span class="id" title="constructor">.(</span></a><a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#build_state"><span class="id" title="constructor">admin_</span></a><a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#build_state"><span class="id" title="constructor">);</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#build_state"><span class="id" title="constructor">total_supply</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#build_state"><span class="id" title="constructor">:=</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#build_state"><span class="id" title="constructor">setup</span></a><a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#build_state"><span class="id" title="constructor">.(</span></a><a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#build_state"><span class="id" title="constructor">initial_pool</span></a><a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#build_state"><span class="id" title="constructor">);</span></a><br/>
&nbsp;&nbsp;|}.<br/>

<br/>
</div>

<div class="doc">
<a name="lab213"></a><h2 class="section">Receive</h2>
 Contract main entrypoint 
</div>
<div class="code">
<span class="id" title="keyword">Open</span> <span class="id" title="keyword">Scope</span> <span class="id" title="var">Z_scope</span>.<br/>
<span class="id" title="keyword">Definition</span> <a name="Dexter2Lqt.receive"><span class="id" title="definition">receive</span></a> (<span class="id" title="var">chain</span> : <a class="idref" href="ConCert.Execution.Blockchain.html#Chain"><span class="id" title="record">Chain</span></a>) (<span class="id" title="var">ctx</span> : <a class="idref" href="ConCert.Execution.Blockchain.html#ContractCallContext"><span class="id" title="record">ContractCallContext</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">state</span> : <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#State"><span class="id" title="record">State</span></a>) (<span class="id" title="var">maybe_msg</span> : <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#option"><span class="id" title="inductive">option</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#Msg"><span class="id" title="inductive">Msg</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;: <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#option"><span class="id" title="inductive">option</span></a> (<a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#State"><span class="id" title="record">State</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#11c698c8685bb8ab1cf725545c085ac4"><span class="id" title="notation">*</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#list"><span class="id" title="inductive">list</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#ActionBody"><span class="id" title="inductive">ActionBody</span></a>) :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">sender</span> := <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#ctx"><span class="id" title="variable">ctx</span></a>.(<a class="idref" href="ConCert.Execution.Blockchain.html#ctx_from"><span class="id" title="projection">ctx_from</span></a>) <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">without_actions</span> := <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#option_map"><span class="id" title="definition">option_map</span></a> (<span class="id" title="keyword">fun</span> <span class="id" title="var">new_state</span> =&gt; <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#new_state"><span class="id" title="variable">new_state</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#ae9a5e1034e143b218b09d8e454472bd"><span class="id" title="notation">[]</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a>) <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">without_statechange</span> <span class="id" title="var">acts</span> := <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#state"><span class="id" title="variable">state</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#acts"><span class="id" title="variable">acts</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Monads.html#bbeef38f67325be53cb9324ba9182131"><span class="id" title="notation">do</span></a> <span class="id" title="var">_</span> <a class="idref" href="ConCert.Execution.Monads.html#bbeef38f67325be53cb9324ba9182131"><span class="id" title="notation">&lt;-</span></a> <a class="idref" href="ConCert.Execution.Examples.Common.html#throwIf"><span class="id" title="definition">throwIf</span></a> (<a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#non_zero_amount"><span class="id" title="definition">non_zero_amount</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#ctx"><span class="id" title="variable">ctx</span></a>.(<a class="idref" href="ConCert.Execution.Blockchain.html#ctx_amount"><span class="id" title="projection">ctx_amount</span></a>))<a class="idref" href="ConCert.Execution.Monads.html#bbeef38f67325be53cb9324ba9182131"><span class="id" title="notation">;</span></a> <span class="comment">(*&nbsp;DontSendTez&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#maybe_msg"><span class="id" title="variable">maybe_msg</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> (<a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#msg_transfer"><span class="id" title="constructor">msg_transfer</span></a> <span class="id" title="var">param</span>) =&gt; <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#without_actions"><span class="id" title="variable">without_actions</span></a> (<a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#Dexter2Lqt.try_transfer"><span class="id" title="definition">try_transfer</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#sender"><span class="id" title="variable">sender</span></a> <span class="id" title="var">param</span> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#state"><span class="id" title="variable">state</span></a>)<br/>
&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> (<a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#msg_approve"><span class="id" title="constructor">msg_approve</span></a> <span class="id" title="var">param</span>) =&gt; <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#without_actions"><span class="id" title="variable">without_actions</span></a> (<a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#Dexter2Lqt.try_approve"><span class="id" title="definition">try_approve</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#sender"><span class="id" title="variable">sender</span></a> <span class="id" title="var">param</span> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#state"><span class="id" title="variable">state</span></a>)<br/>
&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> (<a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#msg_mint_or_burn"><span class="id" title="constructor">msg_mint_or_burn</span></a> <span class="id" title="var">param</span>) =&gt; <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#without_actions"><span class="id" title="variable">without_actions</span></a> (<a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#Dexter2Lqt.try_mint_or_burn"><span class="id" title="definition">try_mint_or_burn</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#sender"><span class="id" title="variable">sender</span></a> <span class="id" title="var">param</span> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#state"><span class="id" title="variable">state</span></a>)<br/>
&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> (<a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#msg_get_allowance"><span class="id" title="constructor">msg_get_allowance</span></a> <span class="id" title="var">param</span>) =&gt; <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#without_statechange"><span class="id" title="variable">without_statechange</span></a> (<a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#Dexter2Lqt.try_get_allowance"><span class="id" title="definition">try_get_allowance</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#sender"><span class="id" title="variable">sender</span></a> <span class="id" title="var">param</span> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#state"><span class="id" title="variable">state</span></a>)<br/>
&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> (<a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#msg_get_balance"><span class="id" title="constructor">msg_get_balance</span></a> <span class="id" title="var">param</span>) =&gt; <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#without_statechange"><span class="id" title="variable">without_statechange</span></a> (<a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#Dexter2Lqt.try_get_balance"><span class="id" title="definition">try_get_balance</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#sender"><span class="id" title="variable">sender</span></a> <span class="id" title="var">param</span> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#state"><span class="id" title="variable">state</span></a>)<br/>
&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> (<a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#msg_get_total_supply"><span class="id" title="constructor">msg_get_total_supply</span></a> <span class="id" title="var">param</span>) =&gt; <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#without_statechange"><span class="id" title="variable">without_statechange</span></a> (<a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#Dexter2Lqt.try_get_total_supply"><span class="id" title="definition">try_get_total_supply</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#sender"><span class="id" title="variable">sender</span></a> <span class="id" title="var">param</span> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#state"><span class="id" title="variable">state</span></a>)<br/>
&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a> =&gt; <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a> <span class="comment">(*&nbsp;Transfer&nbsp;actions&nbsp;to&nbsp;this&nbsp;contract&nbsp;are&nbsp;not&nbsp;allowed&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>
<span class="id" title="keyword">Close</span> <span class="id" title="keyword">Scope</span> <span class="id" title="var">Z_scope</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <a name="Dexter2Lqt.contract"><span class="id" title="definition">contract</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#Contract"><span class="id" title="record">Contract</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#Setup"><span class="id" title="record">Setup</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#Msg"><span class="id" title="inductive">Msg</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#State"><span class="id" title="record">State</span></a> :=<br/>
&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#build_contract"><span class="id" title="constructor">build_contract</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#Dexter2Lqt.init"><span class="id" title="definition">init</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#Dexter2Lqt.receive"><span class="id" title="definition">receive</span></a>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">End</span> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#Dexter2Lqt.DexterLqtDefs"><span class="id" title="section">DexterLqtDefs</span></a>.<br/>
<span class="id" title="keyword">End</span> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#Dexter2Lqt"><span class="id" title="module">Dexter2Lqt</span></a>.<br/>

<br/>
<span class="id" title="keyword">Module</span> <a name="DEX2LQT"><span class="id" title="module">DEX2LQT</span></a> := <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#Dexter2Lqt"><span class="id" title="module">Dexter2Lqt</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#D2LqtSInstances"><span class="id" title="module">D2LqtSInstances</span></a>.<br/>
<span class="id" title="keyword">Import</span> <span class="id" title="var">DEX2LQT</span>.<br/>

<br/>
</div>

<div class="doc">
<a name="lab214"></a><h1 class="section">Properties</h1>

</div>
<div class="code">
<span class="id" title="keyword">Section</span> <a name="Theories"><span class="id" title="section">Theories</span></a>.<br/>

<br/>
<span class="id" title="keyword">Context</span> `{<a class="idref" href="ConCert.Execution.Blockchain.html#ChainBase"><span class="id" title="class">ChainBase</span></a>}.<br/>

<br/>
<span class="id" title="keyword">Open</span> <span class="id" title="keyword">Scope</span> <span class="id" title="var">N_scope</span>.<br/>

<br/>

<br/>
</div>

<div class="doc">
<a name="lab215"></a><h2 class="section">Contract rejects money</h2>
 <span class="inlinecode"><a class="idref" href="ConCert.Execution.Examples.BAT_AltFix.html#receive"><span class="id" title="definition">receive</span></a></span> only returns Some if the sender amount is zero 
</div>
<div class="code">
<span class="id" title="keyword">Lemma</span> <a name="contract_not_payable"><span class="id" title="lemma">contract_not_payable</span></a> : <span class="id" title="keyword">forall</span> <span class="id" title="var">prev_state</span> <span class="id" title="var">new_state</span> <span class="id" title="var">chain</span> <span class="id" title="var">ctx</span> <span class="id" title="var">msg</span> <span class="id" title="var">new_acts</span>,<br/>
&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#receive"><span class="id" title="definition">receive</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#chain"><span class="id" title="variable">chain</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#ctx"><span class="id" title="variable">ctx</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#prev_state"><span class="id" title="variable">prev_state</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#msg"><span class="id" title="variable">msg</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#new_state"><span class="id" title="variable">new_state</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#new_acts"><span class="id" title="variable">new_acts</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.ZArith.BinInt.html#306329b0eca7a2b86c198702f594ad8e"><span class="id" title="notation">(</span></a><a class="idref" href="ConCert.Execution.Blockchain.html#ctx_amount"><span class="id" title="projection">ctx_amount</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#ctx"><span class="id" title="variable">ctx</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.ZArith.BinInt.html#306329b0eca7a2b86c198702f594ad8e"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.ZArith.BinInt.html#306329b0eca7a2b86c198702f594ad8e"><span class="id" title="notation">&lt;=</span></a> 0)%<span class="id" title="var">Z</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> * <span class="id" title="var">receive_some</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#receive"><span class="id" title="definition">receive</span></a>, <a class="idref" href="ConCert.Execution.Examples.Common.html#throwIf"><span class="id" title="definition">throwIf</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">receive_some</span>;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> <span class="id" title="var">receive_some</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (0 <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.ZArith.BinInt.html#f1746f02f141d025b1e53605943919bf"><span class="id" title="notation">&lt;?</span></a> <span class="id" title="var">_</span>)%<span class="id" title="var">Z</span> <span class="id" title="var">eqn</span>:<span class="id" title="var">amount</span> <span class="id" title="tactic">in</span> <span class="id" title="var">receive_some</span>.<br/>
&nbsp;&nbsp;- <span class="comment">(*&nbsp;case:&nbsp;ctx_amount&nbsp;&gt;&nbsp;0&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">congruence</span>.<br/>
&nbsp;&nbsp;- <span class="comment">(*&nbsp;case:&nbsp;ctx_amount&nbsp;&lt;=&nbsp;0&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.ZArith.BinInt.html#Z.ltb_ge"><span class="id" title="lemma">Z.ltb_ge</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">amount</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a name="contract_not_payable'"><span class="id" title="lemma">contract_not_payable'</span></a> : <span class="id" title="keyword">forall</span> <span class="id" title="var">prev_state</span> <span class="id" title="var">chain</span> <span class="id" title="var">ctx</span> <span class="id" title="var">msg</span>,<br/>
&nbsp;&nbsp;(0 <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.ZArith.BinInt.html#143d73f5a64447681988da92e84a3de5"><span class="id" title="notation">&lt;</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.ZArith.BinInt.html#143d73f5a64447681988da92e84a3de5"><span class="id" title="notation">(</span></a><a class="idref" href="ConCert.Execution.Blockchain.html#ctx_amount"><span class="id" title="projection">ctx_amount</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#ctx"><span class="id" title="variable">ctx</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.ZArith.BinInt.html#143d73f5a64447681988da92e84a3de5"><span class="id" title="notation">)</span></a>)%<span class="id" title="var">Z</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#receive"><span class="id" title="definition">receive</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#chain"><span class="id" title="variable">chain</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#ctx"><span class="id" title="variable">ctx</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#prev_state"><span class="id" title="variable">prev_state</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#msg"><span class="id" title="variable">msg</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> * <span class="id" title="var">ctx_amount_positive</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#receive"><span class="id" title="definition">receive</span></a>,<a class="idref" href="ConCert.Execution.Examples.Common.html#throwIf"><span class="id" title="definition">throwIf</span></a>;<span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (0 <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.ZArith.BinInt.html#f1746f02f141d025b1e53605943919bf"><span class="id" title="notation">&lt;?</span></a> <span class="id" title="var">_</span>)%<span class="id" title="var">Z</span> <span class="id" title="var">eqn</span>:<span class="id" title="var">amount</span>.<br/>
&nbsp;&nbsp;- <span class="comment">(*&nbsp;case:&nbsp;ctx_amount&nbsp;&gt;&nbsp;0&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;- <span class="comment">(*&nbsp;case:&nbsp;ctx_amount&nbsp;&lt;=&nbsp;0&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.ZArith.BinInt.html#Z.ltb_ge"><span class="id" title="lemma">Z.ltb_ge</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">amount</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>

<br/>
<span class="comment">(*&nbsp;Admin&nbsp;cannot&nbsp;be&nbsp;changed&nbsp;*)</span><br/>
<span class="id" title="keyword">Lemma</span> <a name="admin_constant"><span class="id" title="lemma">admin_constant</span></a> : <span class="id" title="keyword">forall</span> <span class="id" title="var">prev_state</span> <span class="id" title="var">new_state</span> <span class="id" title="var">chain</span> <span class="id" title="var">ctx</span> <span class="id" title="var">new_acts</span> <span class="id" title="var">msg</span>,<br/>
&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#receive"><span class="id" title="definition">receive</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#chain"><span class="id" title="variable">chain</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#ctx"><span class="id" title="variable">ctx</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#prev_state"><span class="id" title="variable">prev_state</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#msg"><span class="id" title="variable">msg</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#new_state"><span class="id" title="variable">new_state</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#new_acts"><span class="id" title="variable">new_acts</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#admin"><span class="id" title="projection">admin</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#prev_state"><span class="id" title="variable">prev_state</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#admin"><span class="id" title="projection">admin</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#new_state"><span class="id" title="variable">new_state</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> * <span class="id" title="var">receive_some</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">destruct_message</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="var">contract_simpl</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
<a name="lab216"></a><h2 class="section">Default entrypoint correct</h2>

</div>
<div class="code">
<span class="comment">(*&nbsp;Default&nbsp;entrypoint&nbsp;should&nbsp;never&nbsp;succeed&nbsp;*)</span><br/>
<span class="id" title="keyword">Lemma</span> <a name="default_entrypoint_none"><span class="id" title="lemma">default_entrypoint_none</span></a> : <span class="id" title="keyword">forall</span> <span class="id" title="var">prev_state</span> <span class="id" title="var">chain</span> <span class="id" title="var">ctx</span>,<br/>
&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#receive"><span class="id" title="definition">receive</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#chain"><span class="id" title="variable">chain</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#ctx"><span class="id" title="variable">ctx</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#prev_state"><span class="id" title="variable">prev_state</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> *.<br/>
&nbsp;&nbsp;<span class="id" title="var">contract_simpl</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="var">destruct_match</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
<a name="lab217"></a><h2 class="section">Transfer correct</h2>

</div>
<div class="code">
<span class="id" title="keyword">Definition</span> <a name="transfer_balance_update_correct"><span class="id" title="definition">transfer_balance_update_correct</span></a> <span class="id" title="var">old_state</span> <span class="id" title="var">new_state</span> <span class="id" title="var">from</span> <span class="id" title="var">to</span> <span class="id" title="var">amount</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">get_balance</span> <span class="id" title="var">addr</span> <span class="id" title="var">state</span> := <a class="idref" href="ConCert.Execution.Extras.html#with_default"><span class="id" title="definition">with_default</span></a> 0 (<a class="idref" href="ConCert.Execution.Containers.html#FMap.find"><span class="id" title="abbreviation">FMap.find</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#addr"><span class="id" title="variable">addr</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#state"><span class="id" title="variable">state</span></a>.(<a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#tokens"><span class="id" title="projection">tokens</span></a>)) <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">from_balance_before</span> := <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#get_balance"><span class="id" title="variable">get_balance</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#from"><span class="id" title="variable">from</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#old_state"><span class="id" title="variable">old_state</span></a> <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">to_balance_before</span> := <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#get_balance"><span class="id" title="variable">get_balance</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#to"><span class="id" title="variable">to</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#old_state"><span class="id" title="variable">old_state</span></a> <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">from_balance_after</span> := <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#get_balance"><span class="id" title="variable">get_balance</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#from"><span class="id" title="variable">from</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#new_state"><span class="id" title="variable">new_state</span></a> <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">to_balance_after</span> := <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#get_balance"><span class="id" title="variable">get_balance</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#to"><span class="id" title="variable">to</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#new_state"><span class="id" title="variable">new_state</span></a> <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;If&nbsp;the&nbsp;transfer&nbsp;is&nbsp;a&nbsp;self-transfer,&nbsp;balances&nbsp;should&nbsp;remain&nbsp;unchained&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">if</span> <a class="idref" href="ConCert.Execution.Blockchain.html#address_eqb"><span class="id" title="method">address_eqb</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#from"><span class="id" title="variable">from</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#to"><span class="id" title="variable">to</span></a><br/>
&nbsp;&nbsp;<span class="id" title="keyword">then</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#9ddeac0ab66152bd1d64bedb507a795e"><span class="id" title="notation">(</span></a><a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#from_balance_before"><span class="id" title="variable">from_balance_before</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.NArith.BinNat.html#59a5ff4a6cbb127625aba1a377a243d1"><span class="id" title="notation">=?</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#from_balance_after"><span class="id" title="variable">from_balance_after</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#9ddeac0ab66152bd1d64bedb507a795e"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#9ddeac0ab66152bd1d64bedb507a795e"><span class="id" title="notation">&amp;&amp;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#9ddeac0ab66152bd1d64bedb507a795e"><span class="id" title="notation">(</span></a><a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#to_balance_before"><span class="id" title="variable">to_balance_before</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.NArith.BinNat.html#59a5ff4a6cbb127625aba1a377a243d1"><span class="id" title="notation">=?</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#to_balance_after"><span class="id" title="variable">to_balance_after</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#9ddeac0ab66152bd1d64bedb507a795e"><span class="id" title="notation">)</span></a><br/>
&nbsp;&nbsp;<span class="id" title="keyword">else</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#9ddeac0ab66152bd1d64bedb507a795e"><span class="id" title="notation">(</span></a><a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#from_balance_before"><span class="id" title="variable">from_balance_before</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.NArith.BinNat.html#59a5ff4a6cbb127625aba1a377a243d1"><span class="id" title="notation">=?</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#from_balance_after"><span class="id" title="variable">from_balance_after</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.NArith.BinNat.html#64708cc1fcff61c206ed571fe7828ea8"><span class="id" title="notation">+</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#amount"><span class="id" title="variable">amount</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#9ddeac0ab66152bd1d64bedb507a795e"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#9ddeac0ab66152bd1d64bedb507a795e"><span class="id" title="notation">&amp;&amp;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#9ddeac0ab66152bd1d64bedb507a795e"><span class="id" title="notation">(</span></a><a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#to_balance_before"><span class="id" title="variable">to_balance_before</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.NArith.BinNat.html#64708cc1fcff61c206ed571fe7828ea8"><span class="id" title="notation">+</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#amount"><span class="id" title="variable">amount</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.NArith.BinNat.html#59a5ff4a6cbb127625aba1a377a243d1"><span class="id" title="notation">=?</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#to_balance_after"><span class="id" title="variable">to_balance_after</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#9ddeac0ab66152bd1d64bedb507a795e"><span class="id" title="notation">)</span></a>.<br/>

<br/>
</div>

<div class="doc">
<span class="inlinecode"><a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#Dexter2Lqt.try_transfer"><span class="id" title="definition">try_transfer</span></a></span> correctly moves <span class="inlinecode"><a class="idref" href="ConCert.Execution.Examples.FA2Interface.html#amount"><span class="id" title="projection">amount</span></a></span> from <span class="inlinecode"><a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#from"><span class="id" title="projection">from</span></a></span> to <span class="inlinecode"><a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#to"><span class="id" title="projection">to</span></a></span> 
</div>
<div class="code">
<span class="id" title="keyword">Lemma</span> <a name="try_transfer_balance_correct"><span class="id" title="lemma">try_transfer_balance_correct</span></a> : <span class="id" title="keyword">forall</span> <span class="id" title="var">prev_state</span> <span class="id" title="var">new_state</span> <span class="id" title="var">chain</span> <span class="id" title="var">ctx</span> <span class="id" title="var">new_acts</span> <span class="id" title="var">param</span>,<br/>
&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#receive"><span class="id" title="definition">receive</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#chain"><span class="id" title="variable">chain</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#ctx"><span class="id" title="variable">ctx</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#prev_state"><span class="id" title="variable">prev_state</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> (<a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#msg_transfer"><span class="id" title="constructor">msg_transfer</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#param"><span class="id" title="variable">param</span></a>)) <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#new_state"><span class="id" title="variable">new_state</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#new_acts"><span class="id" title="variable">new_acts</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#transfer_balance_update_correct"><span class="id" title="definition">transfer_balance_update_correct</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#prev_state"><span class="id" title="variable">prev_state</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#new_state"><span class="id" title="variable">new_state</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#param"><span class="id" title="variable">param</span></a>.(<a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#from"><span class="id" title="projection">from</span></a>) <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#param"><span class="id" title="variable">param</span></a>.(<a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#to"><span class="id" title="projection">to</span></a>) <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#param"><span class="id" title="variable">param</span></a>.(<a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#value"><span class="id" title="projection">value</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#true"><span class="id" title="constructor">true</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> * <span class="id" title="var">receive_some</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">contract_simpl</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="keyword">goal</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;[ <span class="id" title="var">H</span> : <a class="idref" href="ConCert.Execution.Extras.html#with_default"><span class="id" title="definition">with_default</span></a> 0 <span class="id" title="var">_</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.NArith.BinNat.html#b39870dee55afcd85c6b795fb34de165"><span class="id" title="notation">&lt;?</span></a> <span class="id" title="var">_</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#false"><span class="id" title="constructor">false</span></a> |- <span class="id" title="var">_</span> ] =&gt; <span class="id" title="tactic">rename</span> <span class="id" title="var">H</span> <span class="id" title="var">into</span> <span class="id" title="var">enough_balance</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.NArith.BinNat.html#N.ltb_ge"><span class="id" title="lemma">N.ltb_ge</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">enough_balance</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#transfer_balance_update_correct"><span class="id" title="definition">transfer_balance_update_correct</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">destruct_match</span> <span class="id" title="var">eqn</span>:<span class="id" title="var">from_to_eqb</span>.<br/>
&nbsp;&nbsp;- <span class="comment">(*&nbsp;from&nbsp;=&nbsp;to&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<a class="idref" href="ConCert.Execution.Blockchain.html#address_eqb_spec"><span class="id" title="method">address_eqb_spec</span></a> <span class="id" title="var">param</span>.(<a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#from"><span class="id" title="projection">from</span></a>) <span class="id" title="var">param</span>.(<a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#to"><span class="id" title="projection">to</span></a>)) <span class="id" title="keyword">as</span> [&lt;-|]; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> !<a class="idref" href="ConCert.Execution.Containers.html#FMap.map_update_idemp"><span class="id" title="lemma">FMap.map_update_idemp</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> !<a class="idref" href="ConCert.Execution.Containers.html#FMap.find_update_eq"><span class="id" title="lemma">FMap.find_update_eq</span></a> <span class="id" title="keyword">with</span> (<span class="id" title="var">map</span>:=<span class="id" title="var">prev_state</span>.(<a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#tokens"><span class="id" title="projection">tokens</span></a>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<a class="idref" href="ConCert.Execution.Containers.html#FMap.find"><span class="id" title="abbreviation">FMap.find</span></a> (<a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#from"><span class="id" title="projection">from</span></a> <span class="id" title="var">param</span>) <span class="id" title="var">_</span>) <span class="id" title="var">eqn</span>:<span class="id" title="var">from_prev</span>; <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <a class="idref" href="ConCert.Execution.Examples.Common.html#maybe_sub_add"><span class="id" title="lemma">maybe_sub_add</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">enough_balance</span> <span class="id" title="keyword">as</span> [[-&gt; -&gt;] | -&gt;]; <span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.NArith.BinNat.html#N.eqb_refl"><span class="id" title="lemma">N.eqb_refl</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.NArith.BinNat.html#N.add_0_l"><span class="id" title="lemma">N.add_0_l</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.NArith.BinNat.html#N.le_0_r"><span class="id" title="lemma">N.le_0_r</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">enough_balance</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="var">enough_balance</span>.<br/>
&nbsp;&nbsp;- <span class="comment">(*&nbsp;from&nbsp;&lt;&gt;&nbsp;to&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<a class="idref" href="ConCert.Execution.Blockchain.html#address_eqb_spec"><span class="id" title="method">address_eqb_spec</span></a> <span class="id" title="var">param</span>.(<a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#from"><span class="id" title="projection">from</span></a>) <span class="id" title="var">param</span>.(<a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#to"><span class="id" title="projection">to</span></a>)) <span class="id" title="keyword">as</span> [| <span class="id" title="var">from_to_eq</span>]; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> !<a class="idref" href="ConCert.Execution.Containers.html#FMap.find_update_ne"><span class="id" title="lemma">FMap.find_update_ne</span></a> <span class="id" title="keyword">with</span> (<span class="id" title="var">map</span>:=<span class="id" title="var">prev_state</span>.(<a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#tokens"><span class="id" title="projection">tokens</span></a>)) <span class="id" title="tactic">by</span> <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> !<a class="idref" href="ConCert.Execution.Containers.html#FMap.find_update_ne"><span class="id" title="lemma">FMap.find_update_ne</span></a> <span class="id" title="tactic">by</span> <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> !<a class="idref" href="ConCert.Execution.Containers.html#FMap.find_update_eq"><span class="id" title="lemma">FMap.find_update_eq</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<a class="idref" href="ConCert.Execution.Containers.html#FMap.find"><span class="id" title="abbreviation">FMap.find</span></a> (<a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#from"><span class="id" title="projection">from</span></a> <span class="id" title="var">param</span>) <span class="id" title="var">_</span>) <span class="id" title="var">eqn</span>:<span class="id" title="var">from_prev</span>; <span class="id" title="var">cbn</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[| <span class="id" title="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.NArith.BinNat.html#N.le_0_r"><span class="id" title="lemma">N.le_0_r</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">enough_balance</span>; <span class="id" title="tactic">rewrite</span> <span class="id" title="var">enough_balance</span>];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<a class="idref" href="ConCert.Execution.Containers.html#FMap.find"><span class="id" title="abbreviation">FMap.find</span></a> (<a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#to"><span class="id" title="projection">to</span></a> <span class="id" title="var">param</span>) <span class="id" title="var">_</span>) <span class="id" title="var">eqn</span>:<span class="id" title="var">to_prev</span>; <span class="id" title="var">cbn</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> ?<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.NArith.BinNat.html#N.add_0_l"><span class="id" title="lemma">N.add_0_l</span></a>, ?<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.NArith.BinNat.html#N.add_0_r"><span class="id" title="lemma">N.add_0_r</span></a>, ?<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.NArith.BinNat.html#N.sub_add"><span class="id" title="lemma">N.sub_add</span></a>, ?<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.NArith.BinNat.html#N.eqb_refl"><span class="id" title="lemma">N.eqb_refl</span></a> <span class="id" title="tactic">by</span> <span class="id" title="tactic">auto</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Bool.Bool.html#andb_true_iff"><span class="id" title="lemma">andb_true_iff</span></a>, ?<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.NArith.BinNat.html#N.eqb_eq"><span class="id" title="lemma">N.eqb_eq</span></a>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> <span class="id" title="var">enough_balance</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="tactic">specialize</span> (<a class="idref" href="ConCert.Execution.Examples.Common.html#maybe_cases"><span class="id" title="lemma">maybe_cases</span></a> (<span class="id" title="var">n</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.NArith.BinNat.html#81673c7f7694c33c829aabf88ab05436"><span class="id" title="notation">-</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#value"><span class="id" title="projection">value</span></a> <span class="id" title="var">param</span>)) <span class="id" title="keyword">as</span> [[-&gt; ?<span class="id" title="var">H</span>] | [-&gt; <span class="id" title="var">_</span>]];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">specialize</span> (<a class="idref" href="ConCert.Execution.Examples.Common.html#maybe_cases"><span class="id" title="lemma">maybe_cases</span></a> (<span class="id" title="var">n0</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.NArith.BinNat.html#64708cc1fcff61c206ed571fe7828ea8"><span class="id" title="notation">+</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#value"><span class="id" title="projection">value</span></a> <span class="id" title="var">param</span>)) <span class="id" title="keyword">as</span> [[-&gt; ?<span class="id" title="var">H</span>] | [-&gt; <span class="id" title="var">_</span>]];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span>; <span class="id" title="var">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="tactic">specialize</span> (<a class="idref" href="ConCert.Execution.Examples.Common.html#maybe_cases"><span class="id" title="lemma">maybe_cases</span></a> (<span class="id" title="var">n</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.NArith.BinNat.html#81673c7f7694c33c829aabf88ab05436"><span class="id" title="notation">-</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#value"><span class="id" title="projection">value</span></a> <span class="id" title="var">param</span>)) <span class="id" title="keyword">as</span> [[-&gt; ?<span class="id" title="var">H</span>] | [-&gt; <span class="id" title="var">_</span>]];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">specialize</span> (<a class="idref" href="ConCert.Execution.Examples.Common.html#maybe_cases"><span class="id" title="lemma">maybe_cases</span></a> (<a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#value"><span class="id" title="projection">value</span></a> <span class="id" title="var">param</span>)) <span class="id" title="keyword">as</span> [[-&gt; ?<span class="id" title="var">H</span>] | [-&gt; <span class="id" title="var">_</span>]];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span>; <span class="id" title="var">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="var">now</span> <span class="id" title="tactic">specialize</span> (<a class="idref" href="ConCert.Execution.Examples.Common.html#maybe_cases"><span class="id" title="lemma">maybe_cases</span></a> <span class="id" title="var">n</span>) <span class="id" title="keyword">as</span> [[-&gt; ?<span class="id" title="var">H</span>] | [-&gt; <span class="id" title="var">_</span>]].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="tactic">auto</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <a name="transfer_allowances_update_correct"><span class="id" title="definition">transfer_allowances_update_correct</span></a> <span class="id" title="var">old_state</span> <span class="id" title="var">new_state</span> <span class="id" title="var">sender</span> <span class="id" title="var">from</span> <span class="id" title="var">amount</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">get_allowance</span> <span class="id" title="var">addr1</span> <span class="id" title="var">addr2</span> <span class="id" title="var">state</span> := <a class="idref" href="ConCert.Execution.Extras.html#with_default"><span class="id" title="definition">with_default</span></a> 0 (<a class="idref" href="ConCert.Execution.Containers.html#FMap.find"><span class="id" title="abbreviation">FMap.find</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#addr1"><span class="id" title="variable">addr1</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#addr2"><span class="id" title="variable">addr2</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#state"><span class="id" title="variable">state</span></a>.(<a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#allowances"><span class="id" title="projection">allowances</span></a>)) <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">allowance_before</span> := <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#get_allowance"><span class="id" title="variable">get_allowance</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#from"><span class="id" title="variable">from</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#sender"><span class="id" title="variable">sender</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#old_state"><span class="id" title="variable">old_state</span></a> <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">allowance_after</span> := <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#get_allowance"><span class="id" title="variable">get_allowance</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#from"><span class="id" title="variable">from</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#sender"><span class="id" title="variable">sender</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#new_state"><span class="id" title="variable">new_state</span></a> <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;If&nbsp;the&nbsp;from&nbsp;and&nbsp;sender&nbsp;is&nbsp;equal,&nbsp;allowances&nbsp;should&nbsp;remain&nbsp;unchained&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">if</span> <a class="idref" href="ConCert.Execution.Blockchain.html#address_eqb"><span class="id" title="method">address_eqb</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#sender"><span class="id" title="variable">sender</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#from"><span class="id" title="variable">from</span></a><br/>
&nbsp;&nbsp;<span class="id" title="keyword">then</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#allowance_before"><span class="id" title="variable">allowance_before</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.NArith.BinNat.html#59a5ff4a6cbb127625aba1a377a243d1"><span class="id" title="notation">=?</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#allowance_after"><span class="id" title="variable">allowance_after</span></a>)<br/>
&nbsp;&nbsp;<span class="id" title="keyword">else</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#allowance_before"><span class="id" title="variable">allowance_before</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.NArith.BinNat.html#59a5ff4a6cbb127625aba1a377a243d1"><span class="id" title="notation">=?</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#allowance_after"><span class="id" title="variable">allowance_after</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.NArith.BinNat.html#64708cc1fcff61c206ed571fe7828ea8"><span class="id" title="notation">+</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#amount"><span class="id" title="variable">amount</span></a>).<br/>

<br/>
</div>

<div class="doc">
<span class="inlinecode"><a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#Dexter2Lqt.try_transfer"><span class="id" title="definition">try_transfer</span></a></span> correctly subtracts <span class="inlinecode"><a class="idref" href="ConCert.Execution.Examples.FA2Interface.html#amount"><span class="id" title="projection">amount</span></a></span> from allowances if <span class="inlinecode"><a class="idref" href="ConCert.Embedding.Examples.crowdfunding.CrowdfundingData.html#sender"><span class="id" title="definition">sender</span></a></span> is not <span class="inlinecode"><a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#from"><span class="id" title="projection">from</span></a></span> 
</div>
<div class="code">
<span class="id" title="keyword">Lemma</span> <a name="try_transfer_allowance_correct"><span class="id" title="lemma">try_transfer_allowance_correct</span></a> : <span class="id" title="keyword">forall</span> <span class="id" title="var">prev_state</span> <span class="id" title="var">new_state</span> <span class="id" title="var">chain</span> <span class="id" title="var">ctx</span> <span class="id" title="var">new_acts</span> <span class="id" title="var">param</span>,<br/>
&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#receive"><span class="id" title="definition">receive</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#chain"><span class="id" title="variable">chain</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#ctx"><span class="id" title="variable">ctx</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#prev_state"><span class="id" title="variable">prev_state</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> (<a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#msg_transfer"><span class="id" title="constructor">msg_transfer</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#param"><span class="id" title="variable">param</span></a>)) <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#new_state"><span class="id" title="variable">new_state</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#new_acts"><span class="id" title="variable">new_acts</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#transfer_allowances_update_correct"><span class="id" title="definition">transfer_allowances_update_correct</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#prev_state"><span class="id" title="variable">prev_state</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#new_state"><span class="id" title="variable">new_state</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#ctx"><span class="id" title="variable">ctx</span></a>.(<a class="idref" href="ConCert.Execution.Blockchain.html#ctx_from"><span class="id" title="projection">ctx_from</span></a>) <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#param"><span class="id" title="variable">param</span></a>.(<a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#from"><span class="id" title="projection">from</span></a>) <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#param"><span class="id" title="variable">param</span></a>.(<a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#value"><span class="id" title="projection">value</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#true"><span class="id" title="constructor">true</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> * <span class="id" title="var">receive_some</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">contract_simpl</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#transfer_allowances_update_correct"><span class="id" title="definition">transfer_allowances_update_correct</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">destruct_match</span> <span class="id" title="var">eqn</span>:<span class="id" title="var">sender_from_eqb</span>.<br/>
&nbsp;&nbsp;- <span class="comment">(*&nbsp;sender&nbsp;=&nbsp;from&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="keyword">goal</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;[ <span class="id" title="var">H</span> : <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> (<a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#allowances"><span class="id" title="projection">allowances</span></a> <span class="id" title="var">_</span>) <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <span class="id" title="var">_</span> |- <span class="id" title="var">_</span> ] =&gt; <span class="id" title="tactic">rename</span> <span class="id" title="var">H</span> <span class="id" title="var">into</span> <span class="id" title="var">allowances_eq</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">inversion_clear</span> <span class="id" title="var">allowances_eq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.NArith.BinNat.html#N.eqb_refl"><span class="id" title="lemma">N.eqb_refl</span></a>.<br/>
&nbsp;&nbsp;- <span class="comment">(*&nbsp;sender&nbsp;&lt;&gt;&nbsp;from&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">contract_simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="keyword">goal</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;[ <span class="id" title="var">H</span> : <a class="idref" href="ConCert.Execution.Extras.html#with_default"><span class="id" title="definition">with_default</span></a> 0 (<a class="idref" href="ConCert.Execution.Containers.html#FMap.find"><span class="id" title="abbreviation">FMap.find</span></a> <span class="id" title="var">_</span> (<a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#allowances"><span class="id" title="projection">allowances</span></a> <span class="id" title="var">_</span>)) <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.NArith.BinNat.html#b39870dee55afcd85c6b795fb34de165"><span class="id" title="notation">&lt;?</span></a> <span class="id" title="var">_</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#false"><span class="id" title="constructor">false</span></a> |- <span class="id" title="var">_</span> ] =&gt; <span class="id" title="tactic">rename</span> <span class="id" title="var">H</span> <span class="id" title="var">into</span> <span class="id" title="var">enough_allowance</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.NArith.BinNat.html#N.ltb_ge"><span class="id" title="lemma">N.ltb_ge</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">enough_allowance</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="ConCert.Execution.Containers.html#FMap.find_update_eq"><span class="id" title="lemma">FMap.find_update_eq</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<a class="idref" href="ConCert.Execution.Containers.html#FMap.find"><span class="id" title="abbreviation">FMap.find</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#from"><span class="id" title="projection">from</span></a> <span class="id" title="var">param</span><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#ctx_from"><span class="id" title="projection">ctx_from</span></a> <span class="id" title="var">ctx</span><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> (<a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#allowances"><span class="id" title="projection">allowances</span></a> <span class="id" title="var">prev_state</span>)) <span class="id" title="var">eqn</span>:<span class="id" title="var">from_prev</span>; <span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">unfold</span> <a class="idref" href="ConCert.Execution.Examples.Common.html#maybe"><span class="id" title="definition">maybe</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<span class="id" title="var">n</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.NArith.BinNat.html#81673c7f7694c33c829aabf88ab05436"><span class="id" title="notation">-</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#value"><span class="id" title="projection">value</span></a> <span class="id" title="var">param</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.NArith.BinNat.html#59a5ff4a6cbb127625aba1a377a243d1"><span class="id" title="notation">=?</span></a> 0) <span class="id" title="var">eqn</span>:<span class="id" title="var">n_eq_value</span>; <span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.setoid_ring.InitialRing.html#Neqb_ok"><span class="id" title="lemma">Neqb_ok</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">n_eq_value</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.NArith.BinNat.html#N.sub_0_le"><span class="id" title="lemma">N.sub_0_le</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">n_eq_value</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">erewrite</span> (<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.NArith.BinNat.html#N.le_antisymm"><span class="id" title="lemma">N.le_antisymm</span></a> <span class="id" title="var">n</span> <span class="id" title="var">_</span>) <span class="id" title="tactic">by</span> <span class="id" title="var">eassumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> !<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.NArith.BinNat.html#N.eqb_refl"><span class="id" title="lemma">N.eqb_refl</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.NArith.BinNat.html#N.sub_add"><span class="id" title="lemma">N.sub_add</span></a>, <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.NArith.BinNat.html#N.eqb_refl"><span class="id" title="lemma">N.eqb_refl</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.NArith.BinNat.html#N.le_0_r"><span class="id" title="lemma">N.le_0_r</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">enough_allowance</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="var">enough_allowance</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
<span class="inlinecode"><a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#Dexter2Lqt.try_transfer"><span class="id" title="definition">try_transfer</span></a></span> does not produce any new actions 
</div>
<div class="code">
<span class="id" title="keyword">Lemma</span> <a name="try_transfer_new_acts_correct"><span class="id" title="lemma">try_transfer_new_acts_correct</span></a> : <span class="id" title="keyword">forall</span> <span class="id" title="var">prev_state</span> <span class="id" title="var">new_state</span> <span class="id" title="var">chain</span> <span class="id" title="var">ctx</span> <span class="id" title="var">new_acts</span> <span class="id" title="var">param</span>,<br/>
&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#receive"><span class="id" title="definition">receive</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#chain"><span class="id" title="variable">chain</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#ctx"><span class="id" title="variable">ctx</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#prev_state"><span class="id" title="variable">prev_state</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> (<a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#msg_transfer"><span class="id" title="constructor">msg_transfer</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#param"><span class="id" title="variable">param</span></a>)) <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#new_state"><span class="id" title="variable">new_state</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#new_acts"><span class="id" title="variable">new_acts</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#new_acts"><span class="id" title="variable">new_acts</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#ae9a5e1034e143b218b09d8e454472bd"><span class="id" title="notation">[]</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> * <span class="id" title="var">receive_some</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">contract_simpl</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
<span class="inlinecode"><a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#Dexter2Lqt.try_transfer"><span class="id" title="definition">try_transfer</span></a></span> does not change the total supply of tokens 
</div>
<div class="code">
<span class="id" title="keyword">Lemma</span> <a name="try_transfer_preserves_total_supply"><span class="id" title="lemma">try_transfer_preserves_total_supply</span></a> : <span class="id" title="keyword">forall</span> <span class="id" title="var">prev_state</span> <span class="id" title="var">new_state</span> <span class="id" title="var">chain</span> <span class="id" title="var">ctx</span> <span class="id" title="var">new_acts</span> <span class="id" title="var">param</span>,<br/>
&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#receive"><span class="id" title="definition">receive</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#chain"><span class="id" title="variable">chain</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#ctx"><span class="id" title="variable">ctx</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#prev_state"><span class="id" title="variable">prev_state</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> (<a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#msg_transfer"><span class="id" title="constructor">msg_transfer</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#param"><span class="id" title="variable">param</span></a>)) <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#new_state"><span class="id" title="variable">new_state</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#new_acts"><span class="id" title="variable">new_acts</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#total_supply"><span class="id" title="projection">total_supply</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#prev_state"><span class="id" title="variable">prev_state</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#total_supply"><span class="id" title="projection">total_supply</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#new_state"><span class="id" title="variable">new_state</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> * <span class="id" title="var">receive_some</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">contract_simpl</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
<span class="inlinecode"><a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#Dexter2Lqt.try_transfer"><span class="id" title="definition">try_transfer</span></a></span> only modifies the <span class="inlinecode"><a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#from"><span class="id" title="projection">from</span></a></span> and <span class="inlinecode"><a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#to"><span class="id" title="projection">to</span></a></span> balances 
</div>
<div class="code">
<span class="id" title="keyword">Lemma</span> <a name="try_transfer_preserves_other_balances"><span class="id" title="lemma">try_transfer_preserves_other_balances</span></a> : <span class="id" title="keyword">forall</span> <span class="id" title="var">prev_state</span> <span class="id" title="var">new_state</span> <span class="id" title="var">chain</span> <span class="id" title="var">ctx</span> <span class="id" title="var">new_acts</span> <span class="id" title="var">param</span>,<br/>
&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#receive"><span class="id" title="definition">receive</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#chain"><span class="id" title="variable">chain</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#ctx"><span class="id" title="variable">ctx</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#prev_state"><span class="id" title="variable">prev_state</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> (<a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#msg_transfer"><span class="id" title="constructor">msg_transfer</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#param"><span class="id" title="variable">param</span></a>)) <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#new_state"><span class="id" title="variable">new_state</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#new_acts"><span class="id" title="variable">new_acts</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">forall</span> <span class="id" title="var">account</span>, <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#account"><span class="id" title="variable">account</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#a0a5068f83a704fcfbda8cd473a6cfea"><span class="id" title="notation">&lt;&gt;</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#param"><span class="id" title="variable">param</span></a>.(<a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#from"><span class="id" title="projection">from</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#account"><span class="id" title="variable">account</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#a0a5068f83a704fcfbda8cd473a6cfea"><span class="id" title="notation">&lt;&gt;</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#param"><span class="id" title="variable">param</span></a>.(<a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#to"><span class="id" title="projection">to</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Containers.html#FMap.find"><span class="id" title="abbreviation">FMap.find</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#account"><span class="id" title="variable">account</span></a> (<a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#tokens"><span class="id" title="projection">tokens</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#prev_state"><span class="id" title="variable">prev_state</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="ConCert.Execution.Containers.html#FMap.find"><span class="id" title="abbreviation">FMap.find</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#account"><span class="id" title="variable">account</span></a> (<a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#tokens"><span class="id" title="projection">tokens</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#new_state"><span class="id" title="variable">new_state</span></a>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> * <span class="id" title="var">receive_some</span> <span class="id" title="var">account</span> <span class="id" title="var">account_not_from</span> <span class="id" title="var">account_not_to</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">contract_simpl</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> !<a class="idref" href="ConCert.Execution.Containers.html#FMap.find_update_ne"><span class="id" title="lemma">FMap.find_update_ne</span></a>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
<span class="inlinecode"><a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#Dexter2Lqt.try_transfer"><span class="id" title="definition">try_transfer</span></a></span> only modifies the <span class="inlinecode"><a class="idref" href="ConCert.Embedding.Examples.crowdfunding.CrowdfundingData.html#sender"><span class="id" title="definition">sender</span></a></span> and <span class="inlinecode"><a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#from"><span class="id" title="projection">from</span></a></span> allowances 
</div>
<div class="code">
<span class="id" title="keyword">Lemma</span> <a name="try_transfer_preserves_other_allowances"><span class="id" title="lemma">try_transfer_preserves_other_allowances</span></a> : <span class="id" title="keyword">forall</span> <span class="id" title="var">prev_state</span> <span class="id" title="var">new_state</span> <span class="id" title="var">chain</span> <span class="id" title="var">ctx</span> <span class="id" title="var">new_acts</span> <span class="id" title="var">param</span>,<br/>
&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#receive"><span class="id" title="definition">receive</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#chain"><span class="id" title="variable">chain</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#ctx"><span class="id" title="variable">ctx</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#prev_state"><span class="id" title="variable">prev_state</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> (<a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#msg_transfer"><span class="id" title="constructor">msg_transfer</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#param"><span class="id" title="variable">param</span></a>)) <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#new_state"><span class="id" title="variable">new_state</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#new_acts"><span class="id" title="variable">new_acts</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">forall</span> <span class="id" title="var">allowance_key</span>, <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#allowance_key"><span class="id" title="variable">allowance_key</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#a0a5068f83a704fcfbda8cd473a6cfea"><span class="id" title="notation">&lt;&gt;</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#param"><span class="id" title="variable">param</span></a>.(<a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#from"><span class="id" title="projection">from</span></a>)<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#ctx"><span class="id" title="variable">ctx</span></a>.(<a class="idref" href="ConCert.Execution.Blockchain.html#ctx_from"><span class="id" title="projection">ctx_from</span></a>)<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Containers.html#FMap.find"><span class="id" title="abbreviation">FMap.find</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#allowance_key"><span class="id" title="variable">allowance_key</span></a> (<a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#allowances"><span class="id" title="projection">allowances</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#prev_state"><span class="id" title="variable">prev_state</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="ConCert.Execution.Containers.html#FMap.find"><span class="id" title="abbreviation">FMap.find</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#allowance_key"><span class="id" title="variable">allowance_key</span></a> (<a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#allowances"><span class="id" title="projection">allowances</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#new_state"><span class="id" title="variable">new_state</span></a>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> * <span class="id" title="var">receive_some</span> <span class="id" title="var">account</span> <span class="id" title="var">allowance_key_ne</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">contract_simpl</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="keyword">goal</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;[ <span class="id" title="var">H</span> : <span class="id" title="var">_</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <span class="id" title="var">_</span> |- <span class="id" title="var">_</span> ] =&gt; <span class="id" title="tactic">rename</span> <span class="id" title="var">H</span> <span class="id" title="var">into</span> <span class="id" title="var">allowance_eq</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">destruct_address_eq</span>.<br/>
&nbsp;&nbsp;- <span class="comment">(*&nbsp;from&nbsp;=&nbsp;sender&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">inversion_clear</span> <span class="id" title="var">allowance_eq</span>.<br/>
&nbsp;&nbsp;- <span class="comment">(*&nbsp;from&nbsp;&lt;&gt;&nbsp;sender&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">destruct_match</span> <span class="id" title="tactic">in</span> <span class="id" title="var">allowance_eq</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">inversion_clear</span> <span class="id" title="var">allowance_eq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> !<a class="idref" href="ConCert.Execution.Containers.html#FMap.find_update_ne"><span class="id" title="lemma">FMap.find_update_ne</span></a>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
<span class="inlinecode"><a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#Dexter2Lqt.try_transfer"><span class="id" title="definition">try_transfer</span></a></span> removes empty entries from allowances map 
</div>
<div class="code">
<span class="id" title="keyword">Lemma</span> <a name="try_transfer_remove_empty_allowances"><span class="id" title="lemma">try_transfer_remove_empty_allowances</span></a> : <span class="id" title="keyword">forall</span> <span class="id" title="var">prev_state</span> <span class="id" title="var">new_state</span> <span class="id" title="var">chain</span> <span class="id" title="var">ctx</span> <span class="id" title="var">new_acts</span> <span class="id" title="var">param</span>,<br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">(</span></a><span class="id" title="keyword">forall</span> <span class="id" title="var">n</span>, <a class="idref" href="ConCert.Execution.Containers.html#FMap.find"><span class="id" title="abbreviation">FMap.find</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#param"><span class="id" title="variable">param</span></a>.(<a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#from"><span class="id" title="projection">from</span></a>)<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#ctx"><span class="id" title="variable">ctx</span></a>.(<a class="idref" href="ConCert.Execution.Blockchain.html#ctx_from"><span class="id" title="projection">ctx_from</span></a>)<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> (<a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#allowances"><span class="id" title="projection">allowances</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#prev_state"><span class="id" title="variable">prev_state</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#n"><span class="id" title="variable">n</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#n"><span class="id" title="variable">n</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.NArith.BinNat.html#80ddea6dd4c93c260d914ee417457028"><span class="id" title="notation">&gt;</span></a> 0<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#receive"><span class="id" title="definition">receive</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#chain"><span class="id" title="variable">chain</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#ctx"><span class="id" title="variable">ctx</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#prev_state"><span class="id" title="variable">prev_state</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> (<a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#msg_transfer"><span class="id" title="constructor">msg_transfer</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#param"><span class="id" title="variable">param</span></a>)) <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#new_state"><span class="id" title="variable">new_state</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#new_acts"><span class="id" title="variable">new_acts</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">forall</span> <span class="id" title="var">n</span>, <a class="idref" href="ConCert.Execution.Containers.html#FMap.find"><span class="id" title="abbreviation">FMap.find</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#param"><span class="id" title="variable">param</span></a>.(<a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#from"><span class="id" title="projection">from</span></a>)<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#ctx"><span class="id" title="variable">ctx</span></a>.(<a class="idref" href="ConCert.Execution.Blockchain.html#ctx_from"><span class="id" title="projection">ctx_from</span></a>)<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> (<a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#allowances"><span class="id" title="projection">allowances</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#new_state"><span class="id" title="variable">new_state</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#n"><span class="id" title="variable">n</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#n"><span class="id" title="variable">n</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.NArith.BinNat.html#80ddea6dd4c93c260d914ee417457028"><span class="id" title="notation">&gt;</span></a> 0.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> * <span class="id" title="var">IH</span> <span class="id" title="var">receive_some</span> *.<br/>
&nbsp;&nbsp;<span class="id" title="var">contract_simpl</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">destruct_match</span> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;- <span class="id" title="var">now</span> <span class="id" title="var">contract_simpl</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">contract_simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> !<a class="idref" href="ConCert.Execution.Containers.html#FMap.find_update_eq"><span class="id" title="lemma">FMap.find_update_eq</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">specialize</span> (<a class="idref" href="ConCert.Execution.Examples.Common.html#maybe_cases"><span class="id" title="lemma">maybe_cases</span></a> ) <span class="id" title="keyword">as</span> [[-&gt; ?<span class="id" title="var">H</span>] | [-&gt; ?<span class="id" title="var">H</span>]].<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
<span class="inlinecode"><a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#Dexter2Lqt.try_transfer"><span class="id" title="definition">try_transfer</span></a></span> removes empty entries from balance map 
</div>
<div class="code">
<span class="id" title="keyword">Lemma</span> <a name="try_transfer_remove_empty_balances"><span class="id" title="lemma">try_transfer_remove_empty_balances</span></a> : <span class="id" title="keyword">forall</span> <span class="id" title="var">prev_state</span> <span class="id" title="var">new_state</span> <span class="id" title="var">chain</span> <span class="id" title="var">ctx</span> <span class="id" title="var">new_acts</span> <span class="id" title="var">param</span>,<br/>
&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#receive"><span class="id" title="definition">receive</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#chain"><span class="id" title="variable">chain</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#ctx"><span class="id" title="variable">ctx</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#prev_state"><span class="id" title="variable">prev_state</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> (<a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#msg_transfer"><span class="id" title="constructor">msg_transfer</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#param"><span class="id" title="variable">param</span></a>)) <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#new_state"><span class="id" title="variable">new_state</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#new_acts"><span class="id" title="variable">new_acts</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">forall</span> <span class="id" title="var">n</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">(</span></a><a class="idref" href="ConCert.Execution.Containers.html#FMap.find"><span class="id" title="abbreviation">FMap.find</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#param"><span class="id" title="variable">param</span></a>.(<a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#from"><span class="id" title="projection">from</span></a>) (<a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#tokens"><span class="id" title="projection">tokens</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#new_state"><span class="id" title="variable">new_state</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#n"><span class="id" title="variable">n</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#n"><span class="id" title="variable">n</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.NArith.BinNat.html#80ddea6dd4c93c260d914ee417457028"><span class="id" title="notation">&gt;</span></a> 0<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">/\</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">(</span></a><a class="idref" href="ConCert.Execution.Containers.html#FMap.find"><span class="id" title="abbreviation">FMap.find</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#param"><span class="id" title="variable">param</span></a>.(<a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#to"><span class="id" title="projection">to</span></a>) (<a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#tokens"><span class="id" title="projection">tokens</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#new_state"><span class="id" title="variable">new_state</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#n"><span class="id" title="variable">n</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#n"><span class="id" title="variable">n</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.NArith.BinNat.html#80ddea6dd4c93c260d914ee417457028"><span class="id" title="notation">&gt;</span></a> 0<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">)</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> * <span class="id" title="var">receive_some</span> *.<br/>
&nbsp;&nbsp;<span class="id" title="var">contract_simpl</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.NArith.BinNat.html#N.ltb_ge"><span class="id" title="lemma">N.ltb_ge</span></a> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<a class="idref" href="ConCert.Execution.Blockchain.html#address_eqb_spec"><span class="id" title="method">address_eqb_spec</span></a> <span class="id" title="var">param</span>.(<a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#from"><span class="id" title="projection">from</span></a>) <span class="id" title="var">param</span>.(<a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#to"><span class="id" title="projection">to</span></a>)) <span class="id" title="keyword">as</span> [&lt;-|]; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">rewrite</span> !<a class="idref" href="ConCert.Execution.Containers.html#FMap.find_update_eq"><span class="id" title="lemma">FMap.find_update_eq</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">specialize</span> (<a class="idref" href="ConCert.Execution.Examples.Common.html#maybe_cases"><span class="id" title="lemma">maybe_cases</span></a> ) <span class="id" title="keyword">as</span> [[-&gt; ?<span class="id" title="var">H</span>] | [-&gt; ?<span class="id" title="var">H</span>]].<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">rewrite</span> !<a class="idref" href="ConCert.Execution.Containers.html#FMap.find_update_ne"><span class="id" title="lemma">FMap.find_update_ne</span></a> <span class="id" title="tactic">by</span> <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> !<a class="idref" href="ConCert.Execution.Containers.html#FMap.find_update_eq"><span class="id" title="lemma">FMap.find_update_eq</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> !<a class="idref" href="ConCert.Execution.Containers.html#FMap.find_update_ne"><span class="id" title="lemma">FMap.find_update_ne</span></a> <span class="id" title="keyword">with</span> (<span class="id" title="var">map</span> := <span class="id" title="var">prev_state</span>.(<a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#tokens"><span class="id" title="projection">tokens</span></a>)) <span class="id" title="tactic">by</span> <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">specialize</span> (<a class="idref" href="ConCert.Execution.Examples.Common.html#maybe_cases"><span class="id" title="lemma">maybe_cases</span></a> ) <span class="id" title="keyword">as</span> [[-&gt; ?<span class="id" title="var">H</span>] | [-&gt; ?<span class="id" title="var">H</span>]];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">specialize</span> (<a class="idref" href="ConCert.Execution.Examples.Common.html#maybe_cases"><span class="id" title="lemma">maybe_cases</span></a> ) <span class="id" title="keyword">as</span> [[-&gt; ?<span class="id" title="var">H</span>] | [-&gt; ?<span class="id" title="var">H</span>]].<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
If the requirements are met then then receive on transfer msg must succeed and
    if receive on transfer msg succeeds then requirements must hold 
</div>
<div class="code">
<span class="id" title="keyword">Lemma</span> <a name="try_transfer_is_some"><span class="id" title="lemma">try_transfer_is_some</span></a> : <span class="id" title="keyword">forall</span> <span class="id" title="var">state</span> <span class="id" title="var">chain</span> <span class="id" title="var">ctx</span> <span class="id" title="var">param</span>,<br/>
&nbsp;&nbsp;(<a class="idref" href="ConCert.Execution.Blockchain.html#ctx_amount"><span class="id" title="projection">ctx_amount</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#ctx"><span class="id" title="variable">ctx</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.ZArith.BinInt.html#306329b0eca7a2b86c198702f594ad8e"><span class="id" title="notation">&lt;=</span></a> 0)%<span class="id" title="var">Z</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">/\</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#param"><span class="id" title="variable">param</span></a>.(<a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#value"><span class="id" title="projection">value</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.NArith.BinNat.html#2ccca3280733654024e33c2005ae2530"><span class="id" title="notation">&lt;=</span></a> <a class="idref" href="ConCert.Execution.Extras.html#with_default"><span class="id" title="definition">with_default</span></a> 0 (<a class="idref" href="ConCert.Execution.Containers.html#FMap.find"><span class="id" title="abbreviation">FMap.find</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#param"><span class="id" title="variable">param</span></a>.(<a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#from"><span class="id" title="projection">from</span></a>) (<a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#tokens"><span class="id" title="projection">tokens</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#state"><span class="id" title="variable">state</span></a>)) <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">/\</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">(</span></a><a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#param"><span class="id" title="variable">param</span></a>.(<a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#from"><span class="id" title="projection">from</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#a0a5068f83a704fcfbda8cd473a6cfea"><span class="id" title="notation">&lt;&gt;</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#ctx"><span class="id" title="variable">ctx</span></a>.(<a class="idref" href="ConCert.Execution.Blockchain.html#ctx_from"><span class="id" title="projection">ctx_from</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#param"><span class="id" title="variable">param</span></a>.(<a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#value"><span class="id" title="projection">value</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.NArith.BinNat.html#2ccca3280733654024e33c2005ae2530"><span class="id" title="notation">&lt;=</span></a> <a class="idref" href="ConCert.Execution.Extras.html#with_default"><span class="id" title="definition">with_default</span></a> 0 (<a class="idref" href="ConCert.Execution.Containers.html#FMap.find"><span class="id" title="abbreviation">FMap.find</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#param"><span class="id" title="variable">param</span></a>.(<a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#from"><span class="id" title="projection">from</span></a>)<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#ctx"><span class="id" title="variable">ctx</span></a>.(<a class="idref" href="ConCert.Execution.Blockchain.html#ctx_from"><span class="id" title="projection">ctx_from</span></a>)<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> (<a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#allowances"><span class="id" title="projection">allowances</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#state"><span class="id" title="variable">state</span></a>))<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">)</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#4bfb4f2d0721ba668e3a802ab1b745a1"><span class="id" title="notation">&lt;-&gt;</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">exists</span></a> <span class="id" title="var">new_state</span> <span class="id" title="var">new_acts</span><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">,</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#receive"><span class="id" title="definition">receive</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#chain"><span class="id" title="variable">chain</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#ctx"><span class="id" title="variable">ctx</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#state"><span class="id" title="variable">state</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> (<a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#msg_transfer"><span class="id" title="constructor">msg_transfer</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#param"><span class="id" title="variable">param</span></a>)) <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#new_state"><span class="id" title="variable">new_state</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#new_acts"><span class="id" title="variable">new_acts</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">split</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">intros</span> (<span class="id" title="var">amount_zero</span> &amp; <span class="id" title="var">enough_balance</span> &amp; <span class="id" title="var">enough_allowance</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.ZArith.BinInt.html#Z.ltb_ge"><span class="id" title="lemma">Z.ltb_ge</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">amount_zero</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">amount_zero</span>;<span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">destruct_match</span> <span class="id" title="var">eqn</span>:<span class="id" title="var">allowances_eq</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">destruct_match</span> <span class="id" title="var">eqn</span>:<span class="id" title="var">sender_from_eqb</span> <span class="id" title="tactic">in</span> <span class="id" title="var">allowances_eq</span>; <span class="id" title="tactic">try</span> <span class="id" title="tactic">congruence</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">try</span> <span class="id" title="var">destruct_match</span> <span class="id" title="var">eqn</span>:<span class="id" title="var">enough_allowance_check</span> <span class="id" title="tactic">in</span> <span class="id" title="var">allowances_eq</span>; <span class="id" title="tactic">try</span> <span class="id" title="tactic">congruence</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">try</span> <span class="id" title="var">destruct_match</span> <span class="id" title="var">eqn</span>:<span class="id" title="var">new_balance</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">try</span> <span class="id" title="var">destruct_match</span> <span class="id" title="var">eqn</span>:<span class="id" title="var">enough_balance_check</span> <span class="id" title="tactic">in</span> <span class="id" title="var">new_balance</span>; <span class="id" title="tactic">try</span> <span class="id" title="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="comment">(*&nbsp;case&nbsp;no&nbsp;contradictions&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">inversion_clear</span> <span class="id" title="var">allowances_eq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">inversion_clear</span> <span class="id" title="var">new_balance</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="comment">(*&nbsp;enough&nbsp;balances&nbsp;contradiction&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">contract_simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.NArith.BinNat.html#N.ltb_lt"><span class="id" title="lemma">N.ltb_lt</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">enough_balance_check</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.NArith.BinNat.html#N.le_ngt"><span class="id" title="lemma">N.le_ngt</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">enough_balance</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="comment">(*&nbsp;case:&nbsp;no&nbsp;contradictions&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">inversion_clear</span> <span class="id" title="var">allowances_eq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">inversion_clear</span> <span class="id" title="var">new_balance</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="comment">(*&nbsp;enough&nbsp;balances&nbsp;contradiction&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">contract_simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.NArith.BinNat.html#N.ltb_lt"><span class="id" title="lemma">N.ltb_lt</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">enough_balance_check</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.NArith.BinNat.html#N.le_ngt"><span class="id" title="lemma">N.le_ngt</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">enough_balance</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="comment">(*&nbsp;enough&nbsp;allowance&nbsp;contradiction&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">contract_simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.NArith.BinNat.html#N.ltb_lt"><span class="id" title="lemma">N.ltb_lt</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">enough_allowance_check</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<a class="idref" href="ConCert.Execution.Blockchain.html#address_eqb_spec"><span class="id" title="method">address_eqb_spec</span></a> <span class="id" title="var">ctx</span>.(<a class="idref" href="ConCert.Execution.Blockchain.html#ctx_from"><span class="id" title="projection">ctx_from</span></a>) <span class="id" title="var">param</span>.(<a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#from"><span class="id" title="projection">from</span></a>)) <span class="id" title="keyword">as</span> [| <span class="id" title="var">sender_from_ne</span>]; <span class="id" title="tactic">try</span> <span class="id" title="tactic">discriminate</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#not_eq_sym"><span class="id" title="lemma">not_eq_sym</span></a>, <span class="id" title="var">enough_allowance</span>, <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.NArith.BinNat.html#N.le_ngt"><span class="id" title="lemma">N.le_ngt</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">sender_from_ne</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">intros</span> (<span class="id" title="var">new_state</span> &amp; <span class="id" title="var">new_acts</span> &amp; <span class="id" title="var">receive_some</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">contract_simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.ZArith.BinInt.html#Z.ltb_ge"><span class="id" title="lemma">Z.ltb_ge</span></a> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span>; <span class="id" title="tactic">try</span> <span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.NArith.BinNat.html#N.ltb_ge"><span class="id" title="lemma">N.ltb_ge</span></a> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">destruct_match</span> <span class="id" title="var">eqn</span>:<span class="id" title="var">sender_from_eqb</span> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<a class="idref" href="ConCert.Execution.Blockchain.html#address_eqb_spec"><span class="id" title="method">address_eqb_spec</span></a> <span class="id" title="var">ctx</span>.(<a class="idref" href="ConCert.Execution.Blockchain.html#ctx_from"><span class="id" title="projection">ctx_from</span></a>) <span class="id" title="var">param</span>.(<a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#from"><span class="id" title="projection">from</span></a>)) <span class="id" title="keyword">as</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[<span class="id" title="var">send_from_eq</span> | <span class="id" title="var">sender_from_ne</span>];<span class="id" title="var">contract_simpl</span>;<span class="id" title="tactic">try</span> <span class="id" title="tactic">discriminate</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+  <span class="comment">(*&nbsp;sender&nbsp;=&nbsp;from&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="comment">(*&nbsp;sender&nbsp;&lt;&gt;&nbsp;from&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">destruct_match</span> <span class="id" title="var">eqn</span>:<span class="id" title="var">enough_allowance</span> <span class="id" title="tactic">in</span> *; <span class="id" title="tactic">try</span> <span class="id" title="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">contract_simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.NArith.BinNat.html#N.ltb_ge"><span class="id" title="lemma">N.ltb_ge</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">enough_allowance</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
<a name="lab218"></a><h2 class="section">Approve correct</h2>
 <span class="inlinecode"><a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#Dexter2Lqt.try_approve"><span class="id" title="definition">try_approve</span></a></span> correctly sets allowance of <span class="inlinecode">(<a class="idref" href="ConCert.Embedding.Examples.crowdfunding.CrowdfundingData.html#sender"><span class="id" title="definition">sender</span></a>,</span> <span class="inlinecode"><a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#spender"><span class="id" title="projection">spender</span></a>)</span> to <span class="inlinecode"><a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#value_"><span class="id" title="projection">value_</span></a></span> 
</div>
<div class="code">
<span class="id" title="keyword">Lemma</span> <a name="try_approve_allowance_correct"><span class="id" title="lemma">try_approve_allowance_correct</span></a> : <span class="id" title="keyword">forall</span> <span class="id" title="var">prev_state</span> <span class="id" title="var">new_state</span> <span class="id" title="var">chain</span> <span class="id" title="var">ctx</span> <span class="id" title="var">new_acts</span> <span class="id" title="var">param</span>,<br/>
&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#receive"><span class="id" title="definition">receive</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#chain"><span class="id" title="variable">chain</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#ctx"><span class="id" title="variable">ctx</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#prev_state"><span class="id" title="variable">prev_state</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> (<a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#msg_approve"><span class="id" title="constructor">msg_approve</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#param"><span class="id" title="variable">param</span></a>)) <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#new_state"><span class="id" title="variable">new_state</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#new_acts"><span class="id" title="variable">new_acts</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Containers.html#FMap.find"><span class="id" title="abbreviation">FMap.find</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#ctx"><span class="id" title="variable">ctx</span></a>.(<a class="idref" href="ConCert.Execution.Blockchain.html#ctx_from"><span class="id" title="projection">ctx_from</span></a>)<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#param"><span class="id" title="variable">param</span></a>.(<a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#spender"><span class="id" title="projection">spender</span></a>)<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> (<a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#allowances"><span class="id" title="projection">allowances</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#new_state"><span class="id" title="variable">new_state</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="ConCert.Execution.Examples.Common.html#maybe"><span class="id" title="definition">maybe</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#param"><span class="id" title="variable">param</span></a>.(<a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#value_"><span class="id" title="projection">value_</span></a>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> * <span class="id" title="var">receive_some</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">contract_simpl</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> !<a class="idref" href="ConCert.Execution.Containers.html#FMap.find_update_eq"><span class="id" title="lemma">FMap.find_update_eq</span></a>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
<span class="inlinecode"><a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#Dexter2Lqt.try_approve"><span class="id" title="definition">try_approve</span></a></span> does not produce any new actions 
</div>
<div class="code">
<span class="id" title="keyword">Lemma</span> <a name="try_approve_new_acts_correct"><span class="id" title="lemma">try_approve_new_acts_correct</span></a> : <span class="id" title="keyword">forall</span> <span class="id" title="var">prev_state</span> <span class="id" title="var">new_state</span> <span class="id" title="var">chain</span> <span class="id" title="var">ctx</span> <span class="id" title="var">new_acts</span> <span class="id" title="var">param</span>,<br/>
&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#receive"><span class="id" title="definition">receive</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#chain"><span class="id" title="variable">chain</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#ctx"><span class="id" title="variable">ctx</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#prev_state"><span class="id" title="variable">prev_state</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> (<a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#msg_approve"><span class="id" title="constructor">msg_approve</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#param"><span class="id" title="variable">param</span></a>)) <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#new_state"><span class="id" title="variable">new_state</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#new_acts"><span class="id" title="variable">new_acts</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#new_acts"><span class="id" title="variable">new_acts</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#ae9a5e1034e143b218b09d8e454472bd"><span class="id" title="notation">[]</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> * <span class="id" title="var">receive_some</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">contract_simpl</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
<span class="inlinecode"><a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#Dexter2Lqt.try_approve"><span class="id" title="definition">try_approve</span></a></span> does not change allowances map of other addresses 
</div>
<div class="code">
<span class="id" title="keyword">Lemma</span> <a name="try_approve_preserves_other_allowances"><span class="id" title="lemma">try_approve_preserves_other_allowances</span></a> : <span class="id" title="keyword">forall</span> <span class="id" title="var">prev_state</span> <span class="id" title="var">new_state</span> <span class="id" title="var">chain</span> <span class="id" title="var">ctx</span> <span class="id" title="var">new_acts</span> <span class="id" title="var">param</span>,<br/>
&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#receive"><span class="id" title="definition">receive</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#chain"><span class="id" title="variable">chain</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#ctx"><span class="id" title="variable">ctx</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#prev_state"><span class="id" title="variable">prev_state</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> (<a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#msg_approve"><span class="id" title="constructor">msg_approve</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#param"><span class="id" title="variable">param</span></a>)) <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#new_state"><span class="id" title="variable">new_state</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#new_acts"><span class="id" title="variable">new_acts</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">forall</span> <span class="id" title="var">allowance_key</span>, <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#allowance_key"><span class="id" title="variable">allowance_key</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#a0a5068f83a704fcfbda8cd473a6cfea"><span class="id" title="notation">&lt;&gt;</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#ctx"><span class="id" title="variable">ctx</span></a>.(<a class="idref" href="ConCert.Execution.Blockchain.html#ctx_from"><span class="id" title="projection">ctx_from</span></a>)<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#param"><span class="id" title="variable">param</span></a>.(<a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#spender"><span class="id" title="projection">spender</span></a>)<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Containers.html#FMap.find"><span class="id" title="abbreviation">FMap.find</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#allowance_key"><span class="id" title="variable">allowance_key</span></a> (<a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#allowances"><span class="id" title="projection">allowances</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#prev_state"><span class="id" title="variable">prev_state</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="ConCert.Execution.Containers.html#FMap.find"><span class="id" title="abbreviation">FMap.find</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#allowance_key"><span class="id" title="variable">allowance_key</span></a> (<a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#allowances"><span class="id" title="projection">allowances</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#new_state"><span class="id" title="variable">new_state</span></a>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> * <span class="id" title="var">receive_some</span> <span class="id" title="var">allowance_key</span> <span class="id" title="var">allowance_key_ne</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">contract_simpl</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <a class="idref" href="ConCert.Execution.Containers.html#FMap.find_update_ne"><span class="id" title="lemma">FMap.find_update_ne</span></a>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
<span class="inlinecode"><a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#Dexter2Lqt.try_approve"><span class="id" title="definition">try_approve</span></a></span> does not change total supply of tokens 
</div>
<div class="code">
<span class="id" title="keyword">Lemma</span> <a name="try_approve_preserves_total_supply"><span class="id" title="lemma">try_approve_preserves_total_supply</span></a> : <span class="id" title="keyword">forall</span> <span class="id" title="var">prev_state</span> <span class="id" title="var">new_state</span> <span class="id" title="var">chain</span> <span class="id" title="var">ctx</span> <span class="id" title="var">new_acts</span> <span class="id" title="var">param</span>,<br/>
&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#receive"><span class="id" title="definition">receive</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#chain"><span class="id" title="variable">chain</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#ctx"><span class="id" title="variable">ctx</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#prev_state"><span class="id" title="variable">prev_state</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> (<a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#msg_approve"><span class="id" title="constructor">msg_approve</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#param"><span class="id" title="variable">param</span></a>)) <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#new_state"><span class="id" title="variable">new_state</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#new_acts"><span class="id" title="variable">new_acts</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#total_supply"><span class="id" title="projection">total_supply</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#prev_state"><span class="id" title="variable">prev_state</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#total_supply"><span class="id" title="projection">total_supply</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#new_state"><span class="id" title="variable">new_state</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> * <span class="id" title="var">receive_some</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="var">contract_simpl</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
<span class="inlinecode"><a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#Dexter2Lqt.try_approve"><span class="id" title="definition">try_approve</span></a></span> does not change balances 
</div>
<div class="code">
<span class="id" title="keyword">Lemma</span> <a name="try_approve_preserves_balances"><span class="id" title="lemma">try_approve_preserves_balances</span></a> : <span class="id" title="keyword">forall</span> <span class="id" title="var">prev_state</span> <span class="id" title="var">new_state</span> <span class="id" title="var">chain</span> <span class="id" title="var">ctx</span> <span class="id" title="var">new_acts</span> <span class="id" title="var">param</span>,<br/>
&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#receive"><span class="id" title="definition">receive</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#chain"><span class="id" title="variable">chain</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#ctx"><span class="id" title="variable">ctx</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#prev_state"><span class="id" title="variable">prev_state</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> (<a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#msg_approve"><span class="id" title="constructor">msg_approve</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#param"><span class="id" title="variable">param</span></a>)) <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#new_state"><span class="id" title="variable">new_state</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#new_acts"><span class="id" title="variable">new_acts</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#tokens"><span class="id" title="projection">tokens</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#prev_state"><span class="id" title="variable">prev_state</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#tokens"><span class="id" title="projection">tokens</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#new_state"><span class="id" title="variable">new_state</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> * <span class="id" title="var">receive_some</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="var">contract_simpl</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
<span class="inlinecode"><a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#Dexter2Lqt.try_approve"><span class="id" title="definition">try_approve</span></a></span> removes empty entries from allowances map 
</div>
<div class="code">
<span class="id" title="keyword">Lemma</span> <a name="try_approve_remove_empty_allowances"><span class="id" title="lemma">try_approve_remove_empty_allowances</span></a> : <span class="id" title="keyword">forall</span> <span class="id" title="var">prev_state</span> <span class="id" title="var">new_state</span> <span class="id" title="var">chain</span> <span class="id" title="var">ctx</span> <span class="id" title="var">new_acts</span> <span class="id" title="var">param</span>,<br/>
&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#receive"><span class="id" title="definition">receive</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#chain"><span class="id" title="variable">chain</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#ctx"><span class="id" title="variable">ctx</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#prev_state"><span class="id" title="variable">prev_state</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> (<a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#msg_approve"><span class="id" title="constructor">msg_approve</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#param"><span class="id" title="variable">param</span></a>)) <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#new_state"><span class="id" title="variable">new_state</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#new_acts"><span class="id" title="variable">new_acts</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">forall</span> <span class="id" title="var">n</span>, <a class="idref" href="ConCert.Execution.Containers.html#FMap.find"><span class="id" title="abbreviation">FMap.find</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#ctx"><span class="id" title="variable">ctx</span></a>.(<a class="idref" href="ConCert.Execution.Blockchain.html#ctx_from"><span class="id" title="projection">ctx_from</span></a>)<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#param"><span class="id" title="variable">param</span></a>.(<a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#spender"><span class="id" title="projection">spender</span></a>)<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> (<a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#allowances"><span class="id" title="projection">allowances</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#new_state"><span class="id" title="variable">new_state</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#n"><span class="id" title="variable">n</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#n"><span class="id" title="variable">n</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.NArith.BinNat.html#80ddea6dd4c93c260d914ee417457028"><span class="id" title="notation">&gt;</span></a> 0.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> * <span class="id" title="var">IH</span> <span class="id" title="var">receive_some</span> *.<br/>
&nbsp;&nbsp;<span class="id" title="var">contract_simpl</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="ConCert.Execution.Containers.html#FMap.find_update_eq"><span class="id" title="lemma">FMap.find_update_eq</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">specialize</span> (<a class="idref" href="ConCert.Execution.Examples.Common.html#maybe_cases"><span class="id" title="lemma">maybe_cases</span></a> ) <span class="id" title="keyword">as</span> [[-&gt; ?<span class="id" title="var">H</span>] | [-&gt; ?<span class="id" title="var">H</span>]].<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
If the requirements are met then then receive on approve msg must succeed and
    if receive on approve msg succeeds then requirements must hold 
</div>
<div class="code">
<span class="id" title="keyword">Lemma</span> <a name="try_approve_is_some"><span class="id" title="lemma">try_approve_is_some</span></a> : <span class="id" title="keyword">forall</span> <span class="id" title="var">state</span> <span class="id" title="var">chain</span> <span class="id" title="var">ctx</span> <span class="id" title="var">param</span>,<br/>
&nbsp;&nbsp;(<a class="idref" href="ConCert.Execution.Blockchain.html#ctx_amount"><span class="id" title="projection">ctx_amount</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#ctx"><span class="id" title="variable">ctx</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.ZArith.BinInt.html#306329b0eca7a2b86c198702f594ad8e"><span class="id" title="notation">&lt;=</span></a> 0)%<span class="id" title="var">Z</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">/\</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">(</span></a><a class="idref" href="ConCert.Execution.Extras.html#with_default"><span class="id" title="definition">with_default</span></a> 0 (<a class="idref" href="ConCert.Execution.Containers.html#FMap.find"><span class="id" title="abbreviation">FMap.find</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#ctx"><span class="id" title="variable">ctx</span></a>.(<a class="idref" href="ConCert.Execution.Blockchain.html#ctx_from"><span class="id" title="projection">ctx_from</span></a>)<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#param"><span class="id" title="variable">param</span></a>.(<a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#spender"><span class="id" title="projection">spender</span></a>)<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> (<a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#allowances"><span class="id" title="projection">allowances</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#state"><span class="id" title="variable">state</span></a>)) <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> 0 <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#f031fe1957c4a4a8e217aa46af2b4e25"><span class="id" title="notation">\/</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#param"><span class="id" title="variable">param</span></a>.(<a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#value_"><span class="id" title="projection">value_</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> 0<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">)</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#4bfb4f2d0721ba668e3a802ab1b745a1"><span class="id" title="notation">&lt;-&gt;</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">exists</span></a> <span class="id" title="var">new_state</span> <span class="id" title="var">new_acts</span><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">,</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#receive"><span class="id" title="definition">receive</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#chain"><span class="id" title="variable">chain</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#ctx"><span class="id" title="variable">ctx</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#state"><span class="id" title="variable">state</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> (<a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#msg_approve"><span class="id" title="constructor">msg_approve</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#param"><span class="id" title="variable">param</span></a>)) <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#new_state"><span class="id" title="variable">new_state</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#new_acts"><span class="id" title="variable">new_acts</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">split</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">destruct_hyps</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">contract_simpl</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">autorewrite</span> <span class="id" title="keyword">with</span> <span class="id" title="var">BoolElim</span> <span class="id" title="tactic">in</span> *.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
<a name="lab219"></a><h2 class="section">Mint or burn correct</h2>
 <span class="inlinecode"><a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#Dexter2Lqt.try_mint_or_burn"><span class="id" title="definition">try_mint_or_burn</span></a></span> correctly mints/burns <span class="inlinecode"><a class="idref" href="ConCert.Execution.Examples.FA2Interface.html#amount"><span class="id" title="projection">amount</span></a></span> from/to <span class="inlinecode"><a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#target"><span class="id" title="projection">target</span></a></span> 
</div>
<div class="code">
<span class="id" title="keyword">Lemma</span> <a name="try_mint_or_burn_balance_correct"><span class="id" title="lemma">try_mint_or_burn_balance_correct</span></a> : <span class="id" title="keyword">forall</span> <span class="id" title="var">prev_state</span> <span class="id" title="var">new_state</span> <span class="id" title="var">chain</span> <span class="id" title="var">ctx</span> <span class="id" title="var">new_acts</span> <span class="id" title="var">param</span>,<br/>
&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#receive"><span class="id" title="definition">receive</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#chain"><span class="id" title="variable">chain</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#ctx"><span class="id" title="variable">ctx</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#prev_state"><span class="id" title="variable">prev_state</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> (<a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#msg_mint_or_burn"><span class="id" title="constructor">msg_mint_or_burn</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#param"><span class="id" title="variable">param</span></a>)) <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#new_state"><span class="id" title="variable">new_state</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#new_acts"><span class="id" title="variable">new_acts</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.ZArith.BinInt.html#Z.of_N"><span class="id" title="definition">Z.of_N</span></a> (<a class="idref" href="ConCert.Execution.Extras.html#with_default"><span class="id" title="definition">with_default</span></a> 0%<span class="id" title="var">N</span> (<a class="idref" href="ConCert.Execution.Containers.html#FMap.find"><span class="id" title="abbreviation">FMap.find</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#param"><span class="id" title="variable">param</span></a>.(<a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#target"><span class="id" title="projection">target</span></a>) (<a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#tokens"><span class="id" title="projection">tokens</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#prev_state"><span class="id" title="variable">prev_state</span></a>))) <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.ZArith.BinInt.html#46584eddd5fdb16176a10a2843177d3a"><span class="id" title="notation">+</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#param"><span class="id" title="variable">param</span></a>.(<a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#quantity"><span class="id" title="projection">quantity</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.ZArith.BinInt.html#Z.of_N"><span class="id" title="definition">Z.of_N</span></a> (<a class="idref" href="ConCert.Execution.Extras.html#with_default"><span class="id" title="definition">with_default</span></a> 0%<span class="id" title="var">N</span> (<a class="idref" href="ConCert.Execution.Containers.html#FMap.find"><span class="id" title="abbreviation">FMap.find</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#param"><span class="id" title="variable">param</span></a>.(<a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#target"><span class="id" title="projection">target</span></a>) (<a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#tokens"><span class="id" title="projection">tokens</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#new_state"><span class="id" title="variable">new_state</span></a>))))%<span class="id" title="var">Z</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> * <span class="id" title="var">receive_some</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">contract_simpl</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.ZArith.BinInt.html#Z.ltb_ge"><span class="id" title="lemma">Z.ltb_ge</span></a> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;<span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="ConCert.Execution.Containers.html#FMap.find_update_eq"><span class="id" title="lemma">FMap.find_update_eq</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="ConCert.Execution.Examples.Common.html#maybe"><span class="id" title="definition">maybe</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="definition">FMap.find</span> <span class="id" title="tactic">in</span> *. <span class="comment">(*&nbsp;NOTE:&nbsp;after&nbsp;using&nbsp;AddressMap,&nbsp;unification&nbsp;fails&nbsp;sometime,&nbsp;unless&nbsp;we&nbsp;unfold&nbsp;<span class="inlinecode"><span class="id" title="var">FMap.find</span></span>&nbsp;and&nbsp;other&nbsp;definitions.&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.ZArith.BinInt.html#Z.to_N"><span class="id" title="definition">Z.to_N</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.ZArith.BinInt.html#Z.of_N"><span class="id" title="definition">Z.of_N</span></a> (<a class="idref" href="ConCert.Execution.Extras.html#with_default"><span class="id" title="definition">with_default</span></a> 0 <span class="id" title="var">_</span>) <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.ZArith.BinInt.html#46584eddd5fdb16176a10a2843177d3a"><span class="id" title="notation">+</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#quantity"><span class="id" title="projection">quantity</span></a> <span class="id" title="var">param</span>) <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.NArith.BinNat.html#59a5ff4a6cbb127625aba1a377a243d1"><span class="id" title="notation">=?</span></a> 0) <span class="id" title="var">eqn</span>:<span class="id" title="var">eq_zero</span>; <span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.setoid_ring.InitialRing.html#Neqb_ok"><span class="id" title="lemma">Neqb_ok</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">eq_zero</span>. <span class="id" title="tactic">unfold</span> <span class="id" title="definition">FMap.find</span> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">lia</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">rewrite</span> &lt;- <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.ZArith.Znat.html#Z2N.id"><span class="id" title="lemma">Z2N.id</span></a> <span class="id" title="tactic">by</span> <span class="id" title="var">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">lia</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
<span class="inlinecode"><a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#Dexter2Lqt.try_mint_or_burn"><span class="id" title="definition">try_mint_or_burn</span></a></span> correctly updates <span class="inlinecode"><a class="idref" href="ConCert.Execution.Examples.FA2Interface.html#total_supply"><span class="id" title="projection">total_supply</span></a></span> 
</div>
<div class="code">
<span class="id" title="keyword">Lemma</span> <a name="try_mint_or_burn_total_supply_correct"><span class="id" title="lemma">try_mint_or_burn_total_supply_correct</span></a> : <span class="id" title="keyword">forall</span> <span class="id" title="var">prev_state</span> <span class="id" title="var">new_state</span> <span class="id" title="var">chain</span> <span class="id" title="var">ctx</span> <span class="id" title="var">new_acts</span> <span class="id" title="var">param</span>,<br/>
&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Extras.html#with_default"><span class="id" title="definition">with_default</span></a> 0 (<a class="idref" href="ConCert.Execution.Containers.html#FMap.find"><span class="id" title="abbreviation">FMap.find</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#param"><span class="id" title="variable">param</span></a>.(<a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#target"><span class="id" title="projection">target</span></a>) (<a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#tokens"><span class="id" title="projection">tokens</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#prev_state"><span class="id" title="variable">prev_state</span></a>)) <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.NArith.BinNat.html#2ccca3280733654024e33c2005ae2530"><span class="id" title="notation">&lt;=</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#total_supply"><span class="id" title="projection">total_supply</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#prev_state"><span class="id" title="variable">prev_state</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#receive"><span class="id" title="definition">receive</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#chain"><span class="id" title="variable">chain</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#ctx"><span class="id" title="variable">ctx</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#prev_state"><span class="id" title="variable">prev_state</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> (<a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#msg_mint_or_burn"><span class="id" title="constructor">msg_mint_or_burn</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#param"><span class="id" title="variable">param</span></a>)) <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#new_state"><span class="id" title="variable">new_state</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#new_acts"><span class="id" title="variable">new_acts</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.ZArith.BinInt.html#Z.of_N"><span class="id" title="definition">Z.of_N</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#prev_state"><span class="id" title="variable">prev_state</span></a>.(<a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#total_supply"><span class="id" title="projection">total_supply</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.ZArith.BinInt.html#46584eddd5fdb16176a10a2843177d3a"><span class="id" title="notation">+</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#param"><span class="id" title="variable">param</span></a>.(<a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#quantity"><span class="id" title="projection">quantity</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.ZArith.BinInt.html#Z.of_N"><span class="id" title="definition">Z.of_N</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#new_state"><span class="id" title="variable">new_state</span></a>.(<a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#total_supply"><span class="id" title="projection">total_supply</span></a>))%<span class="id" title="var">Z</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> * <span class="id" title="var">balance_le_total_supply</span> <span class="id" title="var">receive_some</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">contract_simpl</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.ZArith.BinInt.html#Z.ltb_ge"><span class="id" title="lemma">Z.ltb_ge</span></a> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;<span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.ZArith.Znat.html#N2Z.inj_abs_N"><span class="id" title="lemma">N2Z.inj_abs_N</span></a>, <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.ZArith.BinInt.html#Z.abs_eq"><span class="id" title="lemma">Z.abs_eq</span></a>;<span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="definition">FMap.find</span> <span class="id" title="tactic">in</span> *;<span class="id" title="var">lia</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
<span class="inlinecode"><a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#Dexter2Lqt.try_mint_or_burn"><span class="id" title="definition">try_mint_or_burn</span></a></span> produces no new actions 
</div>
<div class="code">
<span class="id" title="keyword">Lemma</span> <a name="try_mint_or_burn_new_acts_correct"><span class="id" title="lemma">try_mint_or_burn_new_acts_correct</span></a> : <span class="id" title="keyword">forall</span> <span class="id" title="var">prev_state</span> <span class="id" title="var">new_state</span> <span class="id" title="var">chain</span> <span class="id" title="var">ctx</span> <span class="id" title="var">new_acts</span> <span class="id" title="var">param</span>,<br/>
&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#receive"><span class="id" title="definition">receive</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#chain"><span class="id" title="variable">chain</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#ctx"><span class="id" title="variable">ctx</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#prev_state"><span class="id" title="variable">prev_state</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> (<a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#msg_mint_or_burn"><span class="id" title="constructor">msg_mint_or_burn</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#param"><span class="id" title="variable">param</span></a>)) <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#new_state"><span class="id" title="variable">new_state</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#new_acts"><span class="id" title="variable">new_acts</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#new_acts"><span class="id" title="variable">new_acts</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#ae9a5e1034e143b218b09d8e454472bd"><span class="id" title="notation">[]</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">contract_simpl</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
<span class="inlinecode"><a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#Dexter2Lqt.try_mint_or_burn"><span class="id" title="definition">try_mint_or_burn</span></a></span> only modifies the <span class="inlinecode"><a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#target"><span class="id" title="projection">target</span></a></span> balance 
</div>
<div class="code">
<span class="id" title="keyword">Lemma</span> <a name="try_mint_or_burn_preserves_other_balances"><span class="id" title="lemma">try_mint_or_burn_preserves_other_balances</span></a> : <span class="id" title="keyword">forall</span> <span class="id" title="var">prev_state</span> <span class="id" title="var">new_state</span> <span class="id" title="var">chain</span> <span class="id" title="var">ctx</span> <span class="id" title="var">new_acts</span> <span class="id" title="var">param</span>,<br/>
&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#receive"><span class="id" title="definition">receive</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#chain"><span class="id" title="variable">chain</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#ctx"><span class="id" title="variable">ctx</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#prev_state"><span class="id" title="variable">prev_state</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> (<a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#msg_mint_or_burn"><span class="id" title="constructor">msg_mint_or_burn</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#param"><span class="id" title="variable">param</span></a>)) <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#new_state"><span class="id" title="variable">new_state</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#new_acts"><span class="id" title="variable">new_acts</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">forall</span> <span class="id" title="var">account</span>, <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#account"><span class="id" title="variable">account</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#a0a5068f83a704fcfbda8cd473a6cfea"><span class="id" title="notation">&lt;&gt;</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#param"><span class="id" title="variable">param</span></a>.(<a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#target"><span class="id" title="projection">target</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Containers.html#FMap.find"><span class="id" title="abbreviation">FMap.find</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#account"><span class="id" title="variable">account</span></a> (<a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#tokens"><span class="id" title="projection">tokens</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#prev_state"><span class="id" title="variable">prev_state</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="ConCert.Execution.Containers.html#FMap.find"><span class="id" title="abbreviation">FMap.find</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#account"><span class="id" title="variable">account</span></a> (<a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#tokens"><span class="id" title="projection">tokens</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#new_state"><span class="id" title="variable">new_state</span></a>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> * <span class="id" title="var">receive_some</span> <span class="id" title="var">account</span> <span class="id" title="var">account_not_target</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">contract_simpl</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <a class="idref" href="ConCert.Execution.Containers.html#FMap.find_update_ne"><span class="id" title="lemma">FMap.find_update_ne</span></a>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
<span class="inlinecode"><a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#Dexter2Lqt.try_mint_or_burn"><span class="id" title="definition">try_mint_or_burn</span></a></span> does not change allowances 
</div>
<div class="code">
<span class="id" title="keyword">Lemma</span> <a name="try_mint_or_burn_preserves_allowances"><span class="id" title="lemma">try_mint_or_burn_preserves_allowances</span></a> : <span class="id" title="keyword">forall</span> <span class="id" title="var">prev_state</span> <span class="id" title="var">new_state</span> <span class="id" title="var">chain</span> <span class="id" title="var">ctx</span> <span class="id" title="var">new_acts</span> <span class="id" title="var">param</span>,<br/>
&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#receive"><span class="id" title="definition">receive</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#chain"><span class="id" title="variable">chain</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#ctx"><span class="id" title="variable">ctx</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#prev_state"><span class="id" title="variable">prev_state</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> (<a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#msg_mint_or_burn"><span class="id" title="constructor">msg_mint_or_burn</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#param"><span class="id" title="variable">param</span></a>)) <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#new_state"><span class="id" title="variable">new_state</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#new_acts"><span class="id" title="variable">new_acts</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#allowances"><span class="id" title="projection">allowances</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#prev_state"><span class="id" title="variable">prev_state</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#allowances"><span class="id" title="projection">allowances</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#new_state"><span class="id" title="variable">new_state</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> * <span class="id" title="var">receive_some</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="var">contract_simpl</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
<span class="inlinecode"><a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#Dexter2Lqt.try_mint_or_burn"><span class="id" title="definition">try_mint_or_burn</span></a></span> removes empty entries from balance map 
</div>
<div class="code">
<span class="id" title="keyword">Lemma</span> <a name="try_mint_or_burn_remove_empty_balances"><span class="id" title="lemma">try_mint_or_burn_remove_empty_balances</span></a> : <span class="id" title="keyword">forall</span> <span class="id" title="var">prev_state</span> <span class="id" title="var">new_state</span> <span class="id" title="var">chain</span> <span class="id" title="var">ctx</span> <span class="id" title="var">new_acts</span> <span class="id" title="var">param</span>,<br/>
&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#receive"><span class="id" title="definition">receive</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#chain"><span class="id" title="variable">chain</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#ctx"><span class="id" title="variable">ctx</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#prev_state"><span class="id" title="variable">prev_state</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> (<a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#msg_mint_or_burn"><span class="id" title="constructor">msg_mint_or_burn</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#param"><span class="id" title="variable">param</span></a>)) <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#new_state"><span class="id" title="variable">new_state</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#new_acts"><span class="id" title="variable">new_acts</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">forall</span> <span class="id" title="var">n</span>, <a class="idref" href="ConCert.Execution.Containers.html#FMap.find"><span class="id" title="abbreviation">FMap.find</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#param"><span class="id" title="variable">param</span></a>.(<a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#target"><span class="id" title="projection">target</span></a>) (<a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#tokens"><span class="id" title="projection">tokens</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#new_state"><span class="id" title="variable">new_state</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#n"><span class="id" title="variable">n</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#n"><span class="id" title="variable">n</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.NArith.BinNat.html#80ddea6dd4c93c260d914ee417457028"><span class="id" title="notation">&gt;</span></a> 0.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> * <span class="id" title="var">receive_some</span> *.<br/>
&nbsp;&nbsp;<span class="id" title="var">contract_simpl</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.ZArith.BinInt.html#Z.ltb_ge"><span class="id" title="lemma">Z.ltb_ge</span></a> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;<span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="ConCert.Execution.Containers.html#FMap.find_update_eq"><span class="id" title="lemma">FMap.find_update_eq</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">specialize</span> (<a class="idref" href="ConCert.Execution.Examples.Common.html#maybe_cases"><span class="id" title="lemma">maybe_cases</span></a> ) <span class="id" title="keyword">as</span> [[-&gt; ?<span class="id" title="var">H</span>] | [-&gt; ?<span class="id" title="var">H</span>]].<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
If the requirements are met then then receive on mint_or_burn msg must succeed and
    if receive on mint_or_burn msg succeeds then requirements must hold 
</div>
<div class="code">
<span class="id" title="keyword">Lemma</span> <a name="try_mint_or_burn_is_some"><span class="id" title="lemma">try_mint_or_burn_is_some</span></a> : <span class="id" title="keyword">forall</span> <span class="id" title="var">state</span> <span class="id" title="var">chain</span> <span class="id" title="var">ctx</span> <span class="id" title="var">param</span>,<br/>
&nbsp;&nbsp;(<a class="idref" href="ConCert.Execution.Blockchain.html#ctx_amount"><span class="id" title="projection">ctx_amount</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#ctx"><span class="id" title="variable">ctx</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.ZArith.BinInt.html#306329b0eca7a2b86c198702f594ad8e"><span class="id" title="notation">&lt;=</span></a> 0)%<span class="id" title="var">Z</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">/\</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#ctx"><span class="id" title="variable">ctx</span></a>.(<a class="idref" href="ConCert.Execution.Blockchain.html#ctx_from"><span class="id" title="projection">ctx_from</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#state"><span class="id" title="variable">state</span></a>.(<a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#admin"><span class="id" title="projection">admin</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">/\</span></a><br/>
&nbsp;&nbsp;(0 <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.ZArith.BinInt.html#306329b0eca7a2b86c198702f594ad8e"><span class="id" title="notation">&lt;=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.ZArith.BinInt.html#Z.of_N"><span class="id" title="definition">Z.of_N</span></a> (<a class="idref" href="ConCert.Execution.Extras.html#with_default"><span class="id" title="definition">with_default</span></a> 0%<span class="id" title="var">N</span> (<a class="idref" href="ConCert.Execution.Containers.html#FMap.find"><span class="id" title="abbreviation">FMap.find</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#param"><span class="id" title="variable">param</span></a>.(<a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#target"><span class="id" title="projection">target</span></a>) (<a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#tokens"><span class="id" title="projection">tokens</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#state"><span class="id" title="variable">state</span></a>))) <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.ZArith.BinInt.html#46584eddd5fdb16176a10a2843177d3a"><span class="id" title="notation">+</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#param"><span class="id" title="variable">param</span></a>.(<a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#quantity"><span class="id" title="projection">quantity</span></a>))%<span class="id" title="var">Z</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#4bfb4f2d0721ba668e3a802ab1b745a1"><span class="id" title="notation">&lt;-&gt;</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">exists</span></a> <span class="id" title="var">new_state</span> <span class="id" title="var">new_acts</span><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">,</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#receive"><span class="id" title="definition">receive</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#chain"><span class="id" title="variable">chain</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#ctx"><span class="id" title="variable">ctx</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#state"><span class="id" title="variable">state</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> (<a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#msg_mint_or_burn"><span class="id" title="constructor">msg_mint_or_burn</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#param"><span class="id" title="variable">param</span></a>)) <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#new_state"><span class="id" title="variable">new_state</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#new_acts"><span class="id" title="variable">new_acts</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">split</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">destruct_hyps</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">contract_simpl</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">autorewrite</span> <span class="id" title="keyword">with</span> <span class="id" title="var">BoolElim</span> <span class="id" title="tactic">in</span> *;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">try</span> <span class="id" title="var">easy</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="var">destruct_address_eq</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
<a name="lab220"></a><h2 class="section">Get allowance correct</h2>
 <span class="inlinecode"><a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#Dexter2Lqt.try_get_allowance"><span class="id" title="definition">try_get_allowance</span></a></span> produces a callback to the correct contract with
    the requested allowance, the call should carry no balance 
</div>
<div class="code">
<span class="id" title="keyword">Lemma</span> <a name="try_get_allowance_new_acts_correct"><span class="id" title="lemma">try_get_allowance_new_acts_correct</span></a> : <span class="id" title="keyword">forall</span> <span class="id" title="var">prev_state</span> <span class="id" title="var">new_state</span> <span class="id" title="var">chain</span> <span class="id" title="var">ctx</span> <span class="id" title="var">new_acts</span> <span class="id" title="var">param</span>,<br/>
&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#receive"><span class="id" title="definition">receive</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#chain"><span class="id" title="variable">chain</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#ctx"><span class="id" title="variable">ctx</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#prev_state"><span class="id" title="variable">prev_state</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> (<a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#msg_get_allowance"><span class="id" title="constructor">msg_get_allowance</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#param"><span class="id" title="variable">param</span></a>)) <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#new_state"><span class="id" title="variable">new_state</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#new_acts"><span class="id" title="variable">new_acts</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#new_acts"><span class="id" title="variable">new_acts</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#ddd65c2f7ee73ecec433744948d846bb"><span class="id" title="notation">[</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#act_call"><span class="id" title="constructor">act_call</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#param"><span class="id" title="variable">param</span></a>.(<a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#allowance_callback"><span class="id" title="projection">allowance_callback</span></a>) 0%<span class="id" title="var">Z</span> (<a class="idref" href="ConCert.Execution.Serializable.html#serialize"><span class="id" title="method">serialize</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#receive_allowance"><span class="id" title="constructor">receive_allowance</span></a> (<a class="idref" href="ConCert.Execution.Extras.html#with_default"><span class="id" title="definition">with_default</span></a> 0 (<a class="idref" href="ConCert.Execution.Containers.html#FMap.find"><span class="id" title="abbreviation">FMap.find</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#param"><span class="id" title="variable">param</span></a>.(<a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#request"><span class="id" title="projection">request</span></a>) (<a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#allowances"><span class="id" title="projection">allowances</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#prev_state"><span class="id" title="variable">prev_state</span></a>)))))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#ddd65c2f7ee73ecec433744948d846bb"><span class="id" title="notation">]</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> * <span class="id" title="var">receive_some</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="var">contract_simpl</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
<span class="inlinecode"><a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#Dexter2Lqt.try_get_allowance"><span class="id" title="definition">try_get_allowance</span></a></span> does not modify state 
</div>
<div class="code">
<span class="id" title="keyword">Lemma</span> <a name="try_get_allowance_preserves_state"><span class="id" title="lemma">try_get_allowance_preserves_state</span></a> : <span class="id" title="keyword">forall</span> <span class="id" title="var">prev_state</span> <span class="id" title="var">new_state</span> <span class="id" title="var">chain</span> <span class="id" title="var">ctx</span> <span class="id" title="var">new_acts</span> <span class="id" title="var">param</span>,<br/>
&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#receive"><span class="id" title="definition">receive</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#chain"><span class="id" title="variable">chain</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#ctx"><span class="id" title="variable">ctx</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#prev_state"><span class="id" title="variable">prev_state</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> (<a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#msg_get_allowance"><span class="id" title="constructor">msg_get_allowance</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#param"><span class="id" title="variable">param</span></a>)) <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#new_state"><span class="id" title="variable">new_state</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#new_acts"><span class="id" title="variable">new_acts</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#prev_state"><span class="id" title="variable">prev_state</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#new_state"><span class="id" title="variable">new_state</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> * <span class="id" title="var">receive_some</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="var">contract_simpl</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
If the requirements are met then then receive on get_allowance msg must succeed and
    if receive on get_allowance msg succeeds then requirements must hold 
</div>
<div class="code">
<span class="id" title="keyword">Lemma</span> <a name="try_get_allowance_is_some"><span class="id" title="lemma">try_get_allowance_is_some</span></a> : <span class="id" title="keyword">forall</span> <span class="id" title="var">prev_state</span> <span class="id" title="var">chain</span> <span class="id" title="var">ctx</span> <span class="id" title="var">param</span>,<br/>
&nbsp;&nbsp;(<a class="idref" href="ConCert.Execution.Blockchain.html#ctx_amount"><span class="id" title="projection">ctx_amount</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#ctx"><span class="id" title="variable">ctx</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.ZArith.BinInt.html#306329b0eca7a2b86c198702f594ad8e"><span class="id" title="notation">&lt;=</span></a> 0)%<span class="id" title="var">Z</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#4bfb4f2d0721ba668e3a802ab1b745a1"><span class="id" title="notation">&lt;-&gt;</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">exists</span></a> <span class="id" title="var">new_state</span> <span class="id" title="var">new_acts</span><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">,</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#receive"><span class="id" title="definition">receive</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#chain"><span class="id" title="variable">chain</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#ctx"><span class="id" title="variable">ctx</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#prev_state"><span class="id" title="variable">prev_state</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> (<a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#msg_get_allowance"><span class="id" title="constructor">msg_get_allowance</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#param"><span class="id" title="variable">param</span></a>)) <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#new_state"><span class="id" title="variable">new_state</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#new_acts"><span class="id" title="variable">new_acts</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">split</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">destruct_hyps</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">contract_simpl</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">autorewrite</span> <span class="id" title="keyword">with</span> <span class="id" title="var">BoolElim</span> <span class="id" title="tactic">in</span> *.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
<a name="lab221"></a><h2 class="section">Get balance correct</h2>
 <span class="inlinecode"><a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#Dexter2Lqt.try_get_balance"><span class="id" title="definition">try_get_balance</span></a></span> produces a callback to the correct contract with
    the requested balance, the call should carry no balance 
</div>
<div class="code">
<span class="id" title="keyword">Lemma</span> <a name="try_get_balance_new_acts_correct"><span class="id" title="lemma">try_get_balance_new_acts_correct</span></a> : <span class="id" title="keyword">forall</span> <span class="id" title="var">prev_state</span> <span class="id" title="var">new_state</span> <span class="id" title="var">chain</span> <span class="id" title="var">ctx</span> <span class="id" title="var">new_acts</span> <span class="id" title="var">param</span>,<br/>
&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#receive"><span class="id" title="definition">receive</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#chain"><span class="id" title="variable">chain</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#ctx"><span class="id" title="variable">ctx</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#prev_state"><span class="id" title="variable">prev_state</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> (<a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#msg_get_balance"><span class="id" title="constructor">msg_get_balance</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#param"><span class="id" title="variable">param</span></a>)) <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#new_state"><span class="id" title="variable">new_state</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#new_acts"><span class="id" title="variable">new_acts</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#new_acts"><span class="id" title="variable">new_acts</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#ddd65c2f7ee73ecec433744948d846bb"><span class="id" title="notation">[</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#act_call"><span class="id" title="constructor">act_call</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#param"><span class="id" title="variable">param</span></a>.(<a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#balance_callback"><span class="id" title="projection">balance_callback</span></a>) 0%<span class="id" title="var">Z</span> (<a class="idref" href="ConCert.Execution.Serializable.html#serialize"><span class="id" title="method">serialize</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#receive_balance_of"><span class="id" title="constructor">receive_balance_of</span></a> (<a class="idref" href="ConCert.Execution.Extras.html#with_default"><span class="id" title="definition">with_default</span></a> 0 (<a class="idref" href="ConCert.Execution.Containers.html#FMap.find"><span class="id" title="abbreviation">FMap.find</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#param"><span class="id" title="variable">param</span></a>.(<a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#owner_"><span class="id" title="projection">owner_</span></a>) (<a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#tokens"><span class="id" title="projection">tokens</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#prev_state"><span class="id" title="variable">prev_state</span></a>)))))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#ddd65c2f7ee73ecec433744948d846bb"><span class="id" title="notation">]</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> * <span class="id" title="var">receive_some</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="var">contract_simpl</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
<span class="inlinecode"><a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#Dexter2Lqt.try_get_balance"><span class="id" title="definition">try_get_balance</span></a></span> does not modify state 
</div>
<div class="code">
<span class="id" title="keyword">Lemma</span> <a name="try_get_balance_preserves_state"><span class="id" title="lemma">try_get_balance_preserves_state</span></a> : <span class="id" title="keyword">forall</span> <span class="id" title="var">prev_state</span> <span class="id" title="var">new_state</span> <span class="id" title="var">chain</span> <span class="id" title="var">ctx</span> <span class="id" title="var">new_acts</span> <span class="id" title="var">param</span>,<br/>
&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#receive"><span class="id" title="definition">receive</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#chain"><span class="id" title="variable">chain</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#ctx"><span class="id" title="variable">ctx</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#prev_state"><span class="id" title="variable">prev_state</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> (<a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#msg_get_balance"><span class="id" title="constructor">msg_get_balance</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#param"><span class="id" title="variable">param</span></a>)) <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#new_state"><span class="id" title="variable">new_state</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#new_acts"><span class="id" title="variable">new_acts</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#prev_state"><span class="id" title="variable">prev_state</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#new_state"><span class="id" title="variable">new_state</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> * <span class="id" title="var">receive_some</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="var">contract_simpl</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
If the requirements are met then then receive on get_balance msg must succeed and
    if receive on get_balance msg succeeds then requirements must hold 
</div>
<div class="code">
<span class="id" title="keyword">Lemma</span> <a name="try_get_balance_is_some"><span class="id" title="lemma">try_get_balance_is_some</span></a> : <span class="id" title="keyword">forall</span> <span class="id" title="var">prev_state</span> <span class="id" title="var">chain</span> <span class="id" title="var">ctx</span> <span class="id" title="var">param</span>,<br/>
&nbsp;&nbsp;(<a class="idref" href="ConCert.Execution.Blockchain.html#ctx_amount"><span class="id" title="projection">ctx_amount</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#ctx"><span class="id" title="variable">ctx</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.ZArith.BinInt.html#306329b0eca7a2b86c198702f594ad8e"><span class="id" title="notation">&lt;=</span></a> 0)%<span class="id" title="var">Z</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#4bfb4f2d0721ba668e3a802ab1b745a1"><span class="id" title="notation">&lt;-&gt;</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">exists</span></a> <span class="id" title="var">new_state</span> <span class="id" title="var">new_acts</span><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">,</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#receive"><span class="id" title="definition">receive</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#chain"><span class="id" title="variable">chain</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#ctx"><span class="id" title="variable">ctx</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#prev_state"><span class="id" title="variable">prev_state</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> (<a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#msg_get_balance"><span class="id" title="constructor">msg_get_balance</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#param"><span class="id" title="variable">param</span></a>)) <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#new_state"><span class="id" title="variable">new_state</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#new_acts"><span class="id" title="variable">new_acts</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">split</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">destruct_hyps</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">contract_simpl</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">autorewrite</span> <span class="id" title="keyword">with</span> <span class="id" title="var">BoolElim</span> <span class="id" title="tactic">in</span> *.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
<a name="lab222"></a><h2 class="section">Get total supply correct</h2>
 <span class="inlinecode"><a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#Dexter2Lqt.try_get_total_supply"><span class="id" title="definition">try_get_total_supply</span></a></span> produces a callback to the correct contract with
    the total supply of tokens, the call should carry no balance 
</div>
<div class="code">
<span class="id" title="keyword">Lemma</span> <a name="try_get_total_supply_new_acts_correct"><span class="id" title="lemma">try_get_total_supply_new_acts_correct</span></a> : <span class="id" title="keyword">forall</span> <span class="id" title="var">prev_state</span> <span class="id" title="var">new_state</span> <span class="id" title="var">chain</span> <span class="id" title="var">ctx</span> <span class="id" title="var">new_acts</span> <span class="id" title="var">param</span>,<br/>
&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#receive"><span class="id" title="definition">receive</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#chain"><span class="id" title="variable">chain</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#ctx"><span class="id" title="variable">ctx</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#prev_state"><span class="id" title="variable">prev_state</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> (<a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#msg_get_total_supply"><span class="id" title="constructor">msg_get_total_supply</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#param"><span class="id" title="variable">param</span></a>)) <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#new_state"><span class="id" title="variable">new_state</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#new_acts"><span class="id" title="variable">new_acts</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#new_acts"><span class="id" title="variable">new_acts</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#ddd65c2f7ee73ecec433744948d846bb"><span class="id" title="notation">[</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#act_call"><span class="id" title="constructor">act_call</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#param"><span class="id" title="variable">param</span></a>.(<a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#supply_callback"><span class="id" title="projection">supply_callback</span></a>) 0%<span class="id" title="var">Z</span> (<a class="idref" href="ConCert.Execution.Serializable.html#serialize"><span class="id" title="method">serialize</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#receive_total_supply"><span class="id" title="constructor">receive_total_supply</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#prev_state"><span class="id" title="variable">prev_state</span></a>.(<a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#total_supply"><span class="id" title="projection">total_supply</span></a>)))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#ddd65c2f7ee73ecec433744948d846bb"><span class="id" title="notation">]</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> * <span class="id" title="var">receive_some</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="var">contract_simpl</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
<span class="inlinecode"><a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#Dexter2Lqt.try_get_total_supply"><span class="id" title="definition">try_get_total_supply</span></a></span> does not modify state 
</div>
<div class="code">
<span class="id" title="keyword">Lemma</span> <a name="try_get_total_supply_preserves_state"><span class="id" title="lemma">try_get_total_supply_preserves_state</span></a> : <span class="id" title="keyword">forall</span> <span class="id" title="var">prev_state</span> <span class="id" title="var">new_state</span> <span class="id" title="var">chain</span> <span class="id" title="var">ctx</span> <span class="id" title="var">new_acts</span> <span class="id" title="var">param</span>,<br/>
&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#receive"><span class="id" title="definition">receive</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#chain"><span class="id" title="variable">chain</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#ctx"><span class="id" title="variable">ctx</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#prev_state"><span class="id" title="variable">prev_state</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> (<a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#msg_get_total_supply"><span class="id" title="constructor">msg_get_total_supply</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#param"><span class="id" title="variable">param</span></a>)) <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#new_state"><span class="id" title="variable">new_state</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#new_acts"><span class="id" title="variable">new_acts</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#prev_state"><span class="id" title="variable">prev_state</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#new_state"><span class="id" title="variable">new_state</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> * <span class="id" title="var">receive_some</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="var">contract_simpl</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
If the requirements are met then then receive on get_total_supply msg must succeed and
    if receive on get_total_supply msg succeeds then requirements must hold 
</div>
<div class="code">
<span class="id" title="keyword">Lemma</span> <a name="try_get_total_supply_is_some"><span class="id" title="lemma">try_get_total_supply_is_some</span></a> : <span class="id" title="keyword">forall</span> <span class="id" title="var">prev_state</span> <span class="id" title="var">chain</span> <span class="id" title="var">ctx</span> <span class="id" title="var">param</span>,<br/>
&nbsp;&nbsp;(<a class="idref" href="ConCert.Execution.Blockchain.html#ctx_amount"><span class="id" title="projection">ctx_amount</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#ctx"><span class="id" title="variable">ctx</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.ZArith.BinInt.html#306329b0eca7a2b86c198702f594ad8e"><span class="id" title="notation">&lt;=</span></a> 0)%<span class="id" title="var">Z</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#4bfb4f2d0721ba668e3a802ab1b745a1"><span class="id" title="notation">&lt;-&gt;</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">exists</span></a> <span class="id" title="var">new_state</span> <span class="id" title="var">new_acts</span><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">,</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#receive"><span class="id" title="definition">receive</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#chain"><span class="id" title="variable">chain</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#ctx"><span class="id" title="variable">ctx</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#prev_state"><span class="id" title="variable">prev_state</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> (<a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#msg_get_total_supply"><span class="id" title="constructor">msg_get_total_supply</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#param"><span class="id" title="variable">param</span></a>)) <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#new_state"><span class="id" title="variable">new_state</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#new_acts"><span class="id" title="variable">new_acts</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">split</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">destruct_hyps</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">contract_simpl</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">autorewrite</span> <span class="id" title="keyword">with</span> <span class="id" title="var">BoolElim</span> <span class="id" title="tactic">in</span> *.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
<a name="lab223"></a><h2 class="section">Init correct</h2>
 After initalization no accounts should hold tokens 
</div>
<div class="code">
<span class="id" title="keyword">Lemma</span> <a name="init_balances_correct"><span class="id" title="lemma">init_balances_correct</span></a> : <span class="id" title="keyword">forall</span> <span class="id" title="var">chain</span> <span class="id" title="var">ctx</span> <span class="id" title="var">setup</span> <span class="id" title="var">state</span>,<br/>
&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#init"><span class="id" title="definition">init</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#chain"><span class="id" title="variable">chain</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#ctx"><span class="id" title="variable">ctx</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#setup"><span class="id" title="variable">setup</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#state"><span class="id" title="variable">state</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#state"><span class="id" title="variable">state</span></a>.(<a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#tokens"><span class="id" title="projection">tokens</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="ConCert.Execution.Containers.html#FMap.add"><span class="id" title="abbreviation">FMap.add</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#setup"><span class="id" title="variable">setup</span></a>.(<a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#lqt_provider"><span class="id" title="projection">lqt_provider</span></a>) <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#setup"><span class="id" title="variable">setup</span></a>.(<a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#initial_pool"><span class="id" title="projection">initial_pool</span></a>) <a class="idref" href="ConCert.Execution.Containers.html#FMap.empty"><span class="id" title="abbreviation">FMap.empty</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> * <span class="id" title="var">init_some</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">inversion</span> <span class="id" title="var">init_some</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
After initalization no allowances should be set 
</div>
<div class="code">
<span class="id" title="keyword">Lemma</span> <a name="init_allowances_correct"><span class="id" title="lemma">init_allowances_correct</span></a> : <span class="id" title="keyword">forall</span> <span class="id" title="var">chain</span> <span class="id" title="var">ctx</span> <span class="id" title="var">setup</span> <span class="id" title="var">state</span>,<br/>
&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#init"><span class="id" title="definition">init</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#chain"><span class="id" title="variable">chain</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#ctx"><span class="id" title="variable">ctx</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#setup"><span class="id" title="variable">setup</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#state"><span class="id" title="variable">state</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#state"><span class="id" title="variable">state</span></a>.(<a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#allowances"><span class="id" title="projection">allowances</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="ConCert.Execution.Containers.html#FMap.empty"><span class="id" title="abbreviation">FMap.empty</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> * <span class="id" title="var">init_some</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">inversion</span> <span class="id" title="var">init_some</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a name="init_admin_correct"><span class="id" title="lemma">init_admin_correct</span></a> : <span class="id" title="keyword">forall</span> <span class="id" title="var">chain</span> <span class="id" title="var">ctx</span> <span class="id" title="var">setup</span> <span class="id" title="var">state</span>,<br/>
&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#init"><span class="id" title="definition">init</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#chain"><span class="id" title="variable">chain</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#ctx"><span class="id" title="variable">ctx</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#setup"><span class="id" title="variable">setup</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#state"><span class="id" title="variable">state</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#state"><span class="id" title="variable">state</span></a>.(<a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#admin"><span class="id" title="projection">admin</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#setup"><span class="id" title="variable">setup</span></a>.(<a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#admin_"><span class="id" title="projection">admin_</span></a>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> * <span class="id" title="var">init_some</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">inversion</span> <span class="id" title="var">init_some</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a name="init_total_supply_correct"><span class="id" title="lemma">init_total_supply_correct</span></a> : <span class="id" title="keyword">forall</span> <span class="id" title="var">chain</span> <span class="id" title="var">ctx</span> <span class="id" title="var">setup</span> <span class="id" title="var">state</span>,<br/>
&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#init"><span class="id" title="definition">init</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#chain"><span class="id" title="variable">chain</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#ctx"><span class="id" title="variable">ctx</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#setup"><span class="id" title="variable">setup</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#state"><span class="id" title="variable">state</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#state"><span class="id" title="variable">state</span></a>.(<a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#total_supply"><span class="id" title="projection">total_supply</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#setup"><span class="id" title="variable">setup</span></a>.(<a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#initial_pool"><span class="id" title="projection">initial_pool</span></a>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> * <span class="id" title="var">init_some</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">inversion</span> <span class="id" title="var">init_some</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
initialization should always succeed 
</div>
<div class="code">
<span class="id" title="keyword">Lemma</span> <a name="init_is_some"><span class="id" title="lemma">init_is_some</span></a> : <span class="id" title="keyword">forall</span> <span class="id" title="var">chain</span> <span class="id" title="var">ctx</span> <span class="id" title="var">setup</span>,<br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">exists</span></a> <span class="id" title="var">state</span><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">,</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#init"><span class="id" title="definition">init</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#chain"><span class="id" title="variable">chain</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#ctx"><span class="id" title="variable">ctx</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#setup"><span class="id" title="variable">setup</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#state"><span class="id" title="variable">state</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">eauto</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>

<br/>
</div>

<div class="doc">
<a name="lab224"></a><h2 class="section">Outgoing acts facts</h2>
 If contract emits self calls then they are for the receive entrypoints (which do not exits) 
</div>
<div class="code">
<span class="id" title="keyword">Lemma</span> <a name="only_getter_self_calls"><span class="id" title="lemma">only_getter_self_calls</span></a> <span class="id" title="var">bstate</span> <span class="id" title="var">caddr</span> :<br/>
&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#reachable"><span class="id" title="definition">reachable</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#bstate"><span class="id" title="variable">bstate</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#env_contracts"><span class="id" title="projection">env_contracts</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#bstate"><span class="id" title="variable">bstate</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#caddr"><span class="id" title="variable">caddr</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> (<a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#contract"><span class="id" title="definition">contract</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#WeakContract"><span class="id" title="inductive">WeakContract</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#Forall"><span class="id" title="inductive">Forall</span></a> (<span class="id" title="keyword">fun</span> <span class="id" title="var">act_body</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#act_body"><span class="id" title="variable">act_body</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="ConCert.Execution.Blockchain.html#act_transfer"><span class="id" title="constructor">act_transfer</span></a> <span class="id" title="var">to</span> <span class="id" title="var">_</span> =&gt; <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#False"><span class="id" title="inductive">False</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="ConCert.Execution.Blockchain.html#act_call"><span class="id" title="constructor">act_call</span></a> <span class="id" title="var">to</span> <span class="id" title="var">_</span> <span class="id" title="var">msg</span> =&gt; <span class="id" title="var">to</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#caddr"><span class="id" title="variable">caddr</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#f031fe1957c4a4a8e217aa46af2b4e25"><span class="id" title="notation">(</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">exists</span></a> <span class="id" title="var">n</span><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">,</span></a> <span class="id" title="var">msg</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="ConCert.Execution.Serializable.html#serialize"><span class="id" title="method">serialize</span></a> (<a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#receive_allowance"><span class="id" title="constructor">receive_allowance</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#n"><span class="id" title="variable">n</span></a>)<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#f031fe1957c4a4a8e217aa46af2b4e25"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#f031fe1957c4a4a8e217aa46af2b4e25"><span class="id" title="notation">\/</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#f031fe1957c4a4a8e217aa46af2b4e25"><span class="id" title="notation">(</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">exists</span></a> <span class="id" title="var">n</span><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">,</span></a> <span class="id" title="var">msg</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="ConCert.Execution.Serializable.html#serialize"><span class="id" title="method">serialize</span></a> (<a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#receive_balance_of"><span class="id" title="constructor">receive_balance_of</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#n"><span class="id" title="variable">n</span></a>)<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#f031fe1957c4a4a8e217aa46af2b4e25"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#f031fe1957c4a4a8e217aa46af2b4e25"><span class="id" title="notation">\/</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#f031fe1957c4a4a8e217aa46af2b4e25"><span class="id" title="notation">(</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">exists</span></a> <span class="id" title="var">n</span><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">,</span></a> <span class="id" title="var">msg</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="ConCert.Execution.Serializable.html#serialize"><span class="id" title="method">serialize</span></a> (<a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#receive_total_supply"><span class="id" title="constructor">receive_total_supply</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#n"><span class="id" title="variable">n</span></a>)<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#f031fe1957c4a4a8e217aa46af2b4e25"><span class="id" title="notation">)</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">_</span> =&gt; <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#False"><span class="id" title="inductive">False</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>) (<a class="idref" href="ConCert.Execution.Blockchain.html#outgoing_acts"><span class="id" title="definition">outgoing_acts</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#bstate"><span class="id" title="variable">bstate</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#caddr"><span class="id" title="variable">caddr</span></a>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">contract_induction</span>; <span class="id" title="tactic">intros</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">now</span> <span class="id" title="tactic">inversion</span> <span class="id" title="var">IH</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> <a class="idref" href="ConCert.Execution.Extras.html#Forall_app"><span class="id" title="lemma">Forall_app</span></a>; <span class="id" title="tactic">split</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">clear</span> <span class="id" title="var">IH</span>. <span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">msg</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">destruct</span> <span class="id" title="var">m</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">try_solve_acts_correct</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="var">contract_simpl</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">inversion_clear</span> <span class="id" title="var">IH</span> <span class="id" title="keyword">as</span> [|? ? <span class="id" title="var">head_not_me</span> <span class="id" title="var">tail_not_me</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">head</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">try</span> <span class="id" title="var">contradiction</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">action_facts</span> <span class="id" title="keyword">as</span> (? &amp; ? &amp; ? &amp; ?).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">head_not_me</span> <span class="id" title="keyword">as</span> [[] | [[] | []]]; <span class="id" title="tactic">auto</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">subst</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="var">contract_simpl</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> &lt;- <span class="id" title="var">perm</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">instantiate</span> (<span class="id" title="var">AddBlockFacts</span> := <span class="id" title="keyword">fun</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> =&gt; <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#True"><span class="id" title="inductive">True</span></a>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">instantiate</span> (<span class="id" title="var">DeployFacts</span> := <span class="id" title="keyword">fun</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> =&gt; <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#True"><span class="id" title="inductive">True</span></a>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">instantiate</span> (<span class="id" title="var">CallFacts</span> := <span class="id" title="keyword">fun</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> =&gt; <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#True"><span class="id" title="inductive">True</span></a>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">unset_all</span>; <span class="id" title="tactic">subst</span>;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">destruct_chain_step</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">destruct_action_eval</span>; <span class="id" title="tactic">auto</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
Contract never calls itself 
</div>
<div class="code">
<span class="id" title="keyword">Lemma</span> <a name="no_self_calls"><span class="id" title="lemma">no_self_calls</span></a> : <span class="id" title="keyword">forall</span> <span class="id" title="var">bstate</span> <span class="id" title="var">origin</span> <span class="id" title="var">from_addr</span> <span class="id" title="var">to_addr</span> <span class="id" title="var">amount</span> <span class="id" title="var">msg</span> <span class="id" title="var">acts</span> <span class="id" title="var">ctx</span> <span class="id" title="var">prev_state</span> <span class="id" title="var">new_state</span> <span class="id" title="var">resp_acts</span>,<br/>
&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#reachable"><span class="id" title="definition">reachable</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#bstate"><span class="id" title="variable">bstate</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#env_contracts"><span class="id" title="projection">env_contracts</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#bstate"><span class="id" title="variable">bstate</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#to_addr"><span class="id" title="variable">to_addr</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> (<a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#contract"><span class="id" title="definition">contract</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#WeakContract"><span class="id" title="inductive">WeakContract</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#chain_state_queue"><span class="id" title="projection">chain_state_queue</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#bstate"><span class="id" title="variable">bstate</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#cbcf67aac0c2a85b8d93d37de9969adf"><span class="id" title="notation">{|</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#build_act"><span class="id" title="constructor">act_origin</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#build_act"><span class="id" title="constructor">:=</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#build_act"><span class="id" title="constructor">origin</span></a><a class="idref" href="ConCert.Execution.Blockchain.html#build_act"><span class="id" title="constructor">;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#build_act"><span class="id" title="constructor">act_from</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#build_act"><span class="id" title="constructor">:=</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#build_act"><span class="id" title="constructor">from_addr</span></a><a class="idref" href="ConCert.Execution.Blockchain.html#build_act"><span class="id" title="constructor">;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#build_act"><span class="id" title="constructor">act_body</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#build_act"><span class="id" title="constructor">:=</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#build_act"><span class="id" title="constructor">match</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#build_act"><span class="id" title="constructor">msg</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#build_act"><span class="id" title="constructor">with</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#build_act"><span class="id" title="constructor">|</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#build_act"><span class="id" title="constructor">Some</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#build_act"><span class="id" title="constructor">msg</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#build_act"><span class="id" title="constructor">=&gt;</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#build_act"><span class="id" title="constructor">act_call</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#build_act"><span class="id" title="constructor">to_addr</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#build_act"><span class="id" title="constructor">amount</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#build_act"><span class="id" title="constructor">msg</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#build_act"><span class="id" title="constructor">|</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#build_act"><span class="id" title="constructor">None</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#build_act"><span class="id" title="constructor">=&gt;</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#build_act"><span class="id" title="constructor">act_transfer</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#build_act"><span class="id" title="constructor">to_addr</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#build_act"><span class="id" title="constructor">amount</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#build_act"><span class="id" title="constructor">end</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#cbcf67aac0c2a85b8d93d37de9969adf"><span class="id" title="notation">|}</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#cbcf67aac0c2a85b8d93d37de9969adf"><span class="id" title="notation">::</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#acts"><span class="id" title="variable">acts</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#wc_receive"><span class="id" title="definition">wc_receive</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#contract"><span class="id" title="definition">contract</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#bstate"><span class="id" title="variable">bstate</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#ctx"><span class="id" title="variable">ctx</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#prev_state"><span class="id" title="variable">prev_state</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#msg"><span class="id" title="variable">msg</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#new_state"><span class="id" title="variable">new_state</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#resp_acts"><span class="id" title="variable">resp_acts</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#from_addr"><span class="id" title="variable">from_addr</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#a0a5068f83a704fcfbda8cd473a6cfea"><span class="id" title="notation">&lt;&gt;</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#to_addr"><span class="id" title="variable">to_addr</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> * <span class="id" title="var">reach</span> <span class="id" title="var">deployed</span> <span class="id" title="var">queue</span> <span class="id" title="var">receive_some</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#only_getter_self_calls"><span class="id" title="lemma">only_getter_self_calls</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">deployed</span> <span class="id" title="keyword">as</span> <span class="id" title="var">no_self_calls</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="ConCert.Execution.Blockchain.html#outgoing_acts"><span class="id" title="definition">outgoing_acts</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">no_self_calls</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">queue</span> <span class="id" title="tactic">in</span> <span class="id" title="var">no_self_calls</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> <span class="id" title="var">no_self_calls</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">destruct_address_eq</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">inversion_clear</span> <span class="id" title="var">no_self_calls</span> <span class="id" title="keyword">as</span> [|? ? <span class="id" title="var">hd</span> <span class="id" title="var">_</span>].<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">msg</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">hd</span> <span class="id" title="keyword">as</span> [[] | [[] | []]];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">auto</span>; <span class="id" title="tactic">subst</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="ConCert.Execution.Blockchain.html#wc_receive_strong"><span class="id" title="lemma">wc_receive_strong</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">receive_some</span> <span class="id" title="keyword">as</span> (<span class="id" title="var">_</span> &amp; ? &amp; <span class="id" title="var">_</span> &amp; <span class="id" title="var">_</span> &amp; <span class="id" title="var">msg_correct</span> &amp; <span class="id" title="var">_</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="var">destruct_match</span> <span class="id" title="tactic">in</span> <span class="id" title="var">msg_correct</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
The contract never produces actions carrying money 
</div>
<div class="code">
<span class="id" title="keyword">Lemma</span> <a name="new_acts_amount_zero"><span class="id" title="lemma">new_acts_amount_zero</span></a> : <span class="id" title="keyword">forall</span> <span class="id" title="var">prev_state</span> <span class="id" title="var">chain</span> <span class="id" title="var">ctx</span> <span class="id" title="var">msg</span> <span class="id" title="var">new_state</span> <span class="id" title="var">new_acts</span>,<br/>
&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#receive"><span class="id" title="definition">receive</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#chain"><span class="id" title="variable">chain</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#ctx"><span class="id" title="variable">ctx</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#prev_state"><span class="id" title="variable">prev_state</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#msg"><span class="id" title="variable">msg</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#new_state"><span class="id" title="variable">new_state</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#new_acts"><span class="id" title="variable">new_acts</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Extras.html#sumZ"><span class="id" title="definition">sumZ</span></a> (<span class="id" title="keyword">fun</span> <span class="id" title="var">act</span> =&gt; <a class="idref" href="ConCert.Execution.Blockchain.html#act_body_amount"><span class="id" title="definition">act_body_amount</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#act"><span class="id" title="variable">act</span></a>) <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#new_acts"><span class="id" title="variable">new_acts</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> 0%<span class="id" title="var">Z</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> * <span class="id" title="var">receive_some</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">msg</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">destruct</span> <span class="id" title="var">m</span>;<span class="id" title="var">try_solve_acts_correct</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">contract_simpl</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a name="outgoing_acts_amount_zero"><span class="id" title="lemma">outgoing_acts_amount_zero</span></a> : <span class="id" title="keyword">forall</span> <span class="id" title="var">bstate</span> <span class="id" title="var">caddr</span>,<br/>
&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#reachable"><span class="id" title="definition">reachable</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#bstate"><span class="id" title="variable">bstate</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#env_contracts"><span class="id" title="projection">env_contracts</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#bstate"><span class="id" title="variable">bstate</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#caddr"><span class="id" title="variable">caddr</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> (<a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#contract"><span class="id" title="definition">contract</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#WeakContract"><span class="id" title="inductive">WeakContract</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#Forall"><span class="id" title="inductive">Forall</span></a> (<span class="id" title="keyword">fun</span> <span class="id" title="var">act</span> =&gt; <a class="idref" href="ConCert.Execution.Blockchain.html#act_body_amount"><span class="id" title="definition">act_body_amount</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#act"><span class="id" title="variable">act</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> 0%<span class="id" title="var">Z</span>) (<a class="idref" href="ConCert.Execution.Blockchain.html#outgoing_acts"><span class="id" title="definition">outgoing_acts</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#bstate"><span class="id" title="variable">bstate</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#caddr"><span class="id" title="variable">caddr</span></a>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> * <span class="id" title="var">reach</span> <span class="id" title="var">deployed</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<a class="idref" href="ConCert.Execution.Blockchain.html#lift_outgoing_acts_prop"><span class="id" title="lemma">lift_outgoing_acts_prop</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#contract"><span class="id" title="definition">contract</span></a>); <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> * <span class="id" title="var">receive_some</span>. <span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">msg</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">destruct</span> <span class="id" title="var">m</span>;<span class="id" title="var">try_solve_acts_correct</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">contract_simpl</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
Contract only produces contract call actions 
</div>
<div class="code">
<span class="id" title="keyword">Lemma</span> <a name="outgoing_acts_are_calls"><span class="id" title="lemma">outgoing_acts_are_calls</span></a> : <span class="id" title="keyword">forall</span> <span class="id" title="var">bstate</span> <span class="id" title="var">caddr</span>,<br/>
&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#reachable"><span class="id" title="definition">reachable</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#bstate"><span class="id" title="variable">bstate</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#env_contracts"><span class="id" title="projection">env_contracts</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#bstate"><span class="id" title="variable">bstate</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#caddr"><span class="id" title="variable">caddr</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> (<a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#contract"><span class="id" title="definition">contract</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#WeakContract"><span class="id" title="inductive">WeakContract</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#Forall"><span class="id" title="inductive">Forall</span></a> (<span class="id" title="keyword">fun</span> <span class="id" title="var">act_body</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#act_body"><span class="id" title="variable">act_body</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="ConCert.Execution.Blockchain.html#act_call"><span class="id" title="constructor">act_call</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> =&gt; <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#True"><span class="id" title="inductive">True</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">_</span> =&gt; <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#False"><span class="id" title="inductive">False</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>) (<a class="idref" href="ConCert.Execution.Blockchain.html#outgoing_acts"><span class="id" title="definition">outgoing_acts</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#bstate"><span class="id" title="variable">bstate</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#caddr"><span class="id" title="variable">caddr</span></a>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> * <span class="id" title="var">reach</span> <span class="id" title="var">deployed</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<a class="idref" href="ConCert.Execution.Blockchain.html#lift_outgoing_acts_prop"><span class="id" title="lemma">lift_outgoing_acts_prop</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#contract"><span class="id" title="definition">contract</span></a>); <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> * <span class="id" title="var">receive_some</span>; <span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">msg</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">destruct</span> <span class="id" title="var">m</span>; <span class="id" title="var">try_solve_acts_correct</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">contract_simpl</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
<a name="lab225"></a><h2 class="section">Contract balance facts</h2>

</div>
<div class="code">
<span class="comment">(*&nbsp;Contract&nbsp;balance&nbsp;should&nbsp;never&nbsp;change&nbsp;and&nbsp;thus&nbsp;always&nbsp;be&nbsp;equal&nbsp;to&nbsp;the&nbsp;deploy&nbsp;amount&nbsp;*)</span><br/>
<span class="id" title="keyword">Lemma</span> <a name="contract_balance_bound'"><span class="id" title="lemma">contract_balance_bound'</span></a> : <span class="id" title="keyword">forall</span> <span class="id" title="var">bstate</span> <span class="id" title="var">caddr</span> (<span class="id" title="var">trace</span> : <a class="idref" href="ConCert.Execution.Blockchain.html#ChainTrace"><span class="id" title="definition">ChainTrace</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#empty_state"><span class="id" title="definition">empty_state</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#bstate"><span class="id" title="variable">bstate</span></a>),<br/>
&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">effective_balance</span> := (<a class="idref" href="ConCert.Execution.Blockchain.html#env_account_balances"><span class="id" title="projection">env_account_balances</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#bstate"><span class="id" title="variable">bstate</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#caddr"><span class="id" title="variable">caddr</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.ZArith.BinInt.html#fa12f60d56cf7225f009c889c0622139"><span class="id" title="notation">-</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.ZArith.BinInt.html#fa12f60d56cf7225f009c889c0622139"><span class="id" title="notation">(</span></a><a class="idref" href="ConCert.Execution.Extras.html#sumZ"><span class="id" title="definition">sumZ</span></a> (<span class="id" title="keyword">fun</span> <span class="id" title="var">act</span> =&gt; <a class="idref" href="ConCert.Execution.Blockchain.html#act_body_amount"><span class="id" title="definition">act_body_amount</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#act"><span class="id" title="variable">act</span></a>) (<a class="idref" href="ConCert.Execution.Blockchain.html#outgoing_acts"><span class="id" title="definition">outgoing_acts</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#bstate"><span class="id" title="variable">bstate</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#caddr"><span class="id" title="variable">caddr</span></a>)<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.ZArith.BinInt.html#fa12f60d56cf7225f009c889c0622139"><span class="id" title="notation">)</span></a>)%<span class="id" title="var">Z</span> <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#env_contracts"><span class="id" title="projection">env_contracts</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#bstate"><span class="id" title="variable">bstate</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#caddr"><span class="id" title="variable">caddr</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> (<a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#contract"><span class="id" title="definition">contract</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#WeakContract"><span class="id" title="inductive">WeakContract</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">exists</span></a> <span class="id" title="var">deploy_info</span><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">,</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#deployment_info"><span class="id" title="definition">deployment_info</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#Setup"><span class="id" title="record">Setup</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#trace"><span class="id" title="variable">trace</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#caddr"><span class="id" title="variable">caddr</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#deploy_info"><span class="id" title="variable">deploy_info</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">/\</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#effective_balance"><span class="id" title="variable">effective_balance</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#deploy_info"><span class="id" title="variable">deploy_info</span></a>.(<a class="idref" href="ConCert.Execution.Blockchain.html#deployment_amount"><span class="id" title="projection">deployment_amount</span></a>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">subst</span> <span class="id" title="var">effective_balance</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">contract_induction</span>; <span class="id" title="tactic">intros</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">lia</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> <span class="id" title="var">IH</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">lia</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">instantiate</span> (<span class="id" title="var">CallFacts</span> := <span class="id" title="keyword">fun</span> <span class="id" title="var">_</span> <span class="id" title="var">ctx</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(0 <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.ZArith.BinInt.html#306329b0eca7a2b86c198702f594ad8e"><span class="id" title="notation">&lt;=</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#ctx_amount"><span class="id" title="projection">ctx_amount</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#ctx"><span class="id" title="variable">ctx</span></a>)%<span class="id" title="var">Z</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">/\</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#ctx_from"><span class="id" title="projection">ctx_from</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#ctx"><span class="id" title="variable">ctx</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#a0a5068f83a704fcfbda8cd473a6cfea"><span class="id" title="notation">&lt;&gt;</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#ctx_contract_address"><span class="id" title="projection">ctx_contract_address</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#ctx"><span class="id" title="variable">ctx</span></a>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">facts</span> <span class="id" title="keyword">as</span> (<span class="id" title="var">ctx_amount_positive</span> &amp; <span class="id" title="var">_</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#contract_not_payable"><span class="id" title="lemma">contract_not_payable</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">receive_some</span> <span class="id" title="keyword">as</span> <span class="id" title="var">not_payable</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#new_acts_amount_zero"><span class="id" title="lemma">new_acts_amount_zero</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">receive_some</span> <span class="id" title="keyword">as</span> <span class="id" title="var">amount_zero_new_acts</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.ZArith.BinInt.html#Z.le_antisymm"><span class="id" title="lemma">Z.le_antisymm</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">ctx_amount_positive</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">ctx_amount_positive</span>, <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.ZArith.BinInt.html#Z.sub_0_r"><span class="id" title="lemma">Z.sub_0_r</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">IH</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <a class="idref" href="ConCert.Execution.Extras.html#sumZ_app"><span class="id" title="lemma">sumZ_app</span></a>, <span class="id" title="var">amount_zero_new_acts</span>, <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.ZArith.BinInt.html#Z.add_0_l"><span class="id" title="lemma">Z.add_0_l</span></a>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">now</span> <span class="id" title="tactic">destruct</span> <span class="id" title="var">facts</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">now</span> <span class="id" title="var">erewrite</span> <a class="idref" href="ConCert.Execution.Extras.html#sumZ_permutation"><span class="id" title="lemma">sumZ_permutation</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">IH</span> <span class="id" title="tactic">by</span> <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">instantiate</span> (<span class="id" title="var">AddBlockFacts</span> := <span class="id" title="keyword">fun</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> =&gt; <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#True"><span class="id" title="inductive">True</span></a>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">instantiate</span> (<span class="id" title="var">DeployFacts</span> := <span class="id" title="keyword">fun</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> =&gt; <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#True"><span class="id" title="inductive">True</span></a>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">unset_all</span>; <span class="id" title="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">destruct_chain_step</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">destruct_action_eval</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">subst</span>. <span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.ZArith.BinInt.html#Z.ge_le"><span class="id" title="lemma">Z.ge_le</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">rewrite</span> <span class="id" title="var">deployed</span> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="keyword">goal</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">H</span> : <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> ?<span class="id" title="var">x</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <span class="id" title="var">_</span> |- <span class="id" title="var">_</span> =&gt; <span class="id" title="tactic">inversion</span> <span class="id" title="var">H</span>; <span class="id" title="tactic">subst</span> <span class="id" title="var">x</span>; <span class="id" title="tactic">clear</span> <span class="id" title="var">H</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">eapply</span> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#no_self_calls"><span class="id" title="lemma">no_self_calls</span></a>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a name="contract_balance_bound"><span class="id" title="lemma">contract_balance_bound</span></a> : <span class="id" title="keyword">forall</span> <span class="id" title="var">bstate</span> <span class="id" title="var">caddr</span> (<span class="id" title="var">trace</span> : <a class="idref" href="ConCert.Execution.Blockchain.html#ChainTrace"><span class="id" title="definition">ChainTrace</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#empty_state"><span class="id" title="definition">empty_state</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#bstate"><span class="id" title="variable">bstate</span></a>),<br/>
&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#env_contracts"><span class="id" title="projection">env_contracts</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#bstate"><span class="id" title="variable">bstate</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#caddr"><span class="id" title="variable">caddr</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> (<a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#contract"><span class="id" title="definition">contract</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#WeakContract"><span class="id" title="inductive">WeakContract</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">exists</span></a> <span class="id" title="var">deploy_info</span><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">,</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#deployment_info"><span class="id" title="definition">deployment_info</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#Setup"><span class="id" title="record">Setup</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#trace"><span class="id" title="variable">trace</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#caddr"><span class="id" title="variable">caddr</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#deploy_info"><span class="id" title="variable">deploy_info</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">/\</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#env_account_balances"><span class="id" title="projection">env_account_balances</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#bstate"><span class="id" title="variable">bstate</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#caddr"><span class="id" title="variable">caddr</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#deploy_info"><span class="id" title="variable">deploy_info</span></a>.(<a class="idref" href="ConCert.Execution.Blockchain.html#deployment_amount"><span class="id" title="projection">deployment_amount</span></a>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> * <span class="id" title="var">deployed</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">specialize</span> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#contract_balance_bound'"><span class="id" title="lemma">contract_balance_bound'</span></a> <span class="id" title="keyword">as</span> (<span class="id" title="var">dep_info</span> &amp; <span class="id" title="var">deployment_info_eq</span> &amp; <span class="id" title="var">balance_bound</span>); <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">eexists</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">deployment_info_eq</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">split</span>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- <span class="id" title="var">balance_bound</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.ZArith.BinInt.html#Zminus_0_l_reverse"><span class="id" title="lemma">Zminus_0_l_reverse</span></a>, <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.ZArith.BinInt.html#Z.sub_cancel_l"><span class="id" title="lemma">Z.sub_cancel_l</span></a> <span class="id" title="tactic">at</span> 1.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#outgoing_acts_amount_zero"><span class="id" title="lemma">outgoing_acts_amount_zero</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">deployed</span> <span class="id" title="keyword">as</span> <span class="id" title="var">act_amount_zero</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">try</span> <span class="id" title="var">now</span> <span class="id" title="tactic">constructor</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">clear</span> <span class="id" title="var">balance_bound</span> <span class="id" title="var">deployment_info_eq</span> <span class="id" title="var">dep_info</span> <span class="id" title="var">trace</span> <span class="id" title="var">deployed</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> (<a class="idref" href="ConCert.Execution.Blockchain.html#outgoing_acts"><span class="id" title="definition">outgoing_acts</span></a> <span class="id" title="var">bstate</span> <span class="id" title="var">caddr</span>).<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="lemma">list.Forall_cons</span> <span class="id" title="tactic">in</span> <span class="id" title="var">act_amount_zero</span> <span class="id" title="keyword">as</span> (<span class="id" title="var">act_amount_zero</span> &amp; <span class="id" title="var">acts_amount_zero</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">act_amount_zero</span>, <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.ZArith.BinInt.html#Z.add_0_l"><span class="id" title="lemma">Z.add_0_l</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <span class="id" title="var">IHl</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
<a name="lab226"></a><h2 class="section">Total supply / token balance facts</h2>
 Sum of all token balances 
</div>
<div class="code">
<span class="id" title="keyword">Definition</span> <a name="sum_balances"><span class="id" title="definition">sum_balances</span></a> <span class="id" title="var">state</span> :=<br/>
&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Extras.html#sumN"><span class="id" title="definition">sumN</span></a> (<span class="id" title="keyword">fun</span> '<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><span class="id" title="var">k</span><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <span class="id" title="var">v</span><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> =&gt; <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#v"><span class="id" title="variable">v</span></a>) (<a class="idref" href="ConCert.Execution.Containers.html#FMap.elements"><span class="id" title="abbreviation">FMap.elements</span></a> (<a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#tokens"><span class="id" title="projection">tokens</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#state"><span class="id" title="variable">state</span></a>)).<br/>

<br/>
</div>

<div class="doc">
The balance of a single account is always less than
   or equal to the sum of all balances 
</div>
<div class="code">
<span class="id" title="keyword">Lemma</span> <a name="balance_le_sum_balances"><span class="id" title="lemma">balance_le_sum_balances</span></a> : <span class="id" title="keyword">forall</span> <span class="id" title="var">addr</span> <span class="id" title="var">state</span>,<br/>
&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Extras.html#with_default"><span class="id" title="definition">with_default</span></a> 0 (<a class="idref" href="ConCert.Execution.Containers.html#FMap.find"><span class="id" title="abbreviation">FMap.find</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#addr"><span class="id" title="variable">addr</span></a> (<a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#tokens"><span class="id" title="projection">tokens</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#state"><span class="id" title="variable">state</span></a>)) <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.NArith.BinNat.html#2ccca3280733654024e33c2005ae2530"><span class="id" title="notation">&lt;=</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#sum_balances"><span class="id" title="definition">sum_balances</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#state"><span class="id" title="variable">state</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <a class="idref" href="ConCert.Execution.Containers.html#FMap.find"><span class="id" title="abbreviation">FMap.find</span></a> <span class="id" title="var">eqn</span>:<span class="id" title="var">balance</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">eapply</span> <a class="idref" href="ConCert.Execution.Containers.html#FMap.In_elements"><span class="id" title="lemma">FMap.In_elements</span></a>, <a class="idref" href="ConCert.Execution.Extras.html#sumN_in_le"><span class="id" title="lemma">sumN_in_le</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">balance</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.NArith.BinNat.html#N.le_trans"><span class="id" title="lemma">N.le_trans</span></a>; <span class="id" title="var">cycle</span> 1; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.NArith.BinNat.html#N.le_0_l"><span class="id" title="lemma">N.le_0_l</span></a>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
<span class="inlinecode"><a class="idref" href="ConCert.Execution.Examples.FA2Interface.html#total_supply"><span class="id" title="projection">total_supply</span></a></span> is always equal to the sum of all account token balances 
</div>
<div class="code">
<span class="id" title="keyword">Lemma</span> <a name="sum_balances_eq_total_supply"><span class="id" title="lemma">sum_balances_eq_total_supply</span></a> : <span class="id" title="keyword">forall</span> <span class="id" title="var">bstate</span> <span class="id" title="var">caddr</span>,<br/>
&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#reachable"><span class="id" title="definition">reachable</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#bstate"><span class="id" title="variable">bstate</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#env_contracts"><span class="id" title="projection">env_contracts</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#bstate"><span class="id" title="variable">bstate</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#caddr"><span class="id" title="variable">caddr</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> (<a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#contract"><span class="id" title="definition">contract</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#WeakContract"><span class="id" title="inductive">WeakContract</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">exists</span></a> <span class="id" title="var">cstate</span><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">,</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#contract_state"><span class="id" title="definition">contract_state</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#bstate"><span class="id" title="variable">bstate</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#caddr"><span class="id" title="variable">caddr</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#cstate"><span class="id" title="variable">cstate</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">/\</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#total_supply"><span class="id" title="projection">total_supply</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#cstate"><span class="id" title="variable">cstate</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#sum_balances"><span class="id" title="definition">sum_balances</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#cstate"><span class="id" title="variable">cstate</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> * <span class="id" title="var">reach</span> <span class="id" title="var">deployed</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<a class="idref" href="ConCert.Execution.Blockchain.html#lift_contract_state_prop"><span class="id" title="lemma">lift_contract_state_prop</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#contract"><span class="id" title="definition">contract</span></a>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> *;<span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> *; <span class="id" title="tactic">auto</span>; <span class="id" title="tactic">clear</span> <span class="id" title="var">reach</span> <span class="id" title="var">deployed</span> <span class="id" title="var">bstate</span> <span class="id" title="var">caddr</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">intros</span> <span class="id" title="var">init_some</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#sum_balances"><span class="id" title="definition">sum_balances</span></a>. <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">erewrite</span> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#init_total_supply_correct"><span class="id" title="lemma">init_total_supply_correct</span></a>, <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#init_balances_correct"><span class="id" title="lemma">init_balances_correct</span></a>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="ConCert.Execution.Containers.html#FMap.elements_add"><span class="id" title="lemma">FMap.elements_add</span></a>, <a class="idref" href="ConCert.Execution.Containers.html#FMap.elements_empty"><span class="id" title="lemma">FMap.elements_empty</span></a> <span class="id" title="tactic">by</span> <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">intros</span> <span class="id" title="var">IH</span> <span class="id" title="var">receive_some</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">msg</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">m</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="var">erewrite</span> &lt;- <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#try_transfer_preserves_total_supply"><span class="id" title="lemma">try_transfer_preserves_total_supply</span></a>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rename</span> <span class="id" title="var">t</span> <span class="id" title="var">into</span> <span class="id" title="var">param</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#sum_balances"><span class="id" title="definition">sum_balances</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">contract_simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.NArith.BinNat.html#N.ltb_ge"><span class="id" title="lemma">N.ltb_ge</span></a> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<a class="idref" href="ConCert.Execution.Blockchain.html#address_eqb_spec"><span class="id" title="method">address_eqb_spec</span></a> <span class="id" title="var">param</span>.(<a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#from"><span class="id" title="projection">from</span></a>) <span class="id" title="var">param</span>.(<a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#to"><span class="id" title="projection">to</span></a>)) <span class="id" title="keyword">as</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[&lt;-| <span class="id" title="var">from_to_ne</span>];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[<span class="id" title="tactic">rewrite</span> <a class="idref" href="ConCert.Execution.Containers.html#FMap.find_update_eq"><span class="id" title="lemma">FMap.find_update_eq</span></a> | <span class="id" title="tactic">rewrite</span> <a class="idref" href="ConCert.Execution.Containers.html#FMap.find_update_ne"><span class="id" title="lemma">FMap.find_update_ne</span></a> <span class="id" title="tactic">by</span> <span class="id" title="tactic">auto</span>];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<a class="idref" href="ConCert.Execution.Containers.html#FMap.find"><span class="id" title="abbreviation">FMap.find</span></a> (<a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#from"><span class="id" title="projection">from</span></a> <span class="id" title="var">param</span>) <span class="id" title="var">_</span>) <span class="id" title="var">eqn</span>:<span class="id" title="var">from_balance</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<a class="idref" href="ConCert.Execution.Containers.html#FMap.find"><span class="id" title="abbreviation">FMap.find</span></a> (<a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#to"><span class="id" title="projection">to</span></a> <span class="id" title="var">param</span>) (<a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#tokens"><span class="id" title="projection">tokens</span></a> <span class="id" title="var">cstate</span>)) <span class="id" title="var">eqn</span>:<span class="id" title="var">to_balance</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">param</span>;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">unshelve</span> (<span class="id" title="tactic">repeat</span> <span class="id" title="keyword">match</span> <span class="id" title="keyword">goal</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">H</span> : ?<span class="id" title="var">x</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> ?<span class="id" title="var">y</span> |- <span class="id" title="keyword">context</span> [ ?<span class="id" title="var">x</span> ] =&gt; <span class="id" title="tactic">rewrite</span> <span class="id" title="var">H</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">H</span> : <span class="id" title="var">_</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.NArith.BinNat.html#2ccca3280733654024e33c2005ae2530"><span class="id" title="notation">&lt;=</span></a> 0 |- <span class="id" title="var">_</span> =&gt; <span class="id" title="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.NArith.BinNat.html#N.lt_eq_cases"><span class="id" title="lemma">N.lt_eq_cases</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">H</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">H</span> | <span class="id" title="var">H</span>]; <span class="id" title="tactic">try</span> <span class="id" title="var">lia</span>; <span class="id" title="tactic">subst</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| |- <span class="id" title="keyword">context</span> [ <a class="idref" href="ConCert.Execution.Containers.html#FMap.find"><span class="id" title="abbreviation">FMap.find</span></a> ?<span class="id" title="var">x</span> (<a class="idref" href="ConCert.Execution.Containers.html#FMap.add"><span class="id" title="abbreviation">FMap.add</span></a> ?<span class="id" title="var">x</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>) ] =&gt; <span class="id" title="tactic">rewrite</span> <a class="idref" href="ConCert.Execution.Containers.html#FMap.find_add"><span class="id" title="lemma">FMap.find_add</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| |- <span class="id" title="keyword">context</span> [ <a class="idref" href="ConCert.Execution.Containers.html#FMap.add"><span class="id" title="abbreviation">FMap.add</span></a> ?<span class="id" title="var">x</span> <span class="id" title="var">_</span> (<a class="idref" href="ConCert.Execution.Containers.html#FMap.add"><span class="id" title="abbreviation">FMap.add</span></a> ?<span class="id" title="var">x</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>) ] =&gt; <span class="id" title="tactic">rewrite</span> <a class="idref" href="ConCert.Execution.Containers.html#FMap.add_add"><span class="id" title="lemma">FMap.add_add</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">H</span> : ?<span class="id" title="var">x</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#a0a5068f83a704fcfbda8cd473a6cfea"><span class="id" title="notation">&lt;&gt;</span></a> ?<span class="id" title="var">y</span> |- <span class="id" title="keyword">context</span> [ <a class="idref" href="ConCert.Execution.Containers.html#FMap.find"><span class="id" title="abbreviation">FMap.find</span></a> ?<span class="id" title="var">x</span> (<a class="idref" href="ConCert.Execution.Containers.html#FMap.add"><span class="id" title="abbreviation">FMap.add</span></a> ?<span class="id" title="var">y</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>) ] =&gt; <span class="id" title="tactic">rewrite</span> <a class="idref" href="ConCert.Execution.Containers.html#FMap.find_add_ne"><span class="id" title="lemma">FMap.find_add_ne</span></a>; <span class="id" title="tactic">eauto</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">H</span> : ?<span class="id" title="var">y</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#a0a5068f83a704fcfbda8cd473a6cfea"><span class="id" title="notation">&lt;&gt;</span></a> ?<span class="id" title="var">x</span> |- <span class="id" title="keyword">context</span> [ <a class="idref" href="ConCert.Execution.Containers.html#FMap.find"><span class="id" title="abbreviation">FMap.find</span></a> ?<span class="id" title="var">x</span> (<a class="idref" href="ConCert.Execution.Containers.html#FMap.add"><span class="id" title="abbreviation">FMap.add</span></a> ?<span class="id" title="var">y</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>) ] =&gt; <span class="id" title="tactic">rewrite</span> <a class="idref" href="ConCert.Execution.Containers.html#FMap.find_add_ne"><span class="id" title="lemma">FMap.find_add_ne</span></a>; <span class="id" title="tactic">eauto</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">H</span> : ?<span class="id" title="var">x</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#a0a5068f83a704fcfbda8cd473a6cfea"><span class="id" title="notation">&lt;&gt;</span></a> ?<span class="id" title="var">y</span> |- <span class="id" title="keyword">context</span> [ <a class="idref" href="ConCert.Execution.Containers.html#FMap.find"><span class="id" title="abbreviation">FMap.find</span></a> ?<span class="id" title="var">x</span> (<a class="idref" href="ConCert.Execution.Containers.html#FMap.remove"><span class="id" title="abbreviation">FMap.remove</span></a> ?<span class="id" title="var">y</span> <span class="id" title="var">_</span>) ] =&gt; <span class="id" title="tactic">rewrite</span> <a class="idref" href="ConCert.Execution.Containers.html#FMap.find_remove_ne"><span class="id" title="lemma">FMap.find_remove_ne</span></a>; <span class="id" title="tactic">eauto</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">H</span> : ?<span class="id" title="var">y</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#a0a5068f83a704fcfbda8cd473a6cfea"><span class="id" title="notation">&lt;&gt;</span></a> ?<span class="id" title="var">x</span> |- <span class="id" title="keyword">context</span> [ <a class="idref" href="ConCert.Execution.Containers.html#FMap.find"><span class="id" title="abbreviation">FMap.find</span></a> ?<span class="id" title="var">x</span> (<a class="idref" href="ConCert.Execution.Containers.html#FMap.remove"><span class="id" title="abbreviation">FMap.remove</span></a> ?<span class="id" title="var">y</span> <span class="id" title="var">_</span>) ] =&gt; <span class="id" title="tactic">rewrite</span> <a class="idref" href="ConCert.Execution.Containers.html#FMap.find_remove_ne"><span class="id" title="lemma">FMap.find_remove_ne</span></a>; <span class="id" title="tactic">eauto</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">H</span> : <a class="idref" href="ConCert.Execution.Containers.html#FMap.find"><span class="id" title="abbreviation">FMap.find</span></a> ?<span class="id" title="var">x</span> <span class="id" title="var">_</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <span class="id" title="var">_</span> |- <span class="id" title="keyword">context</span> [ <a class="idref" href="ConCert.Execution.Containers.html#FMap.elements"><span class="id" title="abbreviation">FMap.elements</span></a> (<a class="idref" href="ConCert.Execution.Containers.html#FMap.add"><span class="id" title="abbreviation">FMap.add</span></a> ?<span class="id" title="var">x</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>) ] =&gt; <span class="id" title="tactic">rewrite</span> <a class="idref" href="ConCert.Execution.Containers.html#FMap.elements_add_existing"><span class="id" title="lemma">FMap.elements_add_existing</span></a>; <span class="id" title="tactic">eauto</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">H</span> : <a class="idref" href="ConCert.Execution.Containers.html#FMap.find"><span class="id" title="abbreviation">FMap.find</span></a> ?<span class="id" title="var">x</span> <span class="id" title="var">_</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a> |- <span class="id" title="keyword">context</span> [ <a class="idref" href="ConCert.Execution.Containers.html#FMap.elements"><span class="id" title="abbreviation">FMap.elements</span></a> (<a class="idref" href="ConCert.Execution.Containers.html#FMap.add"><span class="id" title="abbreviation">FMap.add</span></a> ?<span class="id" title="var">x</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>) ] =&gt; <span class="id" title="tactic">rewrite</span> <a class="idref" href="ConCert.Execution.Containers.html#FMap.elements_add"><span class="id" title="lemma">FMap.elements_add</span></a>; <span class="id" title="tactic">eauto</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| |- <span class="id" title="keyword">context</span> [ <a class="idref" href="ConCert.Execution.Containers.html#FMap.remove"><span class="id" title="abbreviation">FMap.remove</span></a> ?<span class="id" title="var">x</span> (<a class="idref" href="ConCert.Execution.Containers.html#FMap.add"><span class="id" title="abbreviation">FMap.add</span></a> ?<span class="id" title="var">x</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>) ] =&gt; <span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">fin_maps.delete_insert_delete</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">H</span> : <a class="idref" href="ConCert.Execution.Containers.html#FMap.find"><span class="id" title="abbreviation">FMap.find</span></a> ?<span class="id" title="var">x</span> ?<span class="id" title="var">m</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <span class="id" title="var">_</span> |- <span class="id" title="keyword">context</span> [ <a class="idref" href="ConCert.Execution.Extras.html#sumN"><span class="id" title="definition">sumN</span></a> <span class="id" title="var">_</span> (<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><span class="id" title="var">_</span><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <span class="id" title="var">_</span><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#cbcf67aac0c2a85b8d93d37de9969adf"><span class="id" title="notation">::</span></a> <a class="idref" href="ConCert.Execution.Containers.html#FMap.elements"><span class="id" title="abbreviation">FMap.elements</span></a> (<a class="idref" href="ConCert.Execution.Containers.html#FMap.remove"><span class="id" title="abbreviation">FMap.remove</span></a> ?<span class="id" title="var">x</span> ?<span class="id" title="var">m</span>)) ] =&gt; <span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">fin_maps.map_to_list_delete</span>; <span class="id" title="tactic">auto</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">H</span> : <a class="idref" href="ConCert.Execution.Containers.html#FMap.find"><span class="id" title="abbreviation">FMap.find</span></a> ?<span class="id" title="var">x</span> <span class="id" title="var">_</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> ?<span class="id" title="var">n</span> |- <span class="id" title="keyword">context</span> [ <a class="idref" href="ConCert.Execution.Extras.html#sumN"><span class="id" title="definition">sumN</span></a> <span class="id" title="var">_</span> (<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a>?<span class="id" title="var">x</span><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> ?<span class="id" title="var">n</span><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#cbcf67aac0c2a85b8d93d37de9969adf"><span class="id" title="notation">::</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><span class="id" title="var">_</span><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <span class="id" title="var">_</span><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#cbcf67aac0c2a85b8d93d37de9969adf"><span class="id" title="notation">::</span></a> <a class="idref" href="ConCert.Execution.Containers.html#FMap.elements"><span class="id" title="abbreviation">FMap.elements</span></a> (<a class="idref" href="ConCert.Execution.Containers.html#FMap.remove"><span class="id" title="abbreviation">FMap.remove</span></a> ?<span class="id" title="var">x</span> <span class="id" title="var">_</span>)) ] =&gt; <span class="id" title="tactic">rewrite</span> <a class="idref" href="ConCert.Execution.Extras.html#sumN_swap"><span class="id" title="lemma">sumN_swap</span></a>, <span class="id" title="lemma">fin_maps.map_to_list_delete</span>; <span class="id" title="tactic">auto</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| |- <span class="id" title="keyword">context</span> [ <a class="idref" href="ConCert.Execution.Extras.html#sumN"><span class="id" title="definition">sumN</span></a> <span class="id" title="var">_</span> (<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a>?<span class="id" title="var">t</span><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> ?<span class="id" title="var">n</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.NArith.BinNat.html#64708cc1fcff61c206ed571fe7828ea8"><span class="id" title="notation">+</span></a> ?<span class="id" title="var">m</span><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#cbcf67aac0c2a85b8d93d37de9969adf"><span class="id" title="notation">::</span></a> <span class="id" title="var">_</span>) ] =&gt; <span class="id" title="var">erewrite</span> <a class="idref" href="ConCert.Execution.Extras.html#sumN_split"><span class="id" title="lemma">sumN_split</span></a> <span class="id" title="keyword">with</span> (<span class="id" title="var">x</span>:= <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><span class="id" title="var">t</span><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <span class="id" title="var">n</span><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a>) (<span class="id" title="var">y</span> := <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><span class="id" title="var">_</span><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <span class="id" title="var">m</span><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a>) <span class="id" title="tactic">by</span> <span class="id" title="var">lia</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| |- <span class="id" title="keyword">context</span> [ <a class="idref" href="ConCert.Execution.Extras.html#sumN"><span class="id" title="definition">sumN</span></a> <span class="id" title="var">_</span> (<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><span class="id" title="var">_</span><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> 0<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#cbcf67aac0c2a85b8d93d37de9969adf"><span class="id" title="notation">::</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a>?<span class="id" title="var">x</span><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> ?<span class="id" title="var">n</span><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#cbcf67aac0c2a85b8d93d37de9969adf"><span class="id" title="notation">::</span></a> <span class="id" title="var">_</span>) ] =&gt; <span class="id" title="var">erewrite</span> &lt;- <a class="idref" href="ConCert.Execution.Extras.html#sumN_split"><span class="id" title="lemma">sumN_split</span></a> <span class="id" title="keyword">with</span> (<span class="id" title="var">z</span> := <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><span class="id" title="var">x</span><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <span class="id" title="var">n</span><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a>) <span class="id" title="tactic">by</span> <span class="id" title="tactic">auto</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| |- <span class="id" title="keyword">context</span> [ <a class="idref" href="ConCert.Execution.Extras.html#sumN"><span class="id" title="definition">sumN</span></a> <span class="id" title="var">_</span> (<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><span class="id" title="var">_</span><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> ?<span class="id" title="var">n</span><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#cbcf67aac0c2a85b8d93d37de9969adf"><span class="id" title="notation">::</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a>?<span class="id" title="var">x</span><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> ?<span class="id" title="var">m</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.NArith.BinNat.html#81673c7f7694c33c829aabf88ab05436"><span class="id" title="notation">-</span></a> ?<span class="id" title="var">n</span><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#cbcf67aac0c2a85b8d93d37de9969adf"><span class="id" title="notation">::</span></a> <span class="id" title="var">_</span>) ] =&gt; <span class="id" title="var">erewrite</span> &lt;- <a class="idref" href="ConCert.Execution.Extras.html#sumN_split"><span class="id" title="lemma">sumN_split</span></a> <span class="id" title="keyword">with</span> (<span class="id" title="var">z</span> := <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><span class="id" title="var">x</span><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <span class="id" title="var">n</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.NArith.BinNat.html#64708cc1fcff61c206ed571fe7828ea8"><span class="id" title="notation">+</span></a> <span class="id" title="var">m</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.NArith.BinNat.html#81673c7f7694c33c829aabf88ab05436"><span class="id" title="notation">-</span></a> <span class="id" title="var">n</span><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| |- <span class="id" title="keyword">context</span> [ <a class="idref" href="ConCert.Execution.Extras.html#sumN"><span class="id" title="definition">sumN</span></a> <span class="id" title="var">_</span> (<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a>?<span class="id" title="var">x</span><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> ?<span class="id" title="var">m</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.NArith.BinNat.html#81673c7f7694c33c829aabf88ab05436"><span class="id" title="notation">-</span></a> ?<span class="id" title="var">n</span><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#cbcf67aac0c2a85b8d93d37de9969adf"><span class="id" title="notation">::</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><span class="id" title="var">_</span><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> ?<span class="id" title="var">n</span><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#cbcf67aac0c2a85b8d93d37de9969adf"><span class="id" title="notation">::</span></a> <span class="id" title="var">_</span>) ] =&gt; <span class="id" title="var">erewrite</span> &lt;- <a class="idref" href="ConCert.Execution.Extras.html#sumN_split"><span class="id" title="lemma">sumN_split</span></a> <span class="id" title="keyword">with</span> (<span class="id" title="var">z</span> := <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><span class="id" title="var">x</span><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <span class="id" title="var">n</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.NArith.BinNat.html#64708cc1fcff61c206ed571fe7828ea8"><span class="id" title="notation">+</span></a> <span class="id" title="var">m</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.NArith.BinNat.html#81673c7f7694c33c829aabf88ab05436"><span class="id" title="notation">-</span></a> <span class="id" title="var">n</span><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| |- <span class="id" title="keyword">context</span> [ <a class="idref" href="ConCert.Execution.Extras.html#with_default"><span class="id" title="definition">with_default</span></a> <span class="id" title="var">_</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a> ] =&gt; <span class="id" title="tactic">unfold</span> <a class="idref" href="ConCert.Execution.Extras.html#with_default"><span class="id" title="definition">with_default</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| |- <span class="id" title="keyword">context</span> [ <a class="idref" href="ConCert.Execution.Extras.html#with_default"><span class="id" title="definition">with_default</span></a> <span class="id" title="var">_</span> (<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <span class="id" title="var">_</span>) ] =&gt; <span class="id" title="tactic">unfold</span> <a class="idref" href="ConCert.Execution.Extras.html#with_default"><span class="id" title="definition">with_default</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| |- <span class="id" title="keyword">context</span> [ <a class="idref" href="ConCert.Execution.Containers.html#FMap.update"><span class="id" title="definition">FMap.update</span></a> <span class="id" title="var">_</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a> <span class="id" title="var">_</span> ] =&gt; <span class="id" title="tactic">unfold</span> <a class="idref" href="ConCert.Execution.Containers.html#FMap.update"><span class="id" title="definition">FMap.update</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| |- <span class="id" title="keyword">context</span> [ <a class="idref" href="ConCert.Execution.Containers.html#FMap.update"><span class="id" title="definition">FMap.update</span></a> <span class="id" title="var">_</span> (<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <span class="id" title="var">_</span>) <span class="id" title="var">_</span> ] =&gt; <span class="id" title="tactic">unfold</span> <a class="idref" href="ConCert.Execution.Containers.html#FMap.update"><span class="id" title="definition">FMap.update</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| |- <span class="id" title="keyword">context</span> [ 0 <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.NArith.BinNat.html#64708cc1fcff61c206ed571fe7828ea8"><span class="id" title="notation">+</span></a> <span class="id" title="var">_</span> ] =&gt; <span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.NArith.BinNat.html#N.add_0_l"><span class="id" title="lemma">N.add_0_l</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| |- <span class="id" title="keyword">context</span> [ <span class="id" title="var">_</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.NArith.BinNat.html#64708cc1fcff61c206ed571fe7828ea8"><span class="id" title="notation">+</span></a> 0 ] =&gt; <span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.NArith.BinNat.html#N.add_0_r"><span class="id" title="lemma">N.add_0_r</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| |- <span class="id" title="keyword">context</span> [ 0 <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.NArith.BinNat.html#81673c7f7694c33c829aabf88ab05436"><span class="id" title="notation">-</span></a> <span class="id" title="var">_</span> ] =&gt; <span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.NArith.BinNat.html#N.sub_0_l"><span class="id" title="lemma">N.sub_0_l</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| |- <span class="id" title="keyword">context</span> [ <span class="id" title="var">_</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.NArith.BinNat.html#81673c7f7694c33c829aabf88ab05436"><span class="id" title="notation">-</span></a> 0 ] =&gt; <span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.NArith.BinNat.html#N.sub_0_r"><span class="id" title="lemma">N.sub_0_r</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">H</span> : ?<span class="id" title="var">x</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.NArith.BinNat.html#2ccca3280733654024e33c2005ae2530"><span class="id" title="notation">&lt;=</span></a> ?<span class="id" title="var">y</span>, <span class="id" title="var">G</span> : ?<span class="id" title="var">y</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.NArith.BinNat.html#81673c7f7694c33c829aabf88ab05436"><span class="id" title="notation">-</span></a> ?<span class="id" title="var">x</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> 0 |- <span class="id" title="var">_</span> =&gt; <span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.NArith.BinNat.html#N.sub_0_le"><span class="id" title="lemma">N.sub_0_le</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">G</span>; <span class="id" title="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.NArith.BinNat.html#N.le_antisymm"><span class="id" title="lemma">N.le_antisymm</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">G</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">H</span> : ?<span class="id" title="var">x</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.NArith.BinNat.html#64708cc1fcff61c206ed571fe7828ea8"><span class="id" title="notation">+</span></a> ?<span class="id" title="var">y</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> 0 |- <span class="id" title="var">_</span> =&gt; <span class="id" title="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.NArith.BinNat.html#N.eq_add_0"><span class="id" title="lemma">N.eq_add_0</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">H</span> <span class="id" title="keyword">as</span> []<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">H</span> : ?<span class="id" title="var">x</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> 0 |- <span class="id" title="var">_</span> =&gt; <span class="id" title="tactic">subst</span> <span class="id" title="var">x</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| |- <span class="id" title="keyword">context</span> [ <a class="idref" href="ConCert.Execution.Containers.html#FMap.update"><span class="id" title="definition">FMap.update</span></a> ?<span class="id" title="var">k</span> <span class="id" title="var">_</span> (<a class="idref" href="ConCert.Execution.Containers.html#FMap.update"><span class="id" title="definition">FMap.update</span></a> ?<span class="id" title="var">k</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>) ] =&gt; <span class="id" title="tactic">rewrite</span> <a class="idref" href="ConCert.Execution.Containers.html#FMap.map_update_idemp"><span class="id" title="lemma">FMap.map_update_idemp</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">H</span> : ?<span class="id" title="var">y</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.NArith.BinNat.html#2ccca3280733654024e33c2005ae2530"><span class="id" title="notation">&lt;=</span></a> ?<span class="id" title="var">x</span> |- <span class="id" title="keyword">context</span> [ <a class="idref" href="ConCert.Execution.Examples.Common.html#maybe"><span class="id" title="definition">maybe</span></a> (<a class="idref" href="ConCert.Execution.Extras.html#with_default"><span class="id" title="definition">with_default</span></a> 0 (<a class="idref" href="ConCert.Execution.Examples.Common.html#maybe"><span class="id" title="definition">maybe</span></a> (?<span class="id" title="var">x</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.NArith.BinNat.html#81673c7f7694c33c829aabf88ab05436"><span class="id" title="notation">-</span></a> ?<span class="id" title="var">y</span>)) <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.NArith.BinNat.html#64708cc1fcff61c206ed571fe7828ea8"><span class="id" title="notation">+</span></a> ?<span class="id" title="var">y</span>) ] =&gt; <span class="id" title="tactic">apply</span> <a class="idref" href="ConCert.Execution.Examples.Common.html#maybe_sub_add"><span class="id" title="lemma">maybe_sub_add</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">H</span> <span class="id" title="keyword">as</span> [[-&gt; -&gt;] | -&gt;]<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">H</span> : <a class="idref" href="ConCert.Execution.Containers.html#FMap.find"><span class="id" title="abbreviation">FMap.find</span></a> ?<span class="id" title="var">x</span> ?<span class="id" title="var">m</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> 0 |- <span class="id" title="keyword">context</span> [ <a class="idref" href="ConCert.Execution.Containers.html#FMap.elements"><span class="id" title="abbreviation">FMap.elements</span></a> (<a class="idref" href="ConCert.Execution.Containers.html#FMap.remove"><span class="id" title="abbreviation">FMap.remove</span></a> ?<span class="id" title="var">x</span> <span class="id" title="var">_</span>) ] =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.NArith.BinNat.html#N.add_0_r"><span class="id" title="lemma">N.add_0_r</span></a>; <span class="id" title="tactic">change</span> 0 <span class="id" title="keyword">with</span> ((<span class="id" title="keyword">fun</span> '<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><span class="id" title="var">_</span><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <span class="id" title="var">v</span><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> =&gt; <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#v"><span class="id" title="variable">v</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><span class="id" title="var">x</span><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> 0<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a>); <span class="id" title="tactic">rewrite</span> <a class="idref" href="ConCert.Execution.Extras.html#sumN_inv"><span class="id" title="lemma">sumN_inv</span></a>; <span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">fin_maps.map_to_list_delete</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">H</span> : <a class="idref" href="ConCert.Execution.Containers.html#FMap.find"><span class="id" title="abbreviation">FMap.find</span></a> ?<span class="id" title="var">k</span> ?<span class="id" title="var">m</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a> |- <span class="id" title="keyword">context</span> [ <a class="idref" href="ConCert.Execution.Containers.html#FMap.remove"><span class="id" title="abbreviation">FMap.remove</span></a> ?<span class="id" title="var">k</span> <span class="id" title="var">_</span> ] =&gt; <span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">fin_maps.delete_notin</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| |- <span class="id" title="keyword">context</span> [ <a class="idref" href="ConCert.Execution.Examples.Common.html#maybe"><span class="id" title="definition">maybe</span></a> <span class="id" title="var">_</span> ] =&gt; <span class="id" title="tactic">specialize</span> <a class="idref" href="ConCert.Execution.Examples.Common.html#maybe_cases"><span class="id" title="lemma">maybe_cases</span></a> <span class="id" title="keyword">as</span> [[-&gt; ?<span class="id" title="var">H</span>] | [-&gt; <span class="id" title="var">_</span>]]<br/>
            | <span class="id" title="var">H</span> : ?<span class="id" title="var">y</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#a0a5068f83a704fcfbda8cd473a6cfea"><span class="id" title="notation">&lt;&gt;</span></a> ?<span class="id" title="var">x</span> |- <span class="id" title="keyword">context</span> [ <a class="idref" href="ConCert.Execution.Extras.html#sumN"><span class="id" title="definition">sumN</span></a> <span class="id" title="var">_</span> (<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a>?<span class="id" title="var">x</span><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> ?<span class="id" title="var">n</span><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#cbcf67aac0c2a85b8d93d37de9969adf"><span class="id" title="notation">::</span></a> <a class="idref" href="ConCert.Execution.Containers.html#FMap.elements"><span class="id" title="abbreviation">FMap.elements</span></a> (<a class="idref" href="ConCert.Execution.Containers.html#FMap.remove"><span class="id" title="abbreviation">FMap.remove</span></a> ?<span class="id" title="var">y</span> <span class="id" title="var">_</span>)) ] =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span>; <span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.NArith.BinNat.html#N.add_comm"><span class="id" title="lemma">N.add_comm</span></a>; <span class="id" title="tactic">change</span> <span class="id" title="var">n</span> <span class="id" title="keyword">with</span> ((<span class="id" title="keyword">fun</span> '<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><span class="id" title="var">_</span><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <span class="id" title="var">v</span><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> =&gt; <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#v"><span class="id" title="variable">v</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><span class="id" title="var">y</span><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <span class="id" title="var">n</span><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a>); <span class="id" title="tactic">rewrite</span> <a class="idref" href="ConCert.Execution.Extras.html#sumN_inv"><span class="id" title="lemma">sumN_inv</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>);<span class="id" title="tactic">try</span> <span class="id" title="var">easy</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="var">erewrite</span> &lt;- <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#try_approve_preserves_total_supply"><span class="id" title="lemma">try_approve_preserves_total_supply</span></a>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#sum_balances"><span class="id" title="definition">sum_balances</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">erewrite</span> &lt;- <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#try_approve_preserves_balances"><span class="id" title="lemma">try_approve_preserves_balances</span></a>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">rename</span> <span class="id" title="var">m</span> <span class="id" title="var">into</span> <span class="id" title="var">param</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#sum_balances"><span class="id" title="definition">sum_balances</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">contract_simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.ZArith.BinInt.html#Z.ltb_ge"><span class="id" title="lemma">Z.ltb_ge</span></a> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<a class="idref" href="ConCert.Execution.Containers.html#FMap.find"><span class="id" title="abbreviation">FMap.find</span></a> (<a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#target"><span class="id" title="projection">target</span></a> <span class="id" title="var">param</span>) <span class="id" title="var">_</span>) <span class="id" title="var">eqn</span>:<span class="id" title="var">target_balance</span>; <span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="tactic">assert</span> (<span class="id" title="var">N_add_sub_move</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">n</span> <span class="id" title="var">m</span> <span class="id" title="var">p</span>, <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#p"><span class="id" title="variable">p</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.NArith.BinNat.html#2ccca3280733654024e33c2005ae2530"><span class="id" title="notation">&lt;=</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#n"><span class="id" title="variable">n</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#n"><span class="id" title="variable">n</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.NArith.BinNat.html#81673c7f7694c33c829aabf88ab05436"><span class="id" title="notation">-</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#p"><span class="id" title="variable">p</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#m"><span class="id" title="variable">m</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#n"><span class="id" title="variable">n</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#m"><span class="id" title="variable">m</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.NArith.BinNat.html#64708cc1fcff61c206ed571fe7828ea8"><span class="id" title="notation">+</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#p"><span class="id" title="variable">p</span></a>) <span class="id" title="tactic">by</span> <span class="id" title="var">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">specialize</span> (<a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#balance_le_sum_balances"><span class="id" title="lemma">balance_le_sum_balances</span></a> <span class="id" title="var">param</span>.(<a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#target"><span class="id" title="projection">target</span></a>) <span class="id" title="var">cstate</span>) <span class="id" title="keyword">as</span> <span class="id" title="var">n_le_supply</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">target_balance</span> <span class="id" title="tactic">in</span> <span class="id" title="var">n_le_supply</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> <span class="id" title="var">n_le_supply</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">specialize</span> <a class="idref" href="ConCert.Execution.Examples.Common.html#maybe_cases"><span class="id" title="lemma">maybe_cases</span></a> <span class="id" title="keyword">as</span> [[-&gt; <span class="id" title="var">quantity_eq</span>] | [-&gt; <span class="id" title="var">_</span>]]; <span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.ZArith.Znat.html#N2Z.id"><span class="id" title="lemma">N2Z.id</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">quantity_eq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.ZArith.Znat.html#Z2N.inj"><span class="id" title="lemma">Z2N.inj</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">quantity_eq</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.ZArith.BinInt.html#Z.add_move_0_l"><span class="id" title="lemma">Z.add_move_0_l</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">quantity_eq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">quantity_eq</span>, <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.ZArith.Znat.html#Zabs2N.abs_N_nonneg"><span class="id" title="lemma">Zabs2N.abs_N_nonneg</span></a>, <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.ZArith.BinInt.html#Z.add_opp_r"><span class="id" title="lemma">Z.add_opp_r</span></a>, <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.ZArith.Znat.html#Z2N.inj_sub"><span class="id" title="lemma">Z2N.inj_sub</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.NArith.BinNat.html#N.add_sub_eq_l"><span class="id" title="lemma">N.add_sub_eq_l</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> !<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.ZArith.Znat.html#N2Z.id"><span class="id" title="lemma">N2Z.id</span></a>, <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.NArith.BinNat.html#N.add_comm"><span class="id" title="lemma">N.add_comm</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">change</span> <span class="id" title="var">n</span> <span class="id" title="keyword">with</span> ((<span class="id" title="keyword">fun</span> '<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><span class="id" title="var">_</span><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <span class="id" title="var">v</span><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> =&gt; <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#v"><span class="id" title="variable">v</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#target"><span class="id" title="projection">target</span></a> <span class="id" title="var">param</span><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <span class="id" title="var">n</span><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <a class="idref" href="ConCert.Execution.Extras.html#sumN_inv"><span class="id" title="lemma">sumN_inv</span></a>, <span class="id" title="lemma">fin_maps.map_to_list_delete</span> <span class="id" title="tactic">by</span> <span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">all</span>: <span class="id" title="var">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- <span class="id" title="tactic">rewrite</span> <a class="idref" href="ConCert.Execution.Containers.html#FMap.elements_add_existing"><span class="id" title="lemma">FMap.elements_add_existing</span></a> <span class="id" title="tactic">by</span> <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.NArith.BinNat.html#N.add_comm"><span class="id" title="lemma">N.add_comm</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">N_add_sub_move</span>; <span class="id" title="tactic">try</span> <span class="id" title="var">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.ZArith.Znat.html#Zabs2N.abs_N_nonneg"><span class="id" title="lemma">Zabs2N.abs_N_nonneg</span></a> <span class="id" title="tactic">by</span> <span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.ZArith.Znat.html#Zabs2N.inj_sub"><span class="id" title="lemma">Zabs2N.inj_sub</span></a> <span class="id" title="tactic">by</span> (<span class="id" title="tactic">split</span>; [<span class="id" title="tactic">assumption</span> | <span class="id" title="var">lia</span>]).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.ZArith.BinInt.html#Z.add_add_simpl_r_r"><span class="id" title="lemma">Z.add_add_simpl_r_r</span></a>, <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.ZArith.Znat.html#Zabs2N.inj_sub"><span class="id" title="lemma">Zabs2N.inj_sub</span></a>, !<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.ZArith.Znat.html#Zabs2N.id"><span class="id" title="lemma">Zabs2N.id</span></a> <span class="id" title="tactic">by</span> <span class="id" title="var">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.NArith.BinNat.html#N.add_sub_eq_r"><span class="id" title="lemma">N.add_sub_eq_r</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">change</span> <span class="id" title="var">n</span> <span class="id" title="keyword">with</span> ((<span class="id" title="keyword">fun</span> '<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><span class="id" title="var">_</span><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <span class="id" title="var">v</span><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> =&gt; <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#v"><span class="id" title="variable">v</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#target"><span class="id" title="projection">target</span></a> <span class="id" title="var">param</span><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <span class="id" title="var">n</span><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <a class="idref" href="ConCert.Execution.Extras.html#sumN_inv"><span class="id" title="lemma">sumN_inv</span></a>, <span class="id" title="lemma">fin_maps.map_to_list_delete</span> <span class="id" title="tactic">by</span> <span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="tactic">specialize</span> <a class="idref" href="ConCert.Execution.Examples.Common.html#maybe_cases"><span class="id" title="lemma">maybe_cases</span></a> <span class="id" title="keyword">as</span> [[-&gt; <span class="id" title="var">quantity_eq</span>] | [-&gt; <span class="id" title="var">_</span>]]; <span class="id" title="var">cbn</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#sum_balances"><span class="id" title="definition">sum_balances</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">IH</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- <span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">fin_maps.delete_notin</span> <span class="id" title="tactic">by</span> <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- <span class="id" title="tactic">rewrite</span> <a class="idref" href="ConCert.Execution.Containers.html#FMap.elements_add"><span class="id" title="lemma">FMap.elements_add</span></a> <span class="id" title="tactic">by</span> <span class="id" title="tactic">auto</span>. <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="var">try_solve_preserves_state</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="var">try_solve_preserves_state</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="var">try_solve_preserves_state</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#default_entrypoint_none"><span class="id" title="lemma">default_entrypoint_none</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">receive_some</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
Account token balances are always less than or equal to <span class="inlinecode"><a class="idref" href="ConCert.Execution.Examples.FA2Interface.html#total_supply"><span class="id" title="projection">total_supply</span></a></span> 
</div>
<div class="code">
<span class="id" title="keyword">Lemma</span> <a name="token_balance_le_total_supply"><span class="id" title="lemma">token_balance_le_total_supply</span></a> : <span class="id" title="keyword">forall</span> <span class="id" title="var">bstate</span> <span class="id" title="var">caddr</span>,<br/>
&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#reachable"><span class="id" title="definition">reachable</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#bstate"><span class="id" title="variable">bstate</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#env_contracts"><span class="id" title="projection">env_contracts</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#bstate"><span class="id" title="variable">bstate</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#caddr"><span class="id" title="variable">caddr</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> (<a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#contract"><span class="id" title="definition">contract</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#WeakContract"><span class="id" title="inductive">WeakContract</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">exists</span></a> <span class="id" title="var">cstate</span><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">,</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#contract_state"><span class="id" title="definition">contract_state</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#bstate"><span class="id" title="variable">bstate</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#caddr"><span class="id" title="variable">caddr</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#cstate"><span class="id" title="variable">cstate</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">/\</span></a> <span class="id" title="keyword">forall</span> <span class="id" title="var">addr</span>, <a class="idref" href="ConCert.Execution.Extras.html#with_default"><span class="id" title="definition">with_default</span></a> 0 (<a class="idref" href="ConCert.Execution.Containers.html#FMap.find"><span class="id" title="abbreviation">FMap.find</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#addr"><span class="id" title="variable">addr</span></a> (<a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#tokens"><span class="id" title="projection">tokens</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#cstate"><span class="id" title="variable">cstate</span></a>)) <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.NArith.BinNat.html#2ccca3280733654024e33c2005ae2530"><span class="id" title="notation">&lt;=</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#total_supply"><span class="id" title="projection">total_supply</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#cstate"><span class="id" title="variable">cstate</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> * <span class="id" title="var">reach</span> <span class="id" title="var">deployed</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#sum_balances_eq_total_supply"><span class="id" title="lemma">sum_balances_eq_total_supply</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">deployed</span> <span class="id" title="keyword">as</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">cstate</span> &amp; <span class="id" title="var">deployed_state</span> &amp; <span class="id" title="var">sum_eq_supply</span>); <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">eexists</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">deployed_state</span>, <span class="id" title="var">sum_eq_supply</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">clear</span> <span class="id" title="var">reach</span> <span class="id" title="var">deployed_state</span> <span class="id" title="var">sum_eq_supply</span> <span class="id" title="var">caddr</span> <span class="id" title="var">bstate</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">split</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#balance_le_sum_balances"><span class="id" title="lemma">balance_le_sum_balances</span></a>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
<a name="lab227"></a><h2 class="section">Empty map entries removed</h2>
 The <span class="inlinecode"><a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#tokens"><span class="id" title="projection">tokens</span></a></span> map never stores entries of zero 
</div>
<div class="code">
<span class="id" title="keyword">Lemma</span> <a name="zero_balances_removed"><span class="id" title="lemma">zero_balances_removed</span></a> : <span class="id" title="keyword">forall</span> <span class="id" title="var">bstate</span> <span class="id" title="var">caddr</span> (<span class="id" title="var">trace</span> : <a class="idref" href="ConCert.Execution.Blockchain.html#ChainTrace"><span class="id" title="definition">ChainTrace</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#empty_state"><span class="id" title="definition">empty_state</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#bstate"><span class="id" title="variable">bstate</span></a>),<br/>
&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#env_contracts"><span class="id" title="projection">env_contracts</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#bstate"><span class="id" title="variable">bstate</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#caddr"><span class="id" title="variable">caddr</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> (<a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#contract"><span class="id" title="definition">contract</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#WeakContract"><span class="id" title="inductive">WeakContract</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">exists</span></a> <span class="id" title="var">depinfo</span> <span class="id" title="var">cstate</span><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">,</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#deployment_info"><span class="id" title="definition">deployment_info</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#Setup"><span class="id" title="record">Setup</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#trace"><span class="id" title="variable">trace</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#caddr"><span class="id" title="variable">caddr</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#depinfo"><span class="id" title="variable">depinfo</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">/\</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#contract_state"><span class="id" title="definition">contract_state</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#bstate"><span class="id" title="variable">bstate</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#caddr"><span class="id" title="variable">caddr</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#cstate"><span class="id" title="variable">cstate</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">/\</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">initial_tokens</span> := <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#initial_pool"><span class="id" title="projection">initial_pool</span></a> (<a class="idref" href="ConCert.Execution.Blockchain.html#deployment_setup"><span class="id" title="projection">deployment_setup</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#depinfo"><span class="id" title="variable">depinfo</span></a>) <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#initial_tokens"><span class="id" title="variable">initial_tokens</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.NArith.BinNat.html#80ddea6dd4c93c260d914ee417457028"><span class="id" title="notation">&gt;</span></a> 0 <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">forall</span> <span class="id" title="var">addr</span> <span class="id" title="var">n</span>, <a class="idref" href="ConCert.Execution.Containers.html#FMap.find"><span class="id" title="abbreviation">FMap.find</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#addr"><span class="id" title="variable">addr</span></a> (<a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#tokens"><span class="id" title="projection">tokens</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#cstate"><span class="id" title="variable">cstate</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#n"><span class="id" title="variable">n</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#n"><span class="id" title="variable">n</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.NArith.BinNat.html#80ddea6dd4c93c260d914ee417457028"><span class="id" title="notation">&gt;</span></a> 0.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> * <span class="id" title="var">deployed</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<a class="idref" href="ConCert.Execution.Blockchain.html#lift_dep_info_contract_state_prop"><span class="id" title="lemma">lift_dep_info_contract_state_prop</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#contract"><span class="id" title="definition">contract</span></a>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">auto</span>; <span class="id" title="tactic">intros</span> *; <span class="id" title="tactic">clear</span> <span class="id" title="var">deployed</span> <span class="id" title="var">trace</span> <span class="id" title="var">bstate</span> <span class="id" title="var">caddr</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">intros</span> <span class="id" title="var">init_some</span> <span class="id" title="var">initial_pool_positive</span> * <span class="id" title="var">addr_some</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">erewrite</span> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#init_balances_correct"><span class="id" title="lemma">init_balances_correct</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">addr_some</span>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<a class="idref" href="ConCert.Execution.Blockchain.html#address_eqb_spec"><span class="id" title="method">address_eqb_spec</span></a> <span class="id" title="var">addr</span> (<a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#lqt_provider"><span class="id" title="projection">lqt_provider</span></a> <span class="id" title="var">setup</span>)) <span class="id" title="keyword">as</span> [&lt;-| <span class="id" title="var">addr_ne</span>] <span class="id" title="tactic">in</span> <span class="id" title="var">addr_some</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <a class="idref" href="ConCert.Execution.Containers.html#FMap.find_add"><span class="id" title="lemma">FMap.find_add</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">addr_some</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <a class="idref" href="ConCert.Execution.Containers.html#FMap.find_add_ne"><span class="id" title="lemma">FMap.find_add_ne</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">addr_some</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">intros</span> <span class="id" title="var">IH</span> <span class="id" title="var">receive_some</span> <span class="id" title="var">initial_pool_positive</span> * <span class="id" title="var">addr_some</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="ConCert.Execution.Blockchain.html#receive"><span class="id" title="projection">Blockchain.receive</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">receive_some</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> <span class="id" title="var">receive_some</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">msg</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">m</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">destruct</span> <span class="id" title="var">t</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">specialize</span> (<a class="idref" href="ConCert.Execution.Blockchain.html#address_eqb_spec"><span class="id" title="method">address_eqb_spec</span></a> <span class="id" title="var">addr</span> <span class="id" title="var">from0</span>) <span class="id" title="keyword">as</span> [&lt;- | <span class="id" title="var">addr_from_ne</span>];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">only</span> 2: <span class="id" title="tactic">specialize</span> (<a class="idref" href="ConCert.Execution.Blockchain.html#address_eqb_spec"><span class="id" title="method">address_eqb_spec</span></a> <span class="id" title="var">addr</span> <span class="id" title="var">to0</span>) <span class="id" title="keyword">as</span> [&lt;- | <span class="id" title="var">addr_to_ne</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="comment">(*&nbsp;case:&nbsp;addr&nbsp;=&nbsp;from&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">eapply</span> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#try_transfer_remove_empty_balances"><span class="id" title="lemma">try_transfer_remove_empty_balances</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">receive_some</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="comment">(*&nbsp;case:&nbsp;addr&nbsp;=&nbsp;to&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">eapply</span> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#try_transfer_remove_empty_balances"><span class="id" title="lemma">try_transfer_remove_empty_balances</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">receive_some</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="comment">(*&nbsp;case:&nbsp;addr&nbsp;is&nbsp;not&nbsp;related&nbsp;to&nbsp;transaction&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#try_transfer_preserves_other_balances"><span class="id" title="lemma">try_transfer_preserves_other_balances</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">receive_some</span>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> &lt;- <span class="id" title="var">receive_some</span> <span class="id" title="tactic">in</span> <span class="id" title="var">addr_some</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="var">now</span> <span class="id" title="var">erewrite</span> &lt;- <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#try_approve_preserves_balances"><span class="id" title="lemma">try_approve_preserves_balances</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">addr_some</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">destruct</span> <span class="id" title="var">m</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">specialize</span> (<a class="idref" href="ConCert.Execution.Blockchain.html#address_eqb_spec"><span class="id" title="method">address_eqb_spec</span></a> <span class="id" title="var">addr</span> <span class="id" title="var">target0</span>) <span class="id" title="keyword">as</span> [&lt;- | <span class="id" title="var">addr_from_ne</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="comment">(*&nbsp;case:&nbsp;addr&nbsp;=&nbsp;target&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">eapply</span> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#try_mint_or_burn_remove_empty_balances"><span class="id" title="lemma">try_mint_or_burn_remove_empty_balances</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">receive_some</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="comment">(*&nbsp;case:&nbsp;addr&nbsp;is&nbsp;not&nbsp;related&nbsp;to&nbsp;transaction&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#try_mint_or_burn_preserves_other_balances"><span class="id" title="lemma">try_mint_or_burn_preserves_other_balances</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">receive_some</span>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> &lt;- <span class="id" title="var">receive_some</span> <span class="id" title="tactic">in</span> <span class="id" title="var">addr_some</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">apply</span> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#try_get_allowance_preserves_state"><span class="id" title="lemma">try_get_allowance_preserves_state</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">receive_some</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">apply</span> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#try_get_balance_preserves_state"><span class="id" title="lemma">try_get_balance_preserves_state</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">receive_some</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">apply</span> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#try_get_total_supply_preserves_state"><span class="id" title="lemma">try_get_total_supply_preserves_state</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">receive_some</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="var">contract_simpl</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
The <span class="inlinecode"><a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#allowances"><span class="id" title="projection">allowances</span></a></span> map never stores entries of zero 
</div>
<div class="code">
<span class="id" title="keyword">Lemma</span> <a name="zero_allowances_removed"><span class="id" title="lemma">zero_allowances_removed</span></a> : <span class="id" title="keyword">forall</span> <span class="id" title="var">bstate</span> <span class="id" title="var">caddr</span>,<br/>
&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#reachable"><span class="id" title="definition">reachable</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#bstate"><span class="id" title="variable">bstate</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#env_contracts"><span class="id" title="projection">env_contracts</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#bstate"><span class="id" title="variable">bstate</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#caddr"><span class="id" title="variable">caddr</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> (<a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#contract"><span class="id" title="definition">contract</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#WeakContract"><span class="id" title="inductive">WeakContract</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">exists</span></a> <span class="id" title="var">cstate</span><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">,</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#contract_state"><span class="id" title="definition">contract_state</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#bstate"><span class="id" title="variable">bstate</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#caddr"><span class="id" title="variable">caddr</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#cstate"><span class="id" title="variable">cstate</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">/\</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">forall</span> <span class="id" title="var">sender</span> <span class="id" title="var">from</span> <span class="id" title="var">n</span>, <a class="idref" href="ConCert.Execution.Containers.html#FMap.find"><span class="id" title="abbreviation">FMap.find</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#sender"><span class="id" title="variable">sender</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#from"><span class="id" title="variable">from</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> (<a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#allowances"><span class="id" title="projection">allowances</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#cstate"><span class="id" title="variable">cstate</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#n"><span class="id" title="variable">n</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#n"><span class="id" title="variable">n</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.NArith.BinNat.html#80ddea6dd4c93c260d914ee417457028"><span class="id" title="notation">&gt;</span></a> 0.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> * <span class="id" title="var">reach</span> <span class="id" title="var">deployed</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<a class="idref" href="ConCert.Execution.Blockchain.html#lift_contract_state_prop"><span class="id" title="lemma">lift_contract_state_prop</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#contract"><span class="id" title="definition">contract</span></a>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> *; <span class="id" title="tactic">auto</span>; <span class="id" title="tactic">clear</span> <span class="id" title="var">reach</span> <span class="id" title="var">deployed</span> <span class="id" title="var">bstate</span> <span class="id" title="var">caddr</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">intros</span> <span class="id" title="var">init_some</span> * <span class="id" title="var">addr_some</span>. <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">erewrite</span> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#init_allowances_correct"><span class="id" title="lemma">init_allowances_correct</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">addr_some</span> <span class="id" title="tactic">by</span> <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <a class="idref" href="ConCert.Execution.Containers.html#FMap.find_empty"><span class="id" title="lemma">FMap.find_empty</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">addr_some</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">intros</span> <span class="id" title="var">IH</span> <span class="id" title="var">receive_some</span> * <span class="id" title="var">addr_some</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="ConCert.Execution.Blockchain.html#receive"><span class="id" title="projection">Blockchain.receive</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">receive_some</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> <span class="id" title="var">receive_some</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">msg</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">m</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">destruct</span> <span class="id" title="var">t</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">specialize</span> (<a class="idref" href="ConCert.Execution.Blockchain.html#address_eqb_spec"><span class="id" title="method">address_eqb_spec</span></a> <span class="id" title="var">ctx</span>.(<a class="idref" href="ConCert.Execution.Blockchain.html#ctx_from"><span class="id" title="projection">ctx_from</span></a>) <span class="id" title="var">from0</span>) <span class="id" title="keyword">as</span> [&lt;- | <span class="id" title="var">addr_from_ne</span>];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">only</span> 1: <span class="id" title="tactic">specialize</span> (<a class="idref" href="ConCert.Execution.Blockchain.html#address_eqb_spec"><span class="id" title="method">address_eqb_spec</span></a> <span class="id" title="var">from1</span> <span class="id" title="var">sender</span>) <span class="id" title="keyword">as</span> [&lt;- | <span class="id" title="var">addr_from_ne</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="var">now</span> <span class="id" title="tactic">eapply</span> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#try_transfer_remove_empty_allowances"><span class="id" title="lemma">try_transfer_remove_empty_allowances</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">receive_some</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="tactic">eapply</span> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#try_transfer_preserves_other_allowances"><span class="id" title="lemma">try_transfer_preserves_other_allowances</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">receive_some</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- <span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> &lt;- <span class="id" title="var">receive_some</span> <span class="id" title="tactic">in</span> <span class="id" title="var">addr_some</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- <span class="id" title="tactic">intros</span> <span class="id" title="var">HH</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">inversion</span> <span class="id" title="var">HH</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="tactic">eapply</span> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#try_transfer_preserves_other_allowances"><span class="id" title="lemma">try_transfer_preserves_other_allowances</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">receive_some</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- <span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> &lt;- <span class="id" title="var">receive_some</span> <span class="id" title="tactic">in</span> <span class="id" title="var">addr_some</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- <span class="id" title="tactic">intros</span> <span class="id" title="var">HH</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">inversion</span> <span class="id" title="var">HH</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">destruct</span> <span class="id" title="var">a</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">specialize</span> (<a class="idref" href="ConCert.Execution.Blockchain.html#address_eqb_spec"><span class="id" title="method">address_eqb_spec</span></a> <span class="id" title="var">ctx</span>.(<a class="idref" href="ConCert.Execution.Blockchain.html#ctx_from"><span class="id" title="projection">ctx_from</span></a>) <span class="id" title="var">sender</span>) <span class="id" title="keyword">as</span> [&lt;- | <span class="id" title="var">addr_from_ne</span>];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">only</span> 1: <span class="id" title="tactic">specialize</span> (<a class="idref" href="ConCert.Execution.Blockchain.html#address_eqb_spec"><span class="id" title="method">address_eqb_spec</span></a> <span class="id" title="var">spender0</span> <span class="id" title="var">from0</span>) <span class="id" title="keyword">as</span> [&lt;- | <span class="id" title="var">addr_from_ne</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="var">now</span> <span class="id" title="tactic">eapply</span> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#try_approve_remove_empty_allowances"><span class="id" title="lemma">try_approve_remove_empty_allowances</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">receive_some</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="tactic">eapply</span> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#try_approve_preserves_other_allowances"><span class="id" title="lemma">try_approve_preserves_other_allowances</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">receive_some</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- <span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> &lt;- <span class="id" title="var">receive_some</span> <span class="id" title="tactic">in</span> <span class="id" title="var">addr_some</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- <span class="id" title="tactic">intros</span> <span class="id" title="var">HH</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">inversion</span> <span class="id" title="var">HH</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="tactic">eapply</span> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#try_approve_preserves_other_allowances"><span class="id" title="lemma">try_approve_preserves_other_allowances</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">receive_some</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- <span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> &lt;- <span class="id" title="var">receive_some</span> <span class="id" title="tactic">in</span> <span class="id" title="var">addr_some</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- <span class="id" title="tactic">intros</span> <span class="id" title="var">HH</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">inversion</span> <span class="id" title="var">HH</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">apply</span> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#try_mint_or_burn_preserves_allowances"><span class="id" title="lemma">try_mint_or_burn_preserves_allowances</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">receive_some</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="var">receive_some</span> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">apply</span> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#try_get_allowance_preserves_state"><span class="id" title="lemma">try_get_allowance_preserves_state</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">receive_some</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">apply</span> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#try_get_balance_preserves_state"><span class="id" title="lemma">try_get_balance_preserves_state</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">receive_some</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">apply</span> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#try_get_total_supply_preserves_state"><span class="id" title="lemma">try_get_total_supply_preserves_state</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">receive_some</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="var">contract_simpl</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
<a name="lab228"></a><h2 class="section">Total supply correct</h2>

</div>
<div class="code">

<br/>
<span class="id" title="keyword">Open</span> <span class="id" title="keyword">Scope</span> <span class="id" title="var">Z_scope</span>.<br/>

<br/>
</div>

<div class="doc">
<span class="inlinecode"><a class="idref" href="ConCert.Execution.Examples.FA2Interface.html#total_supply"><span class="id" title="projection">total_supply</span></a></span> is equal to the initial tokens + minted tokens - burned tokens 
</div>
<div class="code">
<span class="id" title="keyword">Lemma</span> <a name="total_supply_correct"><span class="id" title="lemma">total_supply_correct</span></a> : <span class="id" title="keyword">forall</span> <span class="id" title="var">bstate</span> <span class="id" title="var">caddr</span> (<span class="id" title="var">trace</span> : <a class="idref" href="ConCert.Execution.Blockchain.html#ChainTrace"><span class="id" title="definition">ChainTrace</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#empty_state"><span class="id" title="definition">empty_state</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#bstate"><span class="id" title="variable">bstate</span></a>),<br/>
&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#env_contracts"><span class="id" title="projection">env_contracts</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#bstate"><span class="id" title="variable">bstate</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#caddr"><span class="id" title="variable">caddr</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> (<a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#contract"><span class="id" title="definition">contract</span></a> : <a class="idref" href="ConCert.Execution.Blockchain.html#WeakContract"><span class="id" title="inductive">WeakContract</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">exists</span></a> <span class="id" title="var">cstate</span> <span class="id" title="var">depinfo</span> <span class="id" title="var">inc_calls</span><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">,</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#contract_state"><span class="id" title="definition">contract_state</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#bstate"><span class="id" title="variable">bstate</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#caddr"><span class="id" title="variable">caddr</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#cstate"><span class="id" title="variable">cstate</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">/\</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#deployment_info"><span class="id" title="definition">deployment_info</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#Setup"><span class="id" title="record">Setup</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#trace"><span class="id" title="variable">trace</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#caddr"><span class="id" title="variable">caddr</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#depinfo"><span class="id" title="variable">depinfo</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">/\</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#incoming_calls"><span class="id" title="definition">incoming_calls</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#Msg"><span class="id" title="inductive">Msg</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#trace"><span class="id" title="variable">trace</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#caddr"><span class="id" title="variable">caddr</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#inc_calls"><span class="id" title="variable">inc_calls</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">/\</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">initial_tokens</span> := <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#initial_pool"><span class="id" title="projection">initial_pool</span></a> (<a class="idref" href="ConCert.Execution.Blockchain.html#deployment_setup"><span class="id" title="projection">deployment_setup</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#depinfo"><span class="id" title="variable">depinfo</span></a>) <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.ZArith.BinInt.html#Z.of_N"><span class="id" title="definition">Z.of_N</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#cstate"><span class="id" title="variable">cstate</span></a>.(<a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#total_supply"><span class="id" title="projection">total_supply</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.ZArith.BinInt.html#46584eddd5fdb16176a10a2843177d3a"><span class="id" title="notation">(</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.ZArith.BinInt.html#Z.of_N"><span class="id" title="definition">Z.of_N</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#initial_tokens"><span class="id" title="variable">initial_tokens</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.ZArith.BinInt.html#46584eddd5fdb16176a10a2843177d3a"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.ZArith.BinInt.html#46584eddd5fdb16176a10a2843177d3a"><span class="id" title="notation">+</span></a> <a class="idref" href="ConCert.Execution.Extras.html#sumZ"><span class="id" title="definition">sumZ</span></a> (<span class="id" title="keyword">fun</span> <span class="id" title="var">callInfo</span> =&gt; <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#mintedOrBurnedTokens"><span class="id" title="definition">mintedOrBurnedTokens</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#callInfo"><span class="id" title="variable">callInfo</span></a>.(<a class="idref" href="ConCert.Execution.Blockchain.html#call_msg"><span class="id" title="projection">call_msg</span></a>)) (<a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Lists.List.html#filter"><span class="id" title="definition">filter</span></a> (<a class="idref" href="ConCert.Execution.InterContractCommunication.html#callFrom"><span class="id" title="definition">callFrom</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#cstate"><span class="id" title="variable">cstate</span></a>.(<a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#admin"><span class="id" title="projection">admin</span></a>)) <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#inc_calls"><span class="id" title="variable">inc_calls</span></a>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">contract_induction</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">now</span> <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *;<span class="id" title="var">erewrite</span> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#init_total_supply_correct"><span class="id" title="lemma">init_total_supply_correct</span></a> <span class="id" title="tactic">by</span> <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">instantiate</span> (<span class="id" title="var">CallFacts</span> := <span class="id" title="keyword">fun</span> <span class="id" title="var">_</span> <span class="id" title="var">ctx</span> <span class="id" title="var">state</span> <span class="id" title="var">_</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#total_supply"><span class="id" title="projection">total_supply</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#state"><span class="id" title="variable">state</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#sum_balances"><span class="id" title="definition">sum_balances</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#state"><span class="id" title="variable">state</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">/\</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Blockchain.html#ctx_from"><span class="id" title="projection">ctx_from</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#ctx"><span class="id" title="variable">ctx</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#a0a5068f83a704fcfbda8cd473a6cfea"><span class="id" title="notation">&lt;&gt;</span></a> <a class="idref" href="ConCert.Execution.Blockchain.html#ctx_contract_address"><span class="id" title="projection">ctx_contract_address</span></a> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#ctx"><span class="id" title="variable">ctx</span></a>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">facts</span> <span class="id" title="keyword">as</span> (<span class="id" title="var">balances_eq_total_supply</span> &amp; <span class="id" title="var">_</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="ConCert.Execution.InterContractCommunication.html#callFrom"><span class="id" title="definition">callFrom</span></a> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="ConCert.Execution.Blockchain.html#receive"><span class="id" title="projection">Blockchain.receive</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">receive_some</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">erewrite</span> &lt;- <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#admin_constant"><span class="id" title="lemma">admin_constant</span></a>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">msg</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">m</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="var">erewrite</span> &lt;- <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#try_transfer_preserves_total_supply"><span class="id" title="lemma">try_transfer_preserves_total_supply</span></a>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="var">destruct_address_eq</span>; <span class="id" title="var">cbn</span>; <span class="id" title="tactic">rewrite</span> <span class="id" title="var">IH</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="var">erewrite</span> &lt;- <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#try_approve_preserves_total_supply"><span class="id" title="lemma">try_approve_preserves_total_supply</span></a>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="var">destruct_address_eq</span>; <span class="id" title="var">cbn</span>; <span class="id" title="tactic">rewrite</span> <span class="id" title="var">IH</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#try_mint_or_burn_total_supply_correct"><span class="id" title="lemma">try_mint_or_burn_total_supply_correct</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">receive_some</span> <span class="id" title="keyword">as</span> <span class="id" title="var">state_eq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="tactic">rewrite</span> &lt;- <span class="id" title="var">state_eq</span>, <span class="id" title="var">IH</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">specialize</span> (<a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#try_mint_or_burn_is_some"><span class="id" title="lemma">try_mint_or_burn_is_some</span></a>) <span class="id" title="keyword">as</span> (<span class="id" title="var">_</span> &amp; (<span class="id" title="var">_</span> &amp; &lt;- &amp; <span class="id" title="var">_</span>)); <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="ConCert.Execution.Blockchain.html#address_eq_refl"><span class="id" title="lemma">address_eq_refl</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span>. <span class="id" title="var">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="tactic">rewrite</span> <span class="id" title="var">balances_eq_total_supply</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#balance_le_sum_balances"><span class="id" title="lemma">balance_le_sum_balances</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">eapply</span> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#try_get_allowance_preserves_state"><span class="id" title="lemma">try_get_allowance_preserves_state</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">receive_some</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="var">destruct_address_eq</span>; <span class="id" title="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">eapply</span> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#try_get_balance_preserves_state"><span class="id" title="lemma">try_get_balance_preserves_state</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">receive_some</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="var">destruct_address_eq</span>; <span class="id" title="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">eapply</span> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#try_get_total_supply_preserves_state"><span class="id" title="lemma">try_get_total_supply_preserves_state</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">receive_some</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="var">destruct_address_eq</span>; <span class="id" title="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="var">contract_simpl</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">now</span> <span class="id" title="tactic">destruct</span> <span class="id" title="var">facts</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">instantiate</span> (<span class="id" title="var">AddBlockFacts</span> := <span class="id" title="keyword">fun</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> =&gt; <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#True"><span class="id" title="inductive">True</span></a>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">instantiate</span> (<span class="id" title="var">DeployFacts</span> := <span class="id" title="keyword">fun</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> =&gt; <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#True"><span class="id" title="inductive">True</span></a>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">unset_all</span>; <span class="id" title="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">destruct_chain_step</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">destruct_action_eval</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">subst</span>. <span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="var">now</span> <span class="id" title="tactic">specialize</span> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#sum_balances_eq_total_supply"><span class="id" title="lemma">sum_balances_eq_total_supply</span></a> <span class="id" title="keyword">as</span> (? &amp; ? &amp; ?).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">rewrite</span> <span class="id" title="var">deployed</span> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="keyword">goal</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">H</span> : <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> ?<span class="id" title="var">x</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.11.2/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <span class="id" title="var">_</span> |- <span class="id" title="var">_</span> =&gt; <span class="id" title="tactic">inversion</span> <span class="id" title="var">H</span>; <span class="id" title="tactic">subst</span> <span class="id" title="var">x</span>; <span class="id" title="tactic">clear</span> <span class="id" title="var">H</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">eapply</span> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#no_self_calls"><span class="id" title="lemma">no_self_calls</span></a>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Instance</span> <a name="LqtFA12Token"><span class="id" title="instance">LqtFA12Token</span></a> : <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#LqtTokenInterface"><span class="id" title="class">LqtTokenInterface</span></a> :=<br/>
&nbsp;&nbsp;{ <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#lqt_contract"><span class="id" title="projection">lqt_contract</span></a> := <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#contract"><span class="id" title="definition">DEX2LQT.contract</span></a>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#lqt_total_supply_correct"><span class="id" title="projection">lqt_total_supply_correct</span></a> := <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#total_supply_correct"><span class="id" title="lemma">total_supply_correct</span></a> }.<br/>

<br/>
<span class="id" title="var">Arguments</span> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#lqt_contract"><span class="id" title="projection">lqt_contract</span></a> {<span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>} <span class="id" title="var">_</span>.<br/>
<span class="id" title="var">Arguments</span> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#lqt_total_supply_correct"><span class="id" title="projection">lqt_total_supply_correct</span></a> {<span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>} <span class="id" title="var">_</span>.<br/>

<br/>
<span class="id" title="keyword">End</span> <a class="idref" href="ConCert.Execution.Examples.dexter2.Dexter2FA12.html#Theories"><span class="id" title="section">Theories</span></a>.<br/>
</div>
</div>
<div id="footer">
  Generated by <a href="http://coq.inria.fr/">coqdoc</a> and improved with <a href="https://github.com/tebbi/coqdocjs">CoqdocJS</a> and <a href="https://github.com/jgallen23/toc">TOC</a>
</div>
</div>
<script>
  const elements = document.getElementsByClassName("libtitle");
  while(elements.length > 0){
        elements[0].parentNode.removeChild(elements[0]);
  }
  if (window.location.pathname.endsWith("/toc.html")) {
      const jstocDiv = document.getElementById("js-toc");
      jstocDiv.classList.remove("toc");
      jstocDiv.classList.add("jstoc-hidden");
      const jstocHeaderDiv = document.getElementById("js-toc-header");
      jstocHeaderDiv.classList.add("jstoc-hidden");
  }
  console.log(window.location.pathname);
</script>
<script type="text/javascript" src="toc.js"></script>
</body>

</html>
